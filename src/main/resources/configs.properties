# DATA-SOURCES
DATASOURCE.URL=jdbc:mysql://192.168.1.151:3306/r_ncrmExtraction
DATASOURCE.USERNAME=root
DATASOURCE.PASSWORD=fast

########################################################################################################################################################
				  # PBM #
########################################################################################################################################################
BPM.cde.bq=366
BPM.SOURCE.LOT=001
BPM.SERVER.ADD=\\\\172.17.0.8\\


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER SI  
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~

### SI CHQ JOB

BPM.REQ.GETREMTRAITED.SI.CHQ=SELECT ins.DATE AS DATETR,bmtr.PK_OBJ_IDT as bmtr_PK_OBJ_IDT,bmtr.SQCA  as bmtr_SEQREM,bmtr.AGE AS bmtr_AGE,bmtr.CDECLT as bmtr_CPTREM ,bmtr.NSER AS  bmtr_REFREM,bmtr.NBCH AS bmtr_NBRVALEUR,bmtr.MNT as bmtr_MNTDECLARER,bmtr.RefCli as bmtr_RefCli,Format(sum(bmch.MNT) ,2) AS bmtr_MNTCALCULER,bmtr.MODE_ESC AS bmtr_TYPEREM FROM p_c_bpm.te_bpm_bpch bmch,p_c_bpm.te_bpm_bptr bmtr,p_c_bpm.te_bpm_ins ins,p_c_bpm.te_obj obj_bmch WHERE (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (ins.instance = bmch.instance)AND (ins.instance = bmtr.instance)and  bmtr.OPE_ETA <> 'D' AND bmtr.FK_OPE_MNE='Valid' AND bmtr.EXT='0' group by bmtr.PK_OBJ_IDT ;
BPM.REQ.GETVALUETRAITED.SI.CHQ=SELECT bmch.PK_OBJ_IDT bmch_PK_OBJ_IDT,bmch.zbk as bmch_ZBK,bmch.nser as bmch_NUMCHQ,concat(bmch.zbk,bmch.loc,bmch.CPT,bmch.RIB) AS bmch_RIB,bmch.MNT bmch_MNT,bmch.DTEMI bmch_DTEEMIS,bmch.CONF bmch_CONFOR,Bmch.VICE bmch_REJETCONF,bmch.RECTO_US_GR bmch_IMGRECTO,bmch.VERSO_DS_GR bmch_IMGVERSO FROM p_c_bpm.te_bpm_bpch bmch,p_c_bpm.te_bpm_bptr bmtr,p_c_bpm.te_bpm_ins ins,p_c_bpm.te_obj obj_bmch WHERE (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT)AND( (obj_bmch.FK_OBJMAI_IDT + 1)=bmtr.PK_OBJ_IDT) AND (ins.instance = bmch.instance)AND (ins.instance = bmtr.instance) AND (bmtr.OPE_ETA <> 'D')AND (bmch.OPE_ETA <> 'D')AND  (bmtr.PK_OBJ_IDT = :pk_obj_id_Rem) ;
BPM.REQ.UPDATEEXT.SI.CHQ=UPDATE p_c_bpm.te_bpm_bptr SET EXT = 1 WHERE (PK_OBJ_IDT = :pk_obj_id_Rem)

BPM.REQ.GETREM_TRAITED_FLAGER.SI.CHQ=SELECT ins.DATE AS DATETR,bmtr.PK_OBJ_IDT as bmtr_PK_OBJ_IDT,bmtr.SQCA  as bmtr_SEQREM,bmtr.AGE AS bmtr_AGE,bmtr.CDECLT as bmtr_CPTREM ,bmtr.NSER AS  bmtr_REFREM,bmtr.NBCH AS bmtr_NBRVALEUR,bmtr.MNT as bmtr_MNTDECLARER,bmtr.RefCli as bmtr_RefCli,Format(sum(bmch.MNT) ,2) AS bmtr_MNTCALCULER,bmtr.MODE_ESC AS bmtr_TYPEREM FROM p_c_bpm.te_bpm_bpch bmch,p_c_bpm.te_bpm_bptr bmtr,p_c_bpm.te_bpm_ins ins,p_c_bpm.te_obj obj_bmch WHERE (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (ins.instance = bmch.instance)AND (ins.instance = bmtr.instance)and  bmtr.OPE_ETA <> 'D' AND bmtr.FK_OPE_MNE='Valid' AND bmtr.EXT='1' group by bmtr.nser ;
BPM.REQ.GETREM_TRAITED_FLAGER_by_DTE.SI.CHQ=SELECT ins.DATE AS DATETR,bmtr.PK_OBJ_IDT as bmtr_PK_OBJ_IDT,bmtr.SQCA  as bmtr_SEQREM,bmtr.AGE AS bmtr_AGE,bmtr.CDECLT as bmtr_CPTREM ,bmtr.NSER AS  bmtr_REFREM,bmtr.NBCH AS bmtr_NBRVALEUR,bmtr.MNT as bmtr_MNTDECLARER,bmtr.RefCli as bmtr_RefCli,Format(sum(bmch.MNT) ,2) AS bmtr_MNTCALCULER,bmtr.MODE_ESC AS bmtr_TYPEREM FROM p_c_bpm.te_bpm_bpch bmch,p_c_bpm.te_bpm_bptr bmtr,p_c_bpm.te_bpm_ins ins,p_c_bpm.te_obj obj_bmch WHERE (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (ins.instance = bmch.instance)AND (ins.instance = bmtr.instance)and  bmtr.OPE_ETA <> 'D' AND bmtr.FK_OPE_MNE='Valid' AND bmtr.EXT='1' and ins.date=:Date group by bmtr.nser ;

BPM.OUTDIR.SI.CHQ=\\\\172.17.0.10\\Depot\\366\\SEND\\BPMSI
BPM.PATTERN.RECORDREM.SICHQ=(^02)([0-9]{4})([0-9]{9})([0-9]{7})([0-9]{6})([0-9]{16})([0-9]{16})([0-9]{1})(.{15})
BPM.PATTERN.RECORDCHQ.SICHQ=(^03)([0-9]{7})([0-9]{24})([0-9]{16})([0-9]{8})(0|1)([0-9]{3})
BPM.TIME.JOB.SI.CHQ=0/5 * * * * ?


#### SI LCN

BPM.REQ.GETCOUNT.REM.LCN=select count(distinct (nser)) AS nbrRemise FROM p_l_bpm.te_lbpm_bptr tr,p_l_bpm.te_lbpm_ins ins where tr.INSTANCE=ins.INSTANCE and tr.OPE_ETA<>'D' and ins.date=:Date
BPM.REQ.GETCOUNTANDSUMMNT.LCN= select count(*) AS NBRLCN, Format(sum(lcn.mnt),2) MNTLCN FROM p_l_bpm.te_lbpm_bplcn lcn, p_l_bpm.te_lbpm_ins ins where lcn.INSTANCE=ins.INSTANCE and lcn.OPE_ETA<>'D' and ins.date=:Date
BPM.REQ.GETREMTRAITED.LCN=select STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,bmtr.pk_obj_idt AS bmtr_pk_obj_idt,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,bmtr.CDECLT AS bmtr_CDECLT,bmtr.MNT AS bmtr_MNTDECL,bmtr.NBCH+0 AS bmtr_NBCH,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE_RMT AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,Format(sum(bmlcn.mnt),2) bmtr_MNTREEL FROM((((((((p_l_bpm.te_lbpm_bplcn bmlcn  JOIN p_l_bpm.te_obj obj_bmlcn)JOIN p_l_bpm.te_lbpm_bptr bmtr)JOIN p_l_bpm.te_obj obj_bmtr)JOIN p_l_bpm.te_lbpm_bplta bmta)JOIN p_l_bpm.te_lbpm_bpltn bmtn)JOIN p_l_bpm.te_lbpm_ins ins)JOIN r_multi_37.tr_banque bq)  JOIN r_multi_37.tr_agence_bpm age_r) WHERE((1 = 1) AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmlcn.INSTANCE)AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT + 1))AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)AND (bmlcn.ZBK = CONVERT( bq.CDE USING UTF8)and (age_r.AGE  = bmtr.AGE_RMT) and DATE=:Date ) and bmtr.OPE_ETA<>'D'and bmlcn.OPE_ETA<>'D') group by bmtr.nser;
BPM.REQ.GETVALUETRAITED.LCN=select bmtr.CDECLT AS bmtr_RIBRMT,bmtr.Nser AS bmtr_nser,0  AS Bmlcn_CODE_STATUS,'0' as bmlcn_SIGN,bmlcn.RECTO_US_GR as bmlcn_RECTO_US_GR,bmlcn.VERSO_DS_GR as bmlcn_VERSO_DS_GR,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,bmlcn.pk_obj_idt AS bmlcn_pk_obj_idt,bmlcn.cdeAval bmlcn_cdeAval,bmlcn.NOM_AVAL bmlcn_NOM_AVAL,bmlcn.cdeend bmlcn_cdeend,bmlcn.NOM_ENDOS bmlcn_cde_nom_endo,bmlcn.NOM_TIREUR bmlcn_cde_NOM_TIREUR,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,bmtr.MNT AS bmtr_MNTDECL,bmtr.CDECLT AS bmtr_CDECLT,bmtr.NBCH+0 AS bmtr_NBCH,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE_RMT AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,bmlcn.pk_obj_idt AS bmlcn_pk_obj_idt,bmlcn.OPE_ETA AS bmlcn_ope_eta,bmlcn.ADR_RMT AS bmlcn_ADR_RMT,bmlcn.ADR_TIR AS bmlcn_ADR_TIR,bmlcn.AGE AS bmlcn_AGE,bmlcn.CDEBPR AS bmlcn_CDEBPR,bmlcn.CDE_REJ AS bmlcn_CDE_REJ,bmlcn.CONF AS bmlcn_CONF,bmlcn.CPT AS  bmlcn_CPT,bmlcn.CPT2 AS bmlcn_CPT2,bmlcn.DBL AS bmlcn_DBLT,bmlcn.DTEMI AS bmlcn_DTEEMI,bmlcn.DTEEC AS bmlcn_DTEEC,bmlcn.DTECRE AS bmlcn_DTECRE,bmlcn.FLAG_REJET AS bmlcn_FLAG_REJET,bmlcn.FLAG_VAL AS bmlcn_FLAG_AVAL,bmlcn.LOC AS bmlcn_LOC,bmlcn.MEM2 AS bmlcn_MEM2,(bmlcn.MNT) AS bmlcn_MNT,bmlcn.NSER AS bmlcn_NSER,bmlcn.RIB AS bmlcn_RIB,bmlcn.RSOC_TIR AS bmlcn_RSOC_TIR,(bmlcn.SQCA+0) AS bmlcn_SQCA,bmlcn.ZBK AS bmlcn_ZBK,bmlcn.ZIB AS bmlcn_ZIB,bmlcn.Ano AS bmlcn_ANO,bmlcn.VICE AS bmlcn_VICE,bmlcn.AGE_RMT AS bmlcn_AGE_RMT FROM((((((((p_l_bpm.te_lbpm_bplcn bmlcn JOIN p_l_bpm.te_obj obj_bmlcn)JOIN p_l_bpm.te_lbpm_bptr bmtr)JOIN p_l_bpm.te_obj obj_bmtr)JOIN p_l_bpm.te_lbpm_bplta bmta)JOIN p_l_bpm.te_lbpm_bpltn bmtn)JOIN p_l_bpm.te_lbpm_ins ins)JOIN   r_multi_37.tr_banque bq)JOIN   r_multi_37.tr_agence_bpm age_r)WHERE((1 = 1)AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmlcn.INSTANCE)AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT+1))AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)AND (bmlcn.ZBK = CONVERT( bq.CDE USING UTF8)and (age_r.AGE  = bmtr.AGE_RMT)and bmtr.pk_obj_idt=:pk_obj_id_Rem) and ins.date=:Date);

BPM.OUTDIR.SI.LCN=\\\\172.17.0.8\\Sorties\\L_BPM\\SI\\
BPM.PATTERN.ENTETE.SILCN=(^0100)([0-9]{6})([0-9]{8})([0-9]{6})([0-9]{16})
BPM.PATTERN.RECORDREM.SILCN=(^02)([0-9]{9})(.{7})([0-9]{6})([0-9]{6})([0-9]{16})([0-9]{16})([0-9]{1})(.{15})
BPM.PATTERN.RECORDLCN.SILCN=(^03)([0-9]{7})([0-9]{24})(.{35})(.{35})([0-9]{16})([0-9]{1})([0-9]{1})(.{35})(.{35})(.{35})([0-9]{8})([0-9]{8})([0-9]{1})([0-9]{3})


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER LOT 
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~

### LOT CHQ

BPM.REQ.GETRECORD.LOT.CHQ=SELECT bmch.DTEMI as bmch_dteEmi,ins.DATE AS DATETR,bmch.PK_OBJ_IDT as bmch_PK_OBJ_IDT ,bmtr.AGE_RMT AS bmtr_AGE_RMT,bmtr.CDEBPR as bmtr_CDE_BPR,concat(bmtr.CDEBPR,(select loc from r_multi_37.tr_agence_bpm where age= bmtr.AGE_RMT),bmtr.tiers,bmtr.CDECLT) CPT_REM,(SELECT loc FROM r_multi_37.tr_agence_bpm WHERE age = bmtr.AGE_RMT) LOCR,concat(bmtr.tiers,bmtr.CDECLT) CPTR,(select CLIENT from r_multi_37.tr_cpt_bpm where cpt= bmtr.CDECLT) as RESOC_REM,bmtr.RefCli as REF_REM,concat( bmch.ZBK,bmch.LOC,bmch.cpt,bmch.rib) CPT_TIRE,bmch.RSOC_TIR as RSOC_TIRE,bmch.ADR_TIR as ADR_TIRE,bmch.nser as bmch_nser,bmch.MNT as bmch_mnt FROM p_c_bpm.te_bpm_bpch bmch,p_c_bpm.te_bpm_bptr bmtr,p_c_bpm.te_bpm_ins ins,p_c_bpm.te_obj obj_bmch WHERE (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1)) AND (ins.instance = bmch.instance)AND (ins.instance = bmtr.instance AND bmtr.FK_OPE_MNE='Valid' and  bmtr.OPE_ETA <> 'D' and bmch.OPE_ETA <> 'D' and  CONF='1' and bmch.zbk!=:zbk and ins.DATE=:Date) ;
BPM.REQ.GETSUMRECORD.LOT.CHQ=SELECT count(*) AS NBRCHQ,FORMAT(SUM(MNT), 2) SumMnt FROM p_c_bpm.te_bpm_bpch ch,p_c_bpm.te_bpm_ins ins WHERE ch.ope_eta != 'D' and CONF='1' and ch.instance=ins.INSTANCE and ins.date=:Date and ch.zbk!=:zbk
BPM.OUTDIR.LOT.CHQ=\\\\172.17.0.8\\Sorties\\BPM\\CHQ\\ASIMTV3\\
BPM.PATTERN.RECORDENTETELOT.CHQ=^(ELOT)([0-9]{3})([0-9]{3})([0-9]{3})(MAD)([0-9]{4})([0-9]{16})(.{28})
BPM.PATTERN.RECORDLOT.CHQ=^([0-9]{3})([0-9]{12})([1-2]{1})([0-9]{24})(.{4})(.{35})(.{50})([1-2]{1})([0-9]{7})([0-9]{24})(.{4})(.{35})(.{50})([0-9]{15})([0-9]{8})([0-9]{1})([0-1]{1})(.{275})

### LOT LCN

BPM.REQ.GETRECORD4CALCUL.LOT.LCN=select PK_OBJ_IDT , ADR_BEN ,ADR_RMT ,ADR_TIRE ,CDEAVAL ,CDEBPR ,CDEPRE ,CPT ,CPTT ,DTEEC ,DTEINS ,DTEMI ,LOC ,LOCT ,MNT ,NSER ,RIB ,RIBT,RSOC_BEN,RSOC_RMT ,RSOC_TIRE ,ZBK,ZBKT,ZIB ,ZIBT ,DTEPRE , DTEEXT,DTREG,FLAG_IMP ,RIO,AGE_RMT ,AGE_RMT_LIB ,CDEBPR_RMT ,FLAGEXT FROM p_s_bpm.te_s_bpm_bpslcn where ope_eta != 'D' and CONF='1' and dtepre is null
BPM.REQ.GETRECORD.LOT.LCN=select PK_OBJ_IDT , ADR_BEN ,ADR_RMT ,ADR_TIRE ,CDEAVAL ,CDEBPR ,CDEPRE ,CPT ,CPTT ,DTEEC ,DTEINS ,DTEMI ,LOC ,LOCT ,MNT ,NSER ,RIB ,RIBT,RSOC_BEN,RSOC_RMT ,RSOC_TIRE ,ZBK,ZBKT,ZIB ,ZIBT ,DTEPRE , DTEEXT,DTREG,FLAG_IMP ,RIO,AGE_RMT ,AGE_RMT_LIB ,CDEBPR_RMT ,FLAGEXT FROM p_s_bpm.te_s_bpm_bpslcn where ope_eta != 'D' and CONF='1' and (FLAGEXT is null or FLAGEXT !='1') and dtepre <=:dtePre
BPM.REQ.UPDATEDTEPRE.LOT.LCN=UPDATE  p_s_bpm.te_s_bpm_bpslcn SET DTEPRE =:dtePre  WHERE PK_OBJ_IDT =:pkObjIdt
BPM.REQ.GETSUMRECORD.LOT.LCN=SELECT COUNT(*) AS NBRLCN, FORMAT(SUM(MNT), 2) SumMnt FROM p_s_bpm.te_s_bpm_bpslcn l WHERE l.ope_eta != 'D' AND CONF = '1' and (FLAGEXT is null or FLAGEXT !='1') and dtepre<=:Date and zbkt!=:zbk
BPM.REQ.GETSUMRECORD.LOT.IA.LCN=SELECT COUNT(*) AS NBRLCN, FORMAT(SUM(MNT), 2) SumMnt FROM p_s_bpm.te_s_bpm_bpslcn l WHERE l.ope_eta != 'D' AND CONF = '1' and (FLAGEXT is null or FLAGEXT !='1') and dtepre<=:Date and zbkt=:zbk
BPM.REQ.UPDATEFLAGEXT.LOT.LCN=UPDATE  p_s_bpm.te_s_bpm_bpslcn SET FLAGEXT ='1' ,DTEEXT = DATE_FORMAT(current_date(), "%Y-%m-%d") WHERE PK_OBJ_IDT =:pkObjIdt

BPM.OUTDIR.LOT.LCN=\\\\172.17.0.8\\Sorties\\L_BPM\\ASIMTV3\\
BPM.OUTDIR.LOT.IA.LCN=\\\\172.17.0.8\\Sorties\\L_BPM\\ASIMTV3\\
BPM.PATTERN.RECORDENTETELOT.LCN=^(ELOT)([0-9]{3})([0-9]{3})([0-9]{3})(MAD)([0-9]{4})([0-9]{16})(.{28})
BPM.PATTERN.RECORDLOT.LCN=^([0-9]{3})([0-9]{12})([1-2]{1})([0-9]{24})(.{4})(.{35})(.{50})(.{35})(.{50})([1-2]{1})([0-9]{24})(.{4})(.{35})(.{50})([0-9]{15})([0-9]{7})([0-9]{8})([0-9]{8})([0-1]{1})(.{70})(.{113})

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER ETA
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~

### ETA CHQ

BPM.FOLDER.ETA.CHQ=\\\\172.17.0.10\\Depot\\TCNCRM\\Send\\BPMEXT
BPM.REQ.DATA.CHQ=SELECT bmch.pk_obj_idt AS bmch_pk_obj_idt,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,age_r.Lib age_r_lib,bmtn.OPE_ETA AS bmtn_OPE_ETA,bmtn.Ano AS bmtn_ANO,bmtn.CDEBPR AS bmtn_CDEBPR,bmtn.COUNT_CHQ AS bmtn_COUNT_CHQ,bmtn.DIFF AS bmtn_DIFF,bmtn.DIFF_NB AS bmtn_DIFF_NB,bmtn.LECTEUR AS bmtn_LECTEUR,bmtn.MEM2 AS bmtn_MEM2,bmtn.SUM_CHQ AS bmtn_SUM_CHQ,bmta.OPE_ETA AS bmta_OPE_ETA,bmta.Ano AS bmta_Ano,bmta.CDEBPR AS bmta_CDEBPR,bmta.MEM2 AS bmta_MEM2,bmta.SQCA AS bmta_SQCA,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,bmtr.MNT AS bmtr_MNT,bmtr.CDECLT AS bmtr_CDECLT,bmtr.NBCH+0 AS bmtr_NBCH,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE_RMT AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,bmtr.ANO AS bmtr_ANO,bmch.FK_OPE_MNE AS bmch_fk_ope_mne,bmch.INSTANCE AS bmch_instance,bmch.OPE_ETA AS bmch_ope_eta,bmch.ADR_RMT AS bmch_ADR_RMT,bmch.ADR_TIR AS bmch_ADR_TIR,bmch.AGE AS bmch_AGE,bmch.CDEBPR AS bmch_CDEBPR,bmch.CDE_REJ AS bmch_CDE_REJ,bmch.CPT AS  bmch_CPT,bmch.CPT2 AS bmch_CPT2,bmch.DBL AS bmch_DBLT,bmch.DTEMI AS bmch_DTEEMI,bmch.FLAG_IMP AS bmch_FLAG_IMP,bmch.FLAG_REJET AS bmch_FLAG_REJET,bmch.FLAG_VAL AS bmch_FLAG_AVAL,bmch.LOC AS bmch_LOC,bmch.MEM2 AS bmch_MEM2,(bmch.MNT+0) AS bmch_MNT,bmch.NSER AS bmch_NSER,bmch.RIB AS bmch_RIB,bmch.RIO AS bmch_RIO,bmch.RSOC_TIR AS bmch_RSOC_TIR,(bmch.SQCA+0) AS bmch_SQCA,bmch.ZBK AS bmch_ZBK,(select bq.lib from r_multi_37.tr_banque bq where bmch.ZBK = bq.CDE)  AS bq_lib,bmch.ZIB AS bmch_ZIB,bmch.Ano AS bmch_ANO,bmch.VICE AS bmch_VICE,bmch.CONF AS bmch_CONF,bmch.DTEINV AS bmch_DTEINV,bmch.AGE_RMT AS bmch_AGE_RMT FROM (((((((p_c_bpm.te_bpm_bpch bmch  JOIN p_c_bpm.te_obj obj_bmch)JOIN p_c_bpm.te_bpm_bptr bmtr) JOIN p_c_bpm.te_obj obj_bmtr) JOIN p_c_bpm.te_bpm_bpta bmta)JOIN p_c_bpm.te_bpm_bptn bmtn)JOIN p_c_bpm.te_bpm_ins ins)JOIN r_multi_37.tr_agence_bpm age_r) WHERE((1 = 1)AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmch.INSTANCE)AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)and (age_r.AGE  = bmtr.AGE_RMT)) And ins.date=
BPM.REQ.COUNTDATA.CHQ=SELECT COUNT(*) countValues FROM p_c_bpm.te_bpm_bpch ch,p_c_bpm.te_bpm_ins ins WHERE ins.instance = ch.instance and date=:Date
BPM.REQ.DATA.PCAPT=SELECT  sc.CDESCANNER, age.AGE, sc.TYPE, age.LIB FROM r_multi_37.tr_scanner_bpm sc,r_multi_37.tr_agence_bpm age where age.age=sc.age
BPM.REQ.GETLBLANO.CHQ=SELECT tr_ano.ANO_LIB AS ANO_LIB  FROM r_multi_37.tr_ano where PK_ANO_MNE=:PK_ANO_MNE

### ETA LCN

BPM.FOLDER.ETA.LCN=\\\\172.17.0.10\\Depot\\TCNCRM\\Send\\BPMEXT
BPM.REQ.COUNTDATA.LCN=SELECT COUNT(*) countValues FROM p_l_bpm.te_lbpm_bplcn l, p_l_bpm.te_lbpm_ins ins WHERE ins.instance= l.instance and date=:Date
BPM.REQ.DATA.LCN=select bmlcn.pk_obj_idt AS bmlcn_pk_obj_idt,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,age_r.Lib age_r_lib,(select bq.lib from r_multi_37.tr_banque bq where bmlcn.ZBK = bq.CDE) AS bq_lib,bmtn.OPE_ETA AS bmtn_OPE_ETA,bmtn.Ano AS bmtn_ANO,bmtn.CDEBPR AS bmtn_CDEBPR,bmtn.COUNT_CHQ AS bmtn_COUNT_CHQ,bmtn.DIFF AS bmtn_DIFF,bmtn.DIFF_NB AS bmtn_DIFF_NB,bmtn.LECTEUR AS bmtn_LECTEUR,bmtn.MEM2 AS bmtn_MEM2,bmtn.SUM_CHQ AS bmtn_SUM_CHQ,bmta.OPE_ETA AS bmta_OPE_ETA,bmta.CDEBPR AS bmta_CDEBPR,bmta.MEM2 AS bmta_MEM2,bmta.SQCA AS bmta_SQCA,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,bmtr.MNT AS bmtr_MNT,bmtr.CDECLT AS bmtr_CDECLT,bmtr.NBCH+0 AS bmtr_NBCH ,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE_RMT AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,bmtr.ANO AS bmtr_ANO,bmlcn.FK_OPE_MNE AS bmlcn_fk_ope_mne,bmlcn.INSTANCE AS bmlcn_instance,bmlcn.OPE_ETA AS bmlcn_ope_eta,bmlcn.ADR_RMT AS bmlcn_ADR_RMT,bmlcn.ADR_TIR AS bmlcn_ADR_TIR,bmlcn.AGE AS bmlcn_AGE,bmlcn.CDEBPR AS bmlcn_CDEBPR,bmlcn.CDE_REJ AS bmlcn_CDE_REJ,bmlcn.CPT AS  bmlcn_CPT,bmlcn.CPT2 AS bmlcn_CPT2,bmlcn.DBL AS bmlcn_DBLT,bmlcn.DTEMI AS bmlcn_DTEEMI,bmlcn.FLAG_REJET AS bmlcn_FLAG_REJET,bmlcn.FLAG_VAL AS bmlcn_FLAG_AVAL,bmlcn.LOC AS bmlcn_LOC,bmlcn.MEM2 AS bmlcn_MEM2,(bmlcn.MNT+0) AS bmlcn_MNT,bmlcn.NSER AS bmlcn_NSER,bmlcn.RIB AS bmlcn_RIB,bmlcn.RSOC_TIR AS bmlcn_RSOC_TIR,(bmlcn.SQCA+0) AS bmlcn_SQCA,bmlcn.ZBK AS bmlcn_ZBK,bmlcn.ZIB AS bmlcn_ZIB,bmlcn.Ano AS bmlcn_ANO,bmlcn.CONF AS bmlcn_CONF,bmlcn.VICE AS bmlcn_VICE,bmlcn.AGE_RMT AS bmlcn_AGE_RMT FROM (((((((p_l_bpm.te_lbpm_bplcn bmlcn JOIN p_l_bpm.te_obj obj_bmlcn) JOIN p_l_bpm.te_lbpm_bptr bmtr) JOIN p_l_bpm.te_obj obj_bmtr)JOIN p_l_bpm.te_lbpm_bplta bmta)JOIN p_l_bpm.te_lbpm_bpltn bmtn)JOIN p_l_bpm.te_lbpm_ins ins)JOIN r_multi_37.tr_agence_bpm age_r) WHERE ((1 = 1) AND (ins.INSTANCE = bmtn.INSTANCE) AND (ins.INSTANCE = bmtr.INSTANCE) AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmlcn.INSTANCE) AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT + 1))     AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT) AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT) AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) and (age_r.AGE  = bmtr.AGE_RMT)) And ins.DATE=
BPM.REQ.GETLBLANO.LCN=SELECT tr_ano.ANO_LIB AS ANO_LIB  FROM r_multi_37.tr_ano where PK_ANO_MNE=:PK_ANO_MNE

BPM.REQ.DATA.STKLCN=SELECT  PK_OBJ_IDT,ADR_BEN,ADR_RMT,ADR_TIRE,CDEAVAL,CDEBPR,CDEPRE,CPT,CPTT,DTEEC,DTEINS,DTEMI,LOC,LOCT,MNT,NSER,RIB,RIBT,RSOC_BEN,RSOC_RMT,RSOC_TIRE,ZBK,ZBKT,ZIB,ZIBT,DTEPRE,DTEEXT,DTREG,FLAG_IMP,RIO,MODE_ESC,AGE_RMT,SQCA,AGE_RMT_LIB,CDEBPR_RMT,FLAGEXT,MEm2 FROM p_s_bpm.te_s_bpm_bpslcn WHERE 1=1 AND ope_eta != 'D' AND CONF = '1' AND DTEPRE is not null  AND (DTEEXT  is null or DTEEXT=DATE_FORMAT(current_date(), "%Y-%m-%d"))

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER IMP
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
### IMP CHQ

BPM.INDIR.CRO.CHQ=\\\\172.17.0.8\\Impayes\\BPM\\CHQ\\IN\\
BPM.PATTERN.CROFILE.CHQ=([0-9]{3})(.[0-9]{3})(.[0-9]{3})(.131)(.MAD)(.CRO).succes$
BPM.PATTERN.RECORDCRO.CHQ=([0-9]{3})(MAD)(.{26})([0-9]{8})([0-9]{3})(.{3})(.{12})([0-9]{3})(.{32})([0-9]{1})(.{46})$
BPM.REQ.GETIMP.PROD.CHQ=SELECT bmch.PK_OBJ_IDT bmch_PK_OBJ_IDT,bmch.CPT as bmch_CPT ,bmch.LOC as bmch_LOC,bmch.ZBK as bmch_ZBK,(SELECT lib FROM  r_multi_37.tr_banque where bmch_ZBK=cde) ZBK_LIB,bmch.NSER AS bmch_nser,bmch.RIB AS bmch_rib,bmch.MNT AS bmch_MNT,bmtr.AGE AS bmtr_AGE,(SELECT lib FROM  r_multi_37.tr_agence_bpm where bmtr_AGE=AGE) AGE_LIB,bmtr.CDECLT as bmtr_CPT,bmch.mem2 as bmtn_lecteur,bmch.rio as RIOINI,bmch.SQCA as bmch_SQCA,ins.DATE  as DTE_TRT ,bmch.DTE_SORT  as DTE_SORT  FROM((((((p_c_bpm.te_bpm_bpch bmch JOIN p_c_bpm.te_obj obj_bmch)JOIN p_c_bpm.te_bpm_bptr bmtr)JOIN p_c_bpm.te_obj obj_bmtr)JOIN p_c_bpm.te_bpm_ins ins)JOIN p_c_bpm.te_bpm_bpta bmta)JOIN p_c_bpm.te_bpm_bptn bmtn) WHERE ((1 = 1) AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmch.INSTANCE)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) and FLAG_IMP='1' and bmch.rio=:RIOINI );

BPM.INDIR.IFPCONF.CHQ=\\\\172.17.0.8\\Impayes\\BPM\\
BPM.PATTERN.IFPCONFFILE.CHQ=([0-9]{3})(.[0-9]{3})(.MAD)(.[0-9]{3})(.[0-9]{8}).(ifp|IFP)(.MAILO)$
BPM.PATTERN.RECORDIFP.CONF.CHQ=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})(.{0,3})
#(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
BPM.REQ.ADDIMP.CHQ=INSERT INTO r_ncrm_extraction.ta_imp_chq_bpm(REF,PK_OBJ_IDT,RIO,RIOINI,REJET,ADR_RMT,ADR_TIR,ZBK,AGE_RMT,AGE_RMT_LIB,CPT,CPTT,DTEREG,LOCT,MEM2,MNT,NSER,SQCA,RIB,RSOC_RMT,RSOC_TIRE,ZBK_lib,NOMTIRE,CIN,RC,lieuEmission,MOTIF1,MOTIF2,MOTIF3,REJET_LIB,DTREJET,DTEINS,DTEPRE,DTEemission,DTETRT,DTE_SORT)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select lib from  editions.tr_rejets where REJET=? ),?,?,?,?,?,?);

BPM.INDIR.IFPIA.CHQ=\\\\172.17.0.8\\Impayes\\BPM\\CHQ\\IN\\366
BPM.PATTERN.IFPIAFILE.CHQ=([0-9]{3})(.[0-9]{8})(.IA).(ifp|IFP)
BPM.PATTERN.RECORDIFP.IA.CHQ=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})0([0-9]{7})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
BPM.REQ.GETIMP.PROD.IA.CHQ=SELECT bmch.PK_OBJ_IDT bmch_PK_OBJ_IDT,bmch.CPT as bmch_CPT ,bmch.LOC as bmch_LOC,bmch.ZBK as bmch_ZBK,(SELECT lib FROM  r_multi_37.tr_banque where bmch_ZBK=cde) ZBK_LIB,bmch.NSER AS bmch_nser,bmch.RIB AS bmch_rib,bmch.MNT AS bmch_MNT,bmtr.AGE AS bmtr_AGE,(SELECT lib FROM  r_multi_37.tr_agence_bpm where bmtr_AGE=AGE) AGE_LIB,bmtr.CDECLT as bmtr_CPT,bmch.mem2 as bmtn_lecteur,bmch.rio as RIOINI,bmch.SQCA as bmch_SQCA,ins.DATE  as DTE_TRT ,bmch.DTE_SORT  as DTE_SORT FROM((((((p_c_bpm.te_bpm_bpch bmch JOIN p_c_bpm.te_obj obj_bmch)JOIN p_c_bpm.te_bpm_bptr bmtr)JOIN p_c_bpm.te_obj obj_bmtr)JOIN p_c_bpm.te_bpm_ins ins)JOIN p_c_bpm.te_bpm_bpta bmta)JOIN p_c_bpm.te_bpm_bptn bmtn) WHERE ((1 = 1) AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmch.INSTANCE)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) and FLAG_IMP='1' and bmch.zbk=:ZBKT and bmch.loc=:LOCT and bmch.cpt=:CPTT and bmch.rib=:RIBT and bmch.nser=:NSER and (ins.date=:DTETRT)) ;

BPM.REQ.COUNT.IMP.CHQ=SELECT ZBK,ZBK_lib,DTETRT as DTE,count(*) as CountVal ,"" dteSort FROM r_ncrm_extraction.ta_imp_chq_bpm  where nser is not null and DTETRT is not null group by zbk
BPM.FOLDER.OUT.IMP.CHQ=\\\\172.17.0.10\\Depot\\TCNCRM\\Send\\BPMEXT
BPM.REQ.DATA.IMP.CHQ=SELECT ta_imp_chq_bpm.REF,ta_imp_chq_bpm.PK_OBJ_IDT,ta_imp_chq_bpm.RIO,ta_imp_chq_bpm.RIOINI,ta_imp_chq_bpm.REJET,ta_imp_chq_bpm.ADR_RMT,ta_imp_chq_bpm.ADR_TIR,ta_imp_chq_bpm.CDEBPR,ta_imp_chq_bpm.CDEBPR_RMT,ta_imp_chq_bpm.AGE,ta_imp_chq_bpm.AGE_RMT,ta_imp_chq_bpm.AGE_RMT_LIB,ta_imp_chq_bpm.CPT,ta_imp_chq_bpm.CPTT,ta_imp_chq_bpm.DTEMI,ta_imp_chq_bpm.DTEREG,ta_imp_chq_bpm.LOC,ta_imp_chq_bpm.LOCT,ta_imp_chq_bpm.MEM2,ta_imp_chq_bpm.MNT,ta_imp_chq_bpm.MODE_ESC,ta_imp_chq_bpm.NSER,ta_imp_chq_bpm.SQCA,ta_imp_chq_bpm.RIB,ta_imp_chq_bpm.RIBR,ta_imp_chq_bpm.RSOC_RMT,ta_imp_chq_bpm.RSOC_TIRE,ta_imp_chq_bpm.RSOC_BEN,ta_imp_chq_bpm.ZBK,ta_imp_chq_bpm.ZBK_lib,ta_imp_chq_bpm.NOMTIRE,ta_imp_chq_bpm.CIN,ta_imp_chq_bpm.RC,ta_imp_chq_bpm.lieuEmission,ta_imp_chq_bpm.MOTIF1,ta_imp_chq_bpm.MOTIF2,ta_imp_chq_bpm.MOTIF3,ta_imp_chq_bpm.adresseTire,ta_imp_chq_bpm.REJET_LIB,ta_imp_chq_bpm.DTREJET,ta_imp_chq_bpm.DTEINS,ta_imp_chq_bpm.DTEPRE,ta_imp_chq_bpm.DTEemission,ta_imp_chq_bpm.DTETRT FROM r_ncrm_extraction.ta_imp_chq_bpm where ta_imp_chq_bpm.PK_OBJ_IDT is not null and DTETRT=

# IMP LCN

BPM.INDIR.CRO.LCN=\\\\172.17.0.8\\Impayes\\BPM\\LCN\\IN\\
BPM.PATTERN.CROFILE.LCN=([0-9]{3})(.[0-9]{3})(.[0-9]{3})(.160)(.MAD)(.CRO).succes$
BPM.PATTERN.RECORDCRO.LCN=([0-9]{3})(MAD)(.{26})([0-9]{8})([0-9]{3})(.{3})(.{12})([0-9]{3})(.{32})([0-9]{1})(.{46})$
BPM.REQ.GETIMP.PROD.LCN=SELECT PK_OBJ_IDT bmlcn_PK_OBJ_IDT,CPTT AS bmlcn_CPT,LOCT AS bmlcn_LOC,ZBKT AS bmlcn_ZBK,(SELECT lib FROM r_multi_37.tr_banque  WHERE bmlcn_ZBK = cde) ZBK_LIB,NSER AS bmlcn_nser,RIBT AS bmlcn_rib,MNT AS bmlcn_MNT,AGE AS bmtr_AGE,(SELECT  lib FROM r_multi_37.tr_agence_bpm  WHERE bmtr_AGE = AGE) AGE_LIB,CPT AS bmtr_CPT,MEM2 AS bmtn_lecteur,rio AS RIOINI,DTEINS AS DTE_TRT,DTE_SORT AS DTE_SORT,DTEPRE,DTEEC FROM p_s_bpm.te_s_bpm_bpslcn bmlcn WHERE((1 = 1) AND FLAG_IMP = '1' AND rio = :RIOINI);

BPM.INDIR.IFPCONF.LCN=\\\\172.17.0.8\\Impayes\\BPM\\
BPM.PATTERN.IFPCONFFILE.LCN=([0-9]{3})(.[0-9]{3})(.MAD)(.[0-9]{3})(.[0-9]{8}).(ifp|IFP)(.MAILO)$
BPM.PATTERN.RECORDIFP.CONF.LCN=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})(.{0,3})
#(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})

BPM.INDIR.IFPIA.LCN=\\\\172.17.0.8\\Impayes\\BPM\\LCN\\IN\\366
BPM.PATTERN.IFPIAFILE.LCN=([0-9]{8})(\\.CNP\\.TXT).*
BPM.PATTERN.RECORDIFP.IA.LCN=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
BPM.REQ.GETIMP.PROD.IA.LCN=SELECT bmlcn.PK_OBJ_IDT bmlcn_PK_OBJ_IDT,bmlcn.CPTT as bmlcn_CPT ,bmlcn.LOCT as bmlcn_LOC,bmlcn.ZBKT as bmlcn_ZBK,(SELECT lib FROM r_multi_37.tr_banque where bmlcn_ZBK=cde) ZBK_LIB,bmlcn.NSER AS bmlcn_nser,bmlcn.RIBT AS bmlcn_rib,bmlcn.MNT AS bmlcn_MNT,bmlcn.AGE AS bmlcn_AGE,(SELECT lib FROM r_multi_37.tr_agence where bmlcn_AGE=AGE) AGE_LIB,bmlcn.CPT as bmlcn_CPT,bmlcn.MEM2 as bmlcn_lecteur,bmlcn.rio as RIOINI,bmlcn.DTEINS  as DTE_TRT ,bmlcn.DTE_SORT  as DTE_SORT FROM p_s_bpm.te_s_bpm_bpslcn bmlcn WHERE ((1 = 1)and FLAG_IMP='1' and bmlcn.zbk=:ZBKT and bmlcn.loc=:LOCT and bmlcn.cpt=:CPTT and bmlcn.rib=:RIBT and bmlcn.nser=:NSER and (bmlcn.DTE_SORT=:DTESORT  )
BPM.REQ.ADDIMP.LCN=INSERT INTO r_ncrm_extraction.ta_imp_lcn_bpm(REF,PK_OBJ_IDT,RIO,RIOINI,REJET,ADR_RMT,ADR_TIRE,ZBK,AGE_RMT,AGE_RMT_LIB,CPT,CPTT,LOCT,MEM2,MNT,NSER,RIBT,RSOC_RMT,RSOC_TIRE,ZBK_lib,NOMTIRE,CIN,RC,lieuEmission,MOTIF1,MOTIF2,MOTIF3,REJET_LIB,DTREJET,DTEINS,DTEPRE,DTEemission,DTE_SORT,DTEEC)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select lib from  editions.tr_rejets_lcn where REJET=? ),?,?,?,?,?,?);
BPM.REQ.COUNT.IMP.LCN=SELECT ZBK,ZBK_lib,DTEINS as DTE,count(*) as CountVal,'' dteSort FROM r_ncrm_extraction.ta_imp_lcn_bpm  where nser is not null and DTEINS is not null group by zbk
BPM.FOLDER.OUT.IMP.LCN=\\\\172.17.0.10\\Depot\\TCNCRM\\Send\\BPMEXT
BPM.REQ.DATA.IMP.LCN=SELECT ta_imp_lcn_bpm.REF,ta_imp_lcn_bpm.PK_OBJ_IDT,ta_imp_lcn_bpm.RIO,ta_imp_lcn_bpm.RIOINI,ta_imp_lcn_bpm.REJET,ta_imp_lcn_bpm.ADR_RMT,ta_imp_lcn_bpm.ADR_TIRE,ta_imp_lcn_bpm.CDEBPR,ta_imp_lcn_bpm.CDEBPR_RMT,ta_imp_lcn_bpm.AGE,ta_imp_lcn_bpm.AGE_RMT,ta_imp_lcn_bpm.AGE_RMT_LIB,ta_imp_lcn_bpm.CPT,ta_imp_lcn_bpm.CPTT,ta_imp_lcn_bpm.DTEEC,ta_imp_lcn_bpm.DTEMI,ta_imp_lcn_bpm.DTREG,ta_imp_lcn_bpm.LOC,ta_imp_lcn_bpm.LOCT,ta_imp_lcn_bpm.MEM2,ta_imp_lcn_bpm.MNT,ta_imp_lcn_bpm.MODE_ESC,ta_imp_lcn_bpm.NSER,ta_imp_lcn_bpm.RIB,ta_imp_lcn_bpm.RIBT,ta_imp_lcn_bpm.RSOC_RMT,ta_imp_lcn_bpm.RSOC_TIRE,ta_imp_lcn_bpm.RSOC_BEN,ta_imp_lcn_bpm.ZBK,ta_imp_lcn_bpm.ZBK_lib,ta_imp_lcn_bpm.NOMTIRE,ta_imp_lcn_bpm.CIN,ta_imp_lcn_bpm.RC,ta_imp_lcn_bpm.lieuEmission,ta_imp_lcn_bpm.MOTIF1,ta_imp_lcn_bpm.MOTIF2,ta_imp_lcn_bpm.MOTIF3,ta_imp_lcn_bpm.adresseTire,ta_imp_lcn_bpm.REJET_LIB,ta_imp_lcn_bpm.DTREJET,ta_imp_lcn_bpm.DTEINS,ta_imp_lcn_bpm.DTEPRE,ta_imp_lcn_bpm.DTEemission FROM r_ncrm_extraction.ta_imp_lcn_bpm where ta_imp_lcn_bpm.PK_OBJ_IDT is not null and DTEPRE=

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### GESTION AGENCES & COMPTES
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~

### GESTION AGE

BPM.REQ.GETALL.AGENCE=SELECT AGE,LIB,LOC,DTEINS FROM r_multi_37.tr_agence_bpm
BPM.REQ.GETAGE.BY.CDE=SELECT AGE,LIB,LOC,DTEINS FROM r_multi_37.tr_agence_bpm where AGE=:cdeAge

### GESTION SCANNER

BPM.REQ.GETSCA.BY.AGE=select * from r_multi_37.tr_scanner_bpm s where age=:cdeAge
BPM.REQ.ADDSCA.TOAGE=INSERT INTO r_multi_37.tr_scanner_bpm(CDESCANNER,AGE,TYPE) VALUES (?,?,?)
BPM.REQ.GETALL.COMPTE=SELECT CPT,AGE,CLIENT,TIERS,DTEINS FROM r_multi_37.tr_cpt_bpm




########################################################################################################################################################
				  # QMB #
########################################################################################################################################################

QMB.cde.bq=360
QMB.SOURCE.LOT=000
QMB.SERVER.ADD=\\\\172.17.0.8\\

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER SI  
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~

### SI CHQ JOB

QMB.REQ.GETREMTRAITED.SI.CHQ=SELECT ins.DATE AS DATETR,bmtr.PK_OBJ_IDT as bmtr_PK_OBJ_IDT,bmtr.SQCA  as bmtr_SEQREM,bmtr.AGE AS bmtr_AGE,bmtr.CDECLT as bmtr_CPTREM ,bmtr.NSER AS  bmtr_REFREM,bmtr.NBCH AS bmtr_NBRVALEUR,bmtr.MNT as bmtr_MNTDECLARER,bmtr.RefCli as bmtr_RefCli,Format(sum(bmch.MNT) ,2) AS bmtr_MNTCALCULER,bmtr.MODE_ESC AS bmtr_TYPEREM FROM p_c_qmb.te_qmb_qmch bmch,  p_c_qmb.te_qmb_qmtr bmtr, p_c_qmb.te_qmb_ins ins, p_c_qmb.te_obj obj_bmch WHERE (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (ins.instance = bmch.instance)AND (ins.instance = bmtr.instance)and  bmtr.OPE_ETA <> 'D' AND bmtr.FK_OPE_MNE='Valid' AND bmtr.EXT='0' group by bmtr.PK_OBJ_IDT ;
QMB.REQ.GETVALUETRAITED.SI.CHQ=SELECT bmch.PK_OBJ_IDT bmch_PK_OBJ_IDT,bmch.zbk as bmch_ZBK,bmch.nser as bmch_NUMCHQ,concat(bmch.zbk,bmch.loc,bmch.CPT,bmch.RIB) AS bmch_RIB,bmch.MNT bmch_MNT,bmch.DTEMI bmch_DTEEMIS,bmch.CONF bmch_CONFOR,Bmch.VICE bmch_REJETCONF,bmch.RECTO_US_GR bmch_IMGRECTO,bmch.VERSO_DS_GR bmch_IMGVERSO FROM p_c_qmb.te_qmb_qmch bmch,p_c_qmb.te_qmb_qmtr bmtr,p_c_qmb.te_qmb_ins ins,p_c_qmb.te_obj obj_bmch WHERE (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT)AND( (obj_bmch.FK_OBJMAI_IDT + 1)=bmtr.PK_OBJ_IDT) AND (ins.instance = bmch.instance)AND (ins.instance = bmtr.instance) AND (bmtr.OPE_ETA <> 'D')AND (bmch.OPE_ETA <> 'D')AND  (bmtr.PK_OBJ_IDT = :pk_obj_id_Rem) ;
QMB.REQ.UPDATEEXT.SI.CHQ=UPDATE p_c_qmb.te_qmb_qmtr SET EXT = 1 WHERE (PK_OBJ_IDT = :pk_obj_id_Rem)

QMB.REQ.GETREM_TRAITED_FLAGER.SI.CHQ=SELECT ins.DATE AS DATETR,bmtr.PK_OBJ_IDT as bmtr_PK_OBJ_IDT,bmtr.SQCA  as bmtr_SEQREM,bmtr.AGE AS bmtr_AGE,bmtr.CDECLT as bmtr_CPTREM ,bmtr.NSER AS  bmtr_REFREM,bmtr.NBCH AS bmtr_NBRVALEUR,bmtr.MNT as bmtr_MNTDECLARER,bmtr.RefCli as bmtr_RefCli,Format(sum(bmch.MNT) ,2) AS bmtr_MNTCALCULER,bmtr.MODE_ESC AS bmtr_TYPEREM FROM p_c_qmb.te_qmb_qmch bmch,p_c_qmb.te_qmb_qmtr bmtr,p_c_qmb.te_qmb_ins ins,p_c_qmb.te_obj obj_bmch WHERE (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (ins.instance = bmch.instance)AND (ins.instance = bmtr.instance)and  bmtr.OPE_ETA <> 'D' AND bmtr.FK_OPE_MNE='Valid' AND bmtr.EXT='1' group by bmtr.PK_OBJ_IDT ;
QMB.REQ.GETREM_TRAITED_FLAGER_by_DTE.SI.CHQ=SELECT ins.DATE AS DATETR,bmtr.PK_OBJ_IDT as bmtr_PK_OBJ_IDT,bmtr.SQCA  as bmtr_SEQREM,bmtr.AGE AS bmtr_AGE,bmtr.CDECLT as bmtr_CPTREM ,bmtr.NSER AS  bmtr_REFREM,bmtr.NBCH AS bmtr_NBRVALEUR,bmtr.MNT as bmtr_MNTDECLARER,bmtr.RefCli as bmtr_RefCli,Format(sum(bmch.MNT) ,2) AS bmtr_MNTCALCULER,bmtr.MODE_ESC AS bmtr_TYPEREM FROM  p_c_qmb.te_qmb_qmch bmch,p_c_qmb.te_qmb_qmtr bmtr,p_c_qmb.te_qmb_ins ins,p_c_qmb.te_obj obj_bmch WHERE (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (ins.instance = bmch.instance)AND (ins.instance = bmtr.instance)and  bmtr.OPE_ETA <> 'D' AND bmtr.FK_OPE_MNE='Valid' AND bmtr.EXT='1' and ins.date=:Date group by  bmtr.PK_OBJ_IDT ;

QMB.OUTDIR.SI.CHQ=\\\\172.17.0.10\\Depot\\UMNIA\\Send\\QMBDSI
QMB.PATTERN.RECORDREM.SICHQ=(^02)([0-9]{4})([0-9]{11})([0-9]{7})([0-9]{6})([0-9]{16})([0-9]{16})([0-9]{1})(.{15})
QMB.PATTERN.RECORDCHQ.SICHQ=(^03)([0-9]{7})([0-9]{24})([0-9]{16})([0-9]{8})(0|1)([0-9]{3})
QMB.TIME.JOB.SI.CHQ=0 */5 8-18 ? * MON-FRI

#### SI LCN

QMB.REQ.GETCOUNT.REM.LCN=select count(distinct (nser)) AS nbrRemise FROM p_l_qmb.te_lqmb_qmltr tr,p_l_qmb.te_lqmb_ins ins where tr.INSTANCE=ins.INSTANCE and tr.OPE_ETA<>'D' and ins.date=:Date
QMB.REQ.GETCOUNTANDSUMMNT.LCN= select count(*) AS NBRLCN, Format(sum(lcn.mnt),2) MNTLCN FROM p_l_qmb.te_lqmb_qmlcn lcn, p_l_qmb.te_lqmb_ins ins where lcn.INSTANCE=ins.INSTANCE and lcn.OPE_ETA<>'D' and ins.date=:Date
QMB.REQ.GETREMTRAITED.LCN=select STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,bmtr.pk_obj_idt AS bmtr_pk_obj_idt,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,bmtr.CDECLT AS bmtr_CDECLT,bmtr.MNT AS bmtr_MNTDECL,bmtr.NBCH+0 AS bmtr_NBCH,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE_RMT AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,Format(sum(bmlcn.mnt),2) bmtr_MNTREEL FROM((((((((p_l_qmb.te_lqmb_qmlcn bmlcn  JOIN p_l_qmb.te_obj obj_bmlcn)JOIN p_l_qmb.te_lqmb_qmltr bmtr)JOIN p_l_qmb.te_obj obj_bmtr)JOIN p_l_qmb.te_lqmb_qmlta bmta)JOIN p_l_qmb.te_lqmb_qmltn bmtn)JOIN p_l_qmb.te_lqmb_ins ins)JOIN r_multi_37.tr_banque bq)  JOIN r_multi_37.tr_agence_qmb age_r) WHERE((1 = 1) AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmlcn.INSTANCE)AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT + 1))AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)AND (bmlcn.ZBK = CONVERT( bq.CDE USING UTF8)and (age_r.AGE  = bmtr.AGE_RMT) and DATE=:Date ) and bmtr.OPE_ETA<>'D'and bmlcn.OPE_ETA<>'D') group by bmtr.nser;
QMB.REQ.GETVALUETRAITED.LCN=select bmtr.CDECLT AS bmtr_RIBRMT,bmtr.Nser AS bmtr_nser,0 AS Bmlcn_CODE_STATUS,'0 ' as bmlcn_sign, bmlcn.RECTO_US_GR as bmlcn_RECTO_US_GR,bmlcn.VERSO_DS_GR as bmlcn_VERSO_DS_GR,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,bmlcn.pk_obj_idt AS bmlcn_pk_obj_idt,bmlcn.cdeAval bmlcn_cdeAval,bmlcn.NOM_AVAL bmlcn_NOM_AVAL,bmlcn.cdeend bmlcn_cdeend,bmlcn.NOM_ENDOS bmlcn_cde_nom_endo,bmlcn.NOM_TIREUR bmlcn_cde_NOM_TIREUR,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,bmtr.MNT AS bmtr_MNTDECL,bmtr.CDECLT AS bmtr_CDECLT,bmtr.NBCH+0 AS bmtr_NBCH,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE_RMT AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,bmlcn.pk_obj_idt AS bmlcn_pk_obj_idt,bmlcn.OPE_ETA AS bmlcn_ope_eta,bmlcn.ADR_RMT AS bmlcn_ADR_RMT,bmlcn.ADR_TIR AS bmlcn_ADR_TIR,bmlcn.AGE AS bmlcn_AGE,bmlcn.CDEBPR AS bmlcn_CDEBPR,bmlcn.CDE_REJ AS bmlcn_CDE_REJ,bmlcn.CONF AS bmlcn_CONF,bmlcn.CPT AS  bmlcn_CPT,bmlcn.CPT2 AS bmlcn_CPT2,bmlcn.DBL AS bmlcn_DBLT,bmlcn.DTEMI AS bmlcn_DTEEMI,bmlcn.DTEEC AS bmlcn_DTEEC,bmlcn.DTECRE AS bmlcn_DTECRE,bmlcn.FLAG_REJET AS bmlcn_FLAG_REJET,bmlcn.FLAG_VAL AS bmlcn_FLAG_AVAL,bmlcn.LOC AS bmlcn_LOC,bmlcn.MEM2 AS bmlcn_MEM2,(bmlcn.MNT) AS bmlcn_MNT,bmlcn.NSER AS bmlcn_NSER,bmlcn.RIB AS bmlcn_RIB,bmlcn.RSOC_TIR AS bmlcn_RSOC_TIR,(bmlcn.SQCA+0) AS bmlcn_SQCA,bmlcn.ZBK AS bmlcn_ZBK,bmlcn.ZIB AS bmlcn_ZIB,bmlcn.Ano AS bmlcn_ANO,bmlcn.VICE AS bmlcn_VICE,bmlcn.AGE_RMT AS bmlcn_AGE_RMT FROM((((((((p_l_qmb.te_lqmb_qmlcn bmlcn JOIN p_l_qmb.te_obj obj_bmlcn)JOIN p_l_qmb.te_lqmb_qmltr bmtr)JOIN p_l_qmb.te_obj obj_bmtr)JOIN p_l_qmb.te_lqmb_qmlta bmta)JOIN p_l_qmb.te_lqmb_qmltn bmtn)JOIN p_l_qmb.te_lqmb_ins ins)JOIN   r_multi_37.tr_banque bq)JOIN   r_multi_37.tr_agence_qmb age_r)WHERE((1 = 1)AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmlcn.INSTANCE)AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT+1))AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)AND (bmlcn.ZBK = CONVERT( bq.CDE USING UTF8)and (age_r.AGE  = bmtr.AGE_RMT)and bmtr.pk_obj_idt=:pk_obj_id_Rem) and ins.date=:Date);

QMB.OUTDIR.SI.LCN=\\\\172.17.0.8\\Sorties\\L_QMB\\SI\\
QMB.PATTERN.ENTETE.SILCN=(^0100)([0-9]{6})([0-9]{8})([0-9]{6})([0-9]{16})
QMB.PATTERN.RECORDREM.SILCN=(^02)([0-9]{11})(.{7})([0-9]{6})([0-9]{6})([0-9]{16})([0-9]{16})([0-9]{1})(.{15})
QMB.PATTERN.RECORDLCN.SILCN=(^03)([0-9]{7})([0-9]{24})(.{35})(.{35})([0-9]{16})([0-9]{1})([0-9]{1})(.{35})(.{35})(.{35})([0-9]{8})([0-9]{8})([0-9]{1})([0-9]{3})


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER LOT  
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~

### LOT CHQ

QMB.REQ.GETRECORD.LOT.CHQ=SELECT bmch.DTEMI as bmch_dteEmi,ins.DATE AS DATETR,bmch.PK_OBJ_IDT as bmch_PK_OBJ_IDT ,bmtr.AGE AS bmtr_AGE_RMT,bmtr.CDEBPR as bmtr_CDE_BPR,concat(bmtr.CDEBPR,(select loc from r_multi_37.tr_agence_qmb where age= bmtr.AGE),'00000',bmtr.CDECLT) CPT_REM,(SELECT loc FROM r_multi_37.tr_agence_qmb WHERE age = bmtr.AGE) LOCR,concat('00000',bmtr.CDECLT) CPTR,(select CLIENT from r_multi_37.tr_cpt_qmb where cpt= bmtr.CDECLT) as RESOC_REM,bmtr.RefCli as REF_REM,concat( bmch.ZBK,bmch.LOC,bmch.cpt,bmch.rib) CPT_TIRE,bmch.RSOC_TIR as RSOC_TIRE,bmch.ADR_TIR as ADR_TIRE,bmch.nser as bmch_nser,bmch.MNT as bmch_mnt FROM p_c_qmb.te_qmb_qmch bmch,p_c_qmb.te_qmb_qmtr bmtr,p_c_qmb.te_qmb_ins ins,p_c_qmb.te_obj obj_bmch WHERE (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1)) AND (ins.instance = bmch.instance)AND (ins.instance = bmtr.instance AND bmtr.FK_OPE_MNE='Valid' and  bmtr.OPE_ETA <> 'D' and bmch.OPE_ETA <> 'D' and  CONF='1' and bmch.zbk!=:zbk and ins.DATE=:Date) ;
QMB.REQ.GETSUMRECORD.LOT.CHQ=SELECT count(*) AS NBRCHQ,FORMAT(SUM(MNT), 2) SumMnt FROM p_c_qmb.te_qmb_qmch ch,p_c_qmb.te_qmb_ins ins WHERE ch.ope_eta != 'D' and CONF='1' and ch.instance=ins.INSTANCE and ins.date=:Date and ch.zbk!=:zbk

QMB.OUTDIR.LOT.CHQ=\\\\172.17.0.8\\Sorties\\QMB\\CHQ\\ASIMTV3\\
QMB.PATTERN.RECORDENTETELOT.CHQ=^(ELOT)([0-9]{3})([0-9]{3})([0-9]{3})(MAD)([0-9]{4})([0-9]{16})(.{28})
QMB.PATTERN.RECORDLOT.CHQ=^([0-9]{3})([0-9]{12})([1-2]{1})([0-9]{24})(.{4})(.{35})(.{50})([1-2]{1})([0-9]{7})([0-9]{24})(.{4})(.{35})(.{50})([0-9]{15})([0-9]{8})([0-9]{1})([0-1]{1})(.{275})

### LOT LCN

QMB.REQ.GETRECORD4CALCUL.LOT.LCN=select PK_OBJ_IDT , ADR_BEN ,ADR_RMT ,ADR_TIRE ,CDEAVAL ,CDEBPR ,CDEPRE ,CPT ,CPTT ,DTEEC ,DTEINS ,DTEMI ,LOC ,LOCT ,MNT ,NSER ,RIB ,RIBT,RSOC_BEN,RSOC_RMT ,RSOC_TIRE ,ZBK,ZBKT,ZIB ,ZIBT ,DTEPRE , DTEEXT,DTREG,FLAG_IMP ,RIO,AGE_RMT ,AGE_RMT_LIB ,CDEBPR_RMT ,FLAGEXT FROM p_s_qmb.te_s_qmb_qmslcn where ope_eta != 'D' and CONF='1' and dtepre is null
QMB.REQ.GETRECORD.LOT.LCN=select PK_OBJ_IDT , ADR_BEN ,ADR_RMT ,ADR_TIRE ,CDEAVAL ,CDEBPR ,CDEPRE ,CPT ,CPTT ,DTEEC ,DTEINS ,DTEMI ,LOC ,LOCT ,MNT ,NSER ,RIB ,RIBT,RSOC_BEN,RSOC_RMT ,RSOC_TIRE ,ZBK,ZBKT,ZIB ,ZIBT ,DTEPRE , DTEEXT,DTREG,FLAG_IMP ,RIO,AGE_RMT ,AGE_RMT_LIB ,CDEBPR_RMT ,FLAGEXT FROM p_s_qmb.te_s_qmb_qmslcn where ope_eta != 'D' and CONF='1' and (FLAGEXT is null or FLAGEXT !='1') and dtepre <=:dtePre
QMB.REQ.UPDATEDTEPRE.LOT.LCN=UPDATE  p_s_qmb.te_s_qmb_qmslcn SET DTEPRE =:dtePre  WHERE PK_OBJ_IDT =:pkObjIdt
QMB.REQ.GETSUMRECORD.LOT.LCN=SELECT COUNT(*) AS NBRLCN, FORMAT(SUM(MNT), 2) SumMnt FROM p_s_qmb.te_s_qmb_qmslcn l WHERE l.ope_eta != 'D' AND CONF = '1' and dtepre<=:Date and (FLAGEXT is null or FLAGEXT !='1') and zbkt!=:zbk
QMB.REQ.GETSUMRECORD.LOT.IA.LCN=SELECT COUNT(*) AS NBRLCN, FORMAT(SUM(MNT), 2) SumMnt FROM p_s_qmb.te_s_qmb_qmslcn l WHERE l.ope_eta != 'D' AND CONF = '1' and dtepre<=:Date and (FLAGEXT is null or FLAGEXT !='1') and zbkt=:zbk
QMB.REQ.UPDATEFLAGEXT.LOT.LCN=UPDATE  p_s_qmb.te_s_qmb_qmslcn SET FLAGEXT ='1' ,DTEEXT = DATE_FORMAT(current_date(), "%Y-%m-%d") WHERE PK_OBJ_IDT =:pkObjIdt

QMB.OUTDIR.LOT.LCN=\\\\172.17.0.8\\Sorties\\L_QMB\\ASIMTV3\\
QMB.OUTDIR.LOT.IA.LCN=\\\\172.17.0.8\\Sorties\\L_QMB\\ASIMTV3\\
QMB.PATTERN.RECORDENTETELOT.LCN=^(ELOT)([0-9]{3})([0-9]{3})([0-9]{3})(MAD)([0-9]{4})([0-9]{16})(.{28})
QMB.PATTERN.RECORDLOT.LCN=^([0-9]{3})([0-9]{12})([1-2]{1})([0-9]{24})(.{4})(.{35})(.{50})(.{35})(.{50})([1-2]{1})([0-9]{24})(.{4})(.{35})(.{50})([0-9]{15})([0-9]{7})([0-9]{8})([0-9]{8})([0-1]{1})(.{70})(.{113})

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER ETA  
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~

### ETA CHQ

QMB.FOLDER.ETA.CHQ=\\\\172.17.0.10\\Depot\\TCNCRM\\Send\\QMBEXT\\
QMB.REQ.DATA.CHQ=SELECT bmch.pk_obj_idt AS bmch_pk_obj_idt,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,age_r.Lib age_r_lib,bmtn.OPE_ETA AS bmtn_OPE_ETA,bmtn.Ano AS bmtn_ANO,bmtn.CDEBPR AS bmtn_CDEBPR,bmtn.COUNT_CHQ AS bmtn_COUNT_CHQ,bmtn.DIFF AS bmtn_DIFF,bmtn.DIFF_NB AS bmtn_DIFF_NB,bmtn.LECTEUR AS bmtn_LECTEUR,bmtn.MEM2 AS bmtn_MEM2,bmtn.SUM_CHQ AS bmtn_SUM_CHQ,bmta.OPE_ETA AS bmta_OPE_ETA,bmta.Ano AS bmta_Ano,bmta.CDEBPR AS bmta_CDEBPR,bmta.MEM2 AS bmta_MEM2,bmta.SQCA AS bmta_SQCA,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,bmtr.MNT AS bmtr_MNT,bmtr.CDECLT AS bmtr_CDECLT,bmtr.NBCH+0 AS bmtr_NBCH,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE_RMT AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,bmtr.ANO AS bmtr_ANO,bmch.FK_OPE_MNE AS bmch_fk_ope_mne,bmch.INSTANCE AS bmch_instance,bmch.OPE_ETA AS bmch_ope_eta,bmch.ADR_RMT AS bmch_ADR_RMT,bmch.ADR_TIR AS bmch_ADR_TIR,bmch.AGE AS bmch_AGE,bmch.CDEBPR AS bmch_CDEBPR,bmch.CDE_REJ AS bmch_CDE_REJ,bmch.CPT AS  bmch_CPT,bmch.CPT2 AS bmch_CPT2,bmch.DBL AS bmch_DBLT,bmch.DTEMI AS bmch_DTEEMI,bmch.FLAG_IMP AS bmch_FLAG_IMP,bmch.FLAG_REJET AS bmch_FLAG_REJET,bmch.FLAG_VAL AS bmch_FLAG_AVAL,bmch.LOC AS bmch_LOC,bmch.MEM2 AS bmch_MEM2,(bmch.MNT+0) AS bmch_MNT,bmch.NSER AS bmch_NSER,bmch.RIB AS bmch_RIB,bmch.RIO AS bmch_RIO,bmch.RSOC_TIR AS bmch_RSOC_TIR,(bmch.SQCA+0) AS bmch_SQCA,bmch.ZBK AS bmch_ZBK,(select bq.lib from r_multi_37.tr_banque bq where bmch.ZBK = bq.CDE)  AS bq_lib,bmch.ZIB AS bmch_ZIB,bmch.Ano AS bmch_ANO,bmch.VICE AS bmch_VICE,bmch.CONF AS bmch_CONF,bmch.DTEINV AS bmch_DTEINV,bmch.AGE_RMT AS bmch_AGE_RMT FROM (((((((p_c_qmb.te_qmb_qmch bmch JOIN p_c_qmb.te_obj obj_bmch) JOIN p_c_qmb.te_qmb_qmtr bmtr)JOIN p_c_qmb.te_obj obj_bmtr)JOIN p_c_qmb.te_qmb_qmta bmta)JOIN p_c_qmb.te_qmb_qmtn bmtn)JOIN p_c_qmb.te_qmb_ins ins)JOIN r_multi_37.tr_agence_qmb age_r) WHERE((1 = 1)AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmch.INSTANCE)AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)and (age_r.AGE  = bmtr.AGE)) And ins.date=
QMB.REQ.COUNTDATA.CHQ=SELECT COUNT(*) countValues FROM p_c_qmb.te_qmb_qmch ch,p_c_qmb.te_qmb_ins ins WHERE ins.instance = ch.instance and date=:Date
QMB.REQ.DATA.PCAPT=SELECT  sc.CDESCANNER, age.AGE, sc.TYPE, age.LIB FROM r_multi_37.tr_scanner_qmb sc,r_multi_37.tr_agence_qmb age where age.age=sc.age
QMB.REQ.GETLBLANO.CHQ=SELECT tr_ano.ANO_LIB AS ANO_LIB  FROM r_multi_37.tr_ano where PK_ANO_MNE=:PK_ANO_MNE


### ETA LCN

QMB.FOLDER.ETA.LCN=\\\\172.17.0.10\\Depot\\TCNCRM\\Send\\QMBEXT\\
QMB.REQ.COUNTDATA.LCN=SELECT COUNT(*) countValues FROM p_l_qmb.te_lqmb_qmlcn l, p_l_qmb.te_lqmb_ins ins WHERE ins.instance= l.instance and date=:Date
QMB.REQ.DATA.LCN=select bmlcn.pk_obj_idt AS bmlcn_pk_obj_idt,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,age_r.Lib age_r_lib,(select bq.lib from r_multi_37.tr_banque bq where bmlcn.ZBK = bq.CDE) AS bq_lib,bmtn.OPE_ETA AS bmtn_OPE_ETA,bmtn.Ano AS bmtn_ANO,bmtn.CDEBPR AS bmtn_CDEBPR,bmtn.COUNT_CHQ AS bmtn_COUNT_CHQ,bmtn.DIFF AS bmtn_DIFF,bmtn.DIFF_NB AS bmtn_DIFF_NB,bmtn.LECTEUR AS bmtn_LECTEUR,bmtn.MEM2 AS bmtn_MEM2,bmtn.SUM_CHQ AS bmtn_SUM_CHQ,bmta.OPE_ETA AS bmta_OPE_ETA,bmta.CDEBPR AS bmta_CDEBPR,bmta.MEM2 AS bmta_MEM2,bmta.SQCA AS bmta_SQCA,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,bmtr.MNT AS bmtr_MNT,bmtr.CDECLT AS bmtr_CDECLT,bmtr.NBCH+0 AS bmtr_NBCH ,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE_RMT AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,bmtr.ANO AS bmtr_ANO,bmlcn.FK_OPE_MNE AS bmlcn_fk_ope_mne,bmlcn.INSTANCE AS bmlcn_instance,bmlcn.OPE_ETA AS bmlcn_ope_eta,bmlcn.ADR_RMT AS bmlcn_ADR_RMT,bmlcn.ADR_TIR AS bmlcn_ADR_TIR,bmlcn.AGE AS bmlcn_AGE,bmlcn.CDEBPR AS bmlcn_CDEBPR,bmlcn.CDE_REJ AS bmlcn_CDE_REJ,bmlcn.CPT AS  bmlcn_CPT,bmlcn.CPT2 AS bmlcn_CPT2,bmlcn.DBL AS bmlcn_DBLT,bmlcn.DTEMI AS bmlcn_DTEEMI,bmlcn.FLAG_REJET AS bmlcn_FLAG_REJET,bmlcn.FLAG_VAL AS bmlcn_FLAG_AVAL,bmlcn.LOC AS bmlcn_LOC,bmlcn.MEM2 AS bmlcn_MEM2,(bmlcn.MNT+0) AS bmlcn_MNT,bmlcn.NSER AS bmlcn_NSER,bmlcn.RIB AS bmlcn_RIB,bmlcn.RSOC_TIR AS bmlcn_RSOC_TIR,(bmlcn.SQCA+0) AS bmlcn_SQCA,bmlcn.ZBK AS bmlcn_ZBK,bmlcn.ZIB AS bmlcn_ZIB,bmlcn.Ano AS bmlcn_ANO,bmlcn.CONF AS bmlcn_CONF,bmlcn.VICE AS bmlcn_VICE,bmlcn.AGE_RMT AS bmlcn_AGE_RMT FROM (((((((p_l_qmb.te_lqmb_qmlcn bmlcn JOIN p_l_qmb.te_obj obj_bmlcn) JOIN p_l_qmb.te_lqmb_qmltr bmtr) JOIN p_l_qmb.te_obj obj_bmtr)JOIN p_l_qmb.te_lqmb_qmlta bmta)JOIN p_l_qmb.te_lqmb_qmltn bmtn)JOIN p_l_qmb.te_lqmb_ins ins)JOIN r_multi_37.tr_agence_qmb age_r) WHERE ((1 = 1) AND (ins.INSTANCE = bmtn.INSTANCE) AND (ins.INSTANCE = bmtr.INSTANCE) AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmlcn.INSTANCE) AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT + 1))     AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT) AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT) AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) and (age_r.AGE  = bmtr.AGE_RMT))  And ins.DATE=
QMB.REQ.GETLBLANO.LCN=SELECT tr_ano.ANO_LIB AS ANO_LIB  FROM r_multi_37.tr_ano where PK_ANO_MNE=:PK_ANO_MNE

QMB.REQ.DATA.STKLCN=SELECT  PK_OBJ_IDT,ADR_BEN,ADR_RMT,ADR_TIRE,CDEAVAL,CDEBPR,CDEPRE,CPT,CPTT,DTEEC,DTEINS,DTEMI,LOC,LOCT,MNT,NSER,RIB,RIBT,RSOC_BEN,RSOC_RMT,RSOC_TIRE,ZBK,ZBKT,ZIB,ZIBT,DTEPRE,DTEEXT,DTREG,FLAG_IMP,RIO,MODE_ESC,AGE_RMT,SQCA,AGE_RMT_LIB,CDEBPR_RMT,FLAGEXT,MEm2 FROM p_s_qmb.te_s_qmb_qmslcn WHERE 1=1 AND ope_eta != 'D' AND CONF = '1' AND DTEPRE is not null  AND (DTEEXT  is null or DTEEXT=DATE_FORMAT(current_date(), "%Y-%m-%d"))

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER IMP 
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
### IMP CHQ

QMB.INDIR.CRO.CHQ=\\\\172.17.0.8\\Impayes\\QMB\\CHQ\\IN\\
QMB.PATTERN.CROFILE.CHQ=([0-9]{3})(.[0-9]{3})(.[0-9]{3})(.131)(.MAD)(.CRO).succes$
QMB.PATTERN.RECORDCRO.CHQ=([0-9]{3})(MAD)(.{26})([0-9]{8})(131)(.{3})(.{12})([0-9]{3})(.{32})([0-1]{1})(.{46})$
#([0-9]{3})(MAD)(.{26})([0-9]{8})([0-9]{3})(.{3})(.{12})([0-9]{3})(.{32})([0-9]{1})(.{46})$
QMB.REQ.GETIMP.PROD.CHQ=SELECT bmch.PK_OBJ_IDT bmch_PK_OBJ_IDT,bmch.CPT as bmch_CPT ,bmch.LOC as bmch_LOC,bmch.ZBK as bmch_ZBK,(SELECT lib FROM  r_multi_37.tr_banque where bmch_ZBK=cde) ZBK_LIB,bmch.NSER AS bmch_nser,bmch.RIB AS bmch_rib,bmch.MNT AS bmch_MNT,bmtr.AGE AS bmtr_AGE,(SELECT lib FROM  r_multi_37.tr_agence_qmb where bmtr_AGE=AGE) AGE_LIB,bmtr.CDECLT as bmtr_CPT,bmch.mem2 as bmtn_lecteur,bmch.rio as RIOINI,bmch.SQCA as bmch_SQCA,ins.DATE  as DTE_TRT ,bmch.DTE_SORT  as DTE_SORT  FROM ((((((p_c_qmb.te_qmb_qmch bmch JOIN p_c_qmb.te_obj obj_bmch)JOIN p_c_qmb.te_qmb_qmtr bmtr)JOIN p_c_qmb.te_obj obj_bmtr)JOIN p_c_qmb.te_qmb_ins ins)JOIN p_c_qmb.te_qmb_qmta bmta)JOIN p_c_qmb.te_qmb_qmtn bmtn) WHERE ((1 = 1) AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmch.INSTANCE)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) and FLAG_IMP='1' and bmch.rio=:RIOINI );

QMB.INDIR.IFPCONF.CHQ=\\\\172.17.0.8\\Impayes\\QMB\\
QMB.PATTERN.IFPCONFFILE.CHQ=([0-9]{3})(.[0-9]{3})(.MAD)(.[0-9]{3})(.[0-9]{8}).(ifp|IFP)(.*)
QMB.PATTERN.RECORDIFP.CONF.CHQ=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})(.{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})(.{0,3})
QMB.REQ.ADDIMP.CHQ=INSERT INTO r_ncrm_extraction.ta_imp_chq_qmb(REF,PK_OBJ_IDT,RIO,RIOINI,REJET,ADR_RMT,ADR_TIR,ZBK,AGE_RMT,AGE_RMT_LIB,CPT,CPTT,DTEREG,LOCT,MEM2,MNT,NSER,SQCA,RIB,RSOC_RMT,RSOC_TIRE,ZBK_lib,NOMTIRE,CIN,RC,lieuEmission,MOTIF1,MOTIF2,MOTIF3,REJET_LIB,DTREJET,DTEINS,DTEPRE,DTEemission,DTETRT,DTE_SORT)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select lib from  editions.tr_rejets where REJET=? ),?,?,?,?,?,?);

QMB.INDIR.IFPIA.CHQ=\\\\172.17.0.8\\Impayes\\QMB\\CHQ\\IN\\360
QMB.PATTERN.IFPIAFILE.CHQ=([0-9]{3})(.[0-9]{8})(.IA).(ifp|IFP)
QMB.PATTERN.RECORDIFP.IA.CHQ=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})0([0-9]{7})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
QMB.REQ.GETIMP.PROD.IA.CHQ=SELECT bmch.PK_OBJ_IDT bmch_PK_OBJ_IDT,bmch.CPT as bmch_CPT ,bmch.LOC as bmch_LOC,bmch.ZBK as bmch_ZBK,(SELECT lib FROM  r_multi_37.tr_banque where bmch_ZBK=cde) ZBK_LIB,bmch.NSER AS bmch_nser,bmch.RIB AS bmch_rib,bmch.MNT AS bmch_MNT,bmtr.AGE AS bmtr_AGE,(SELECT lib FROM  r_multi_37.tr_agence_qmb where bmtr_AGE=AGE) AGE_LIB,bmtr.CDECLT as bmtr_CPT,bmch.mem2 as bmtn_lecteur,bmch.rio as RIOINI,bmch.SQCA as bmch_SQCA,ins.DATE  as DTE_TRT ,bmch.DTE_SORT  as DTE_SORT FROM ((((((p_c_qmb.te_qmb_qmch bmch JOIN p_c_qmb.te_obj obj_bmch)JOIN p_c_qmb.te_qmb_qmtr bmtr)JOIN p_c_qmb.te_obj obj_bmtr)JOIN p_c_qmb.te_qmb_ins ins)JOIN p_c_qmb.te_qmb_qmta bmta)JOIN p_c_qmb.te_qmb_qmtn bmtn) WHERE ((1 = 1) AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmch.INSTANCE)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) and FLAG_IMP='1' and bmch.zbk=:ZBKT and bmch.loc=:LOCT and bmch.cpt=:CPTT and bmch.rib=:RIBT and bmch.nser=:NSER and (ins.date=:DTETRT)) ;

QMB.REQ.COUNT.IMP.CHQ=SELECT ZBK,ZBK_lib,DTETRT as DTE,count(*) as CountVal ,DTE_SORT dteSort FROM r_ncrm_extraction.ta_imp_chq_qmb  where nser is not null and DTETRT is not null group by zbk

QMB.FOLDER.OUT.IMP.CHQ=\\\\172.17.0.10\\Depot\\TCNCRM\\Send\\QMBEXT\\
QMB.REQ.DATA.IMP.CHQ=SELECT ta_imp_chq_bpm.REF,ta_imp_chq_bpm.PK_OBJ_IDT,ta_imp_chq_bpm.RIO,ta_imp_chq_bpm.RIOINI,ta_imp_chq_bpm.REJET,ta_imp_chq_bpm.ADR_RMT,ta_imp_chq_bpm.ADR_TIR,ta_imp_chq_bpm.CDEBPR,ta_imp_chq_bpm.CDEBPR_RMT,ta_imp_chq_bpm.AGE,ta_imp_chq_bpm.AGE_RMT,ta_imp_chq_bpm.AGE_RMT_LIB,ta_imp_chq_bpm.CPT,ta_imp_chq_bpm.CPTT,ta_imp_chq_bpm.DTEMI,ta_imp_chq_bpm.DTEREG,ta_imp_chq_bpm.LOC,ta_imp_chq_bpm.LOCT,ta_imp_chq_bpm.MEM2,ta_imp_chq_bpm.MNT,ta_imp_chq_bpm.MODE_ESC,ta_imp_chq_bpm.NSER,ta_imp_chq_bpm.SQCA,ta_imp_chq_bpm.RIB,ta_imp_chq_bpm.RIBR,ta_imp_chq_bpm.RSOC_RMT,ta_imp_chq_bpm.RSOC_TIRE,ta_imp_chq_bpm.RSOC_BEN,ta_imp_chq_bpm.ZBK,ta_imp_chq_bpm.ZBK_lib,ta_imp_chq_bpm.NOMTIRE,ta_imp_chq_bpm.CIN,ta_imp_chq_bpm.RC,ta_imp_chq_bpm.lieuEmission,ta_imp_chq_bpm.MOTIF1,ta_imp_chq_bpm.MOTIF2,ta_imp_chq_bpm.MOTIF3,ta_imp_chq_bpm.adresseTire,ta_imp_chq_bpm.REJET_LIB,ta_imp_chq_bpm.DTREJET,ta_imp_chq_bpm.DTEINS,ta_imp_chq_bpm.DTEPRE,ta_imp_chq_bpm.DTEemission,ta_imp_chq_bpm.DTETRT FROM r_ncrm_extraction.ta_imp_chq_qmb ta_imp_chq_bpm where ta_imp_chq_bpm.PK_OBJ_IDT is not null and DTETRT=


# IMP LCN

QMB.INDIR.CRO.LCN=\\\\172.17.0.8\\Impayes\\QMB\\LCN\\IN\\
QMB.PATTERN.CROFILE.LCN=([0-9]{3})(.[0-9]{3})(.[0-9]{3})(.160)(.MAD)(.CRO).succes$
QMB.PATTERN.RECORDCRO.LCN=([0-9]{3})(MAD)(.{26})([0-9]{8})([0-9]{3})(.{3})(.{12})([0-9]{3})(.{32})([0-9]{1})(.{46})$
QMB.REQ.GETIMP.PROD.LCN=SELECT PK_OBJ_IDT bmlcn_PK_OBJ_IDT,CPTT AS bmlcn_CPT,LOCT AS bmlcn_LOC,ZBKT AS bmlcn_ZBK,(SELECT lib FROM r_multi_37.tr_banque  WHERE bmlcn_ZBK = cde) ZBK_LIB,NSER AS bmlcn_nser,RIBT AS bmlcn_rib,MNT AS bmlcn_MNT,AGE AS bmtr_AGE,(SELECT  lib FROM r_multi_37.tr_agence_qmb  WHERE bmtr_AGE = AGE) AGE_LIB,CPT AS bmtr_CPT,MEM2 AS bmtn_lecteur,rio AS RIOINI,DTEINS AS DTE_TRT,DTE_SORT AS DTE_SORT,DTEPRE,DTEEC FROM p_s_qmb.te_s_qmb_qmslcn bmlcn WHERE((1 = 1) AND FLAG_IMP = '1' AND rio = :RIOINI);

QMB.INDIR.IFPCONF.LCN=\\\\172.17.0.8\\Impayes\\QMB\\
QMB.PATTERN.IFPCONFFILE.LCN=([0-9]{3})(.[0-9]{3})(.MAD)(.[0-9]{3})(.[0-9]{8}).(ifp|IFP)(.MAILO)
QMB.PATTERN.RECORDIFP.CONF.LCN=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})(.{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})(.{0,3})

QMB.INDIR.IFPIA.LCN=\\\\172.17.0.8\\Impayes\\QMB\\LCN\\IN\\360
QMB.PATTERN.IFPIAFILE.LCN=([0-9]{8})(\\.CNP\\.TXT).*
QMB.PATTERN.RECORDIFP.IA.LCN=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
QMB.REQ.GETIMP.PROD.IA.LCN=SELECT bmlcn.PK_OBJ_IDT bmlcn_PK_OBJ_IDT,bmlcn.CPTT as bmlcn_CPT ,bmlcn.LOCT as bmlcn_LOC,bmlcn.ZBKT as bmlcn_ZBK,(SELECT lib FROM r_multi_37.tr_banque where bmlcn_ZBK=cde) ZBK_LIB,bmlcn.NSER AS bmlcn_nser,bmlcn.RIBT AS bmlcn_rib,bmlcn.MNT AS bmlcn_MNT,bmlcn.AGE AS bmlcn_AGE,(SELECT lib FROM r_multi_37.tr_agence_qmb where bmlcn_AGE=AGE) AGE_LIB,bmlcn.CPT as bmlcn_CPT,bmlcn.MEM2 as bmlcn_lecteur,bmlcn.rio as RIOINI,bmlcn.DTEINS  as DTE_TRT ,bmlcn.DTE_SORT  as DTE_SORT FROM p_s_qmb.te_s_qmb_qmslcn bmlcn WHERE ((1 = 1)and FLAG_IMP='1' and bmlcn.zbk=:ZBKT and bmlcn.loc=:LOCT and bmlcn.cpt=:CPTT and bmlcn.rib=:RIBT and bmlcn.nser=:NSER and (bmlcn.DTE_SORT=:DTESORT  )
QMB.REQ.ADDIMP.LCN=INSERT INTO r_ncrm_extraction.ta_imp_lcn_qmb(REF,PK_OBJ_IDT,RIO,RIOINI,REJET,ADR_RMT,ADR_TIRE,ZBK,AGE_RMT,AGE_RMT_LIB,CPT,CPTT,LOCT,MEM2,MNT,NSER,RIBT,RSOC_RMT,RSOC_TIRE,ZBK_lib,NOMTIRE,CIN,RC,lieuEmission,MOTIF1,MOTIF2,MOTIF3,REJET_LIB,DTREJET,DTEINS,DTEPRE,DTEemission,DTE_SORT,DTEEC)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select lib from  editions.tr_rejets_lcn where REJET=? ),?,?,?,?,?,?);
QMB.REQ.COUNT.IMP.LCN=SELECT ZBK,ZBK_lib,DTEINS as DTE,count(*) as CountVal,DTEPRE dteSort FROM r_ncrm_extraction.ta_imp_lcn_qmb where nser is not null and DTEINS is not null group by zbk



QMB.FOLDER.OUT.IMP.LCN=\\\\172.17.0.10\\Depot\\TCNCRM\\Send\\QMBEXT\\
QMB.REQ.DATA.IMP.LCN=SELECT ta_imp_lcn_qmb.REF,ta_imp_lcn_qmb.PK_OBJ_IDT,ta_imp_lcn_qmb.RIO,ta_imp_lcn_qmb.RIOINI,ta_imp_lcn_qmb.REJET,ta_imp_lcn_qmb.ADR_RMT,ta_imp_lcn_qmb.ADR_TIRE,ta_imp_lcn_qmb.CDEBPR,ta_imp_lcn_qmb.CDEBPR_RMT,ta_imp_lcn_qmb.AGE,ta_imp_lcn_qmb.AGE_RMT,ta_imp_lcn_qmb.AGE_RMT_LIB,ta_imp_lcn_qmb.CPT,ta_imp_lcn_qmb.CPTT,ta_imp_lcn_qmb.DTEEC,ta_imp_lcn_qmb.DTEMI,ta_imp_lcn_qmb.DTREG,ta_imp_lcn_qmb.LOC,ta_imp_lcn_qmb.LOCT,ta_imp_lcn_qmb.MEM2,ta_imp_lcn_qmb.MNT,ta_imp_lcn_qmb.MODE_ESC,ta_imp_lcn_qmb.NSER,ta_imp_lcn_qmb.RIB,ta_imp_lcn_qmb.RIBT,ta_imp_lcn_qmb.RSOC_RMT,ta_imp_lcn_qmb.RSOC_TIRE,ta_imp_lcn_qmb.RSOC_BEN,ta_imp_lcn_qmb.ZBK,ta_imp_lcn_qmb.ZBK_lib,ta_imp_lcn_qmb.NOMTIRE,ta_imp_lcn_qmb.CIN,ta_imp_lcn_qmb.RC,ta_imp_lcn_qmb.lieuEmission,ta_imp_lcn_qmb.MOTIF1,ta_imp_lcn_qmb.MOTIF2,ta_imp_lcn_qmb.MOTIF3,ta_imp_lcn_qmb.adresseTire,ta_imp_lcn_qmb.REJET_LIB,ta_imp_lcn_qmb.DTREJET,ta_imp_lcn_qmb.DTEINS,ta_imp_lcn_qmb.DTEPRE,ta_imp_lcn_qmb.DTEemission FROM r_ncrm_extraction.ta_imp_lcn_qmb where ta_imp_lcn_qmb.PK_OBJ_IDT is not null and DTEPRE=

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### GESTION AGENCES & COMPTES 
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~

### GESTION AGE

QMB.REQ.GETALL.AGENCE=SELECT AGE,LIB,LOC,DTEINS FROM r_multi_37.tr_agence_qmb
QMB.REQ.GETAGE.BY.CDE=SELECT AGE,LIB,LOC,DTEINS FROM r_multi_37.tr_agence_qmb where AGE=:cdeAge

### GESTION SCANNER
QMB.REQ.GETSCA.BY.AGE=select * from r_multi_37.tr_scanner_qmb s where age=:cdeAge
QMB.REQ.ADDSCA.TOAGE=INSERT INTO r_multi_37.tr_scanner_qmb(CDESCANNER,AGE,TYPE) VALUES (?,?,?)
QMB.REQ.GETALL.COMPTE=SELECT CPT,AGE,CLIENT,TIERS,DTEINS FROM r_multi_37.tr_cpt_qmb





#######################################################################################################################################
				  # PCDM #
#######################################################################################################################################
PCDM.cde.bq=364
PCDM.SOURCE.LOT=000
PCDM.SERVER.ADD=\\\\172.16.0.6\\
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER SI
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
### SI CHQ
PCDM.REQ.GETREM_TRAITED_FLAGER.SI.CHQ=SELECT ins.DATE AS DATETR,bmtr.PK_OBJ_IDT as bmtr_PK_OBJ_IDT,bmtr.SQCA  as bmtr_SEQREM,bmtr.AGE AS bmtr_AGE,bmtr.CDECLT as bmtr_CPTREM ,bmtr.NSER AS  bmtr_REFREM,bmtr.NBCH AS bmtr_NBRVALEUR,bmtr.MNT as bmtr_MNTDECLARER,bmtr.RefCli as bmtr_RefCli,Format(sum(bmch.MNT) ,2) AS bmtr_MNTCALCULER,bmtr.MODE_ESC AS bmtr_TYPEREM FROM p_c_pcdma.te_pcdma_cdch bmch,p_c_pcdma.te_pcdma_cdtr bmtr,p_c_pcdma.te_pcdma_ins ins,p_c_pcdma.te_obj obj_bmch WHERE (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (ins.instance = bmch.instance)AND (ins.instance = bmtr.instance)and  bmtr.OPE_ETA <> 'D' AND bmtr.FK_OPE_MNE='Valid' AND bmtr.EXT='1' group by bmtr.nser ;

#### SI LCN

PCDM.REQ.GETCOUNT.REM.LCN=select count(distinct (nser)) AS nbrRemise FROM p_l_pcdma.te_lpcdma_cdltr tr,p_l_pcdma.te_lpcdma_ins ins where tr.INSTANCE=ins.INSTANCE and tr.OPE_ETA<>'D' and ins.date=:Date
PCDM.REQ.GETCOUNTANDSUMMNT.LCN= select count(*) AS NBRLCN, Format(sum(lcn.mnt),2) MNTLCN FROM  p_l_pcdma.te_lpcdma_cdlcn lcn,p_l_pcdma.te_lpcdma_ins ins where lcn.INSTANCE=ins.INSTANCE and lcn.OPE_ETA<>'D' and ins.date=:Date
PCDM.REQ.GETREMTRAITED.LCN=select STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,bmtr.pk_obj_idt AS bmtr_pk_obj_idt,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,substring(bmtr.CDECLT,11,11) AS bmtr_CDECLT,bmtr.MNT AS bmtr_MNTDECL,bmtr.NBCH+0 AS bmtr_NBCH,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,Format(sum(bmlcn.mnt),2) bmtr_MNTREEL FROM((((((((p_l_pcdma.te_lpcdma_cdlcn bmlcn JOIN p_l_pcdma.te_obj obj_bmlcn)JOIN p_l_pcdma.te_lpcdma_cdltr bmtr)JOIN p_l_pcdma.te_obj obj_bmtr)JOIN p_l_pcdma.te_lpcdma_cdlta bmta)JOIN p_l_pcdma.te_lpcdma_cdltn bmtn)JOIN p_l_pcdma.te_lpcdma_ins ins)JOIN r_multi_37.tr_banque bq)) WHERE((1 = 1) AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmlcn.INSTANCE)AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT + 1))AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)AND (bmlcn.ZBK = CONVERT( bq.CDE USING UTF8) and DATE=:Date ) and bmtr.OPE_ETA<>'D'and bmlcn.OPE_ETA<>'D') group by bmtr.nser;
PCDM.REQ.GETVALUETRAITED.LCN=select bmlcn.sign bmlcn_sign,bmtr.CDECLT AS bmtr_RIBRMT,bmtr.Nser AS bmtr_nser,Bmlcn.CODE_STATUS AS Bmlcn_CODE_STATUS,bmlcn.RECTO_US_GR as bmlcn_RECTO_US_GR,bmlcn.VERSO_DS_GR as bmlcn_VERSO_DS_GR,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,bmlcn.pk_obj_idt AS bmlcn_pk_obj_idt,bmlcn.cdeAval bmlcn_cdeAval,bmlcn.NOM_AVAL bmlcn_NOM_AVAL,bmlcn.cdeend bmlcn_cdeend,bmlcn.NOM_ENDOS bmlcn_cde_nom_endo,bmlcn.NOM_TIREUR bmlcn_cde_NOM_TIREUR,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,bmtr.MNT AS bmtr_MNTDECL,bmtr.CDECLT AS bmtr_CDECLT,bmtr.NBCH+0 AS bmtr_NBCH,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE_RMT AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,bmlcn.pk_obj_idt AS bmlcn_pk_obj_idt,bmlcn.OPE_ETA AS bmlcn_ope_eta,bmlcn.ADR_RMT AS bmlcn_ADR_RMT,bmlcn.ADR_TIR AS bmlcn_ADR_TIR,bmlcn.AGE AS bmlcn_AGE,bmlcn.CDEBPR AS bmlcn_CDEBPR,bmlcn.CDE_REJ AS bmlcn_CDE_REJ,bmlcn.CONF AS bmlcn_CONF,bmlcn.CPT AS  bmlcn_CPT,bmlcn.CPT2 AS bmlcn_CPT2,bmlcn.DBL AS bmlcn_DBLT,bmlcn.DTEMI AS bmlcn_DTEEMI,bmlcn.DTEEC AS bmlcn_DTEEC,bmlcn.DTECRE AS bmlcn_DTECRE,bmlcn.FLAG_REJET AS bmlcn_FLAG_REJET,bmlcn.FLAG_VAL AS bmlcn_FLAG_AVAL,bmlcn.LOC AS bmlcn_LOC,bmlcn.MEM2 AS bmlcn_MEM2,(bmlcn.MNT) AS bmlcn_MNT,bmlcn.NSER AS bmlcn_NSER,bmlcn.RIB AS bmlcn_RIB,bmlcn.RSOC_TIR AS bmlcn_RSOC_TIR,(bmlcn.SQCA+0) AS bmlcn_SQCA,bmlcn.ZBK AS bmlcn_ZBK,bmlcn.ZIB AS bmlcn_ZIB,bmlcn.Ano AS bmlcn_ANO,bmlcn.VICE AS bmlcn_VICE,bmlcn.AGE_RMT AS bmlcn_AGE_RMT FROM((((((((p_l_pcdma.te_lpcdma_cdlcn bmlcn JOIN p_l_pcdma.te_obj obj_bmlcn)JOIN p_l_pcdma.te_lpcdma_cdltr bmtr)JOIN p_l_pcdma.te_obj obj_bmtr)JOIN p_l_pcdma.te_lpcdma_cdlta bmta)JOIN p_l_pcdma.te_lpcdma_cdltn bmtn)JOIN p_l_pcdma.te_lpcdma_ins ins)JOIN r_multi_37.tr_banque bq)) WHERE((1 = 1)AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmlcn.INSTANCE)AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT+1))AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)AND (bmlcn.ZBK = CONVERT( bq.CDE USING UTF8)and bmtr.pk_obj_idt=:pk_obj_id_Rem) and ins.date=:Date);

PCDM.OUTDIR.SI.LCN=\\\\172.16.0.6\\Sorties\\L_PCDM\\SI\\
PCDM.PATTERN.ENTETE.SILCN=(^0100)([0-9]{6})([0-9]{8})([0-9]{6})([0-9]{16})
PCDM.PATTERN.RECORDREM.SILCN=(^02)([0-9]{3})([0-9]{11})(.{7})([0-9]{6})([0-9]{16})([0-9]{16})([0-9]{1})(.{15})
PCDM.PATTERN.RECORDLCN.SILCN=(^03)([0-9]{7})([0-9]{24})([0-9]{7})([0-9]{24})(.{35})(.{35})([0-9]{1})(.{35})([0-9]{16})([0-9]{8})([0-9]{8})([0-9]{1})(.{3})

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER LOT
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
### LOT CHQ

PCDM.REQ.GETRECORD.LOT.CHQ=SELECT bmch.DTEMI as bmch_dteEmi,ins.DATE AS DATETR,bmch.PK_OBJ_IDT as bmch_PK_OBJ_IDT ,bmtr.AGE_RMT AS bmtr_AGE_RMT,bmtr.CDEBPR as bmtr_CDE_BPR,bmtr.CDECLT as CPT_REM,"" as LOCR,bmtr.CDECLT CPTR,RSOC_BEN as RESOC_REM,bmtr.RefCli as REF_REM,concat( bmch.ZBK,bmch.LOC,bmch.cpt,bmch.rib) CPT_TIRE,bmch.RSOC_TIR as RSOC_TIRE,bmch.ADR_TIR as ADR_TIRE,bmch.nser as bmch_nser,bmch.MNT as bmch_mnt FROM p_c_pcdma.te_pcdma_cdch bmch,p_c_pcdma.te_pcdma_cdtr bmtr,p_c_pcdma.te_pcdma_ins ins,p_c_pcdma.te_obj obj_bmch WHERE (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1)) AND (ins.instance = bmch.instance)AND (ins.instance = bmtr.instance AND bmtr.FK_OPE_MNE='Valid' and  bmtr.OPE_ETA <> 'D' and bmch.OPE_ETA <> 'D' and  CONF='1' and bmch.zbk!=:zbk and ins.DATE=:Date) ;
PCDM.REQ.GETSUMRECORD.LOT.CHQ=SELECT count(*) AS NBRCHQ,FORMAT(SUM(MNT), 2) SumMnt FROM p_c_pcdma.te_pcdma_cdch ch,p_c_pcdma.te_pcdma_ins ins WHERE ch.ope_eta != 'D' and CONF='1' and ch.instance=ins.INSTANCE and ins.date=:Date and ch.zbk!=:zbk
PCDM.OUTDIR.LOT.CHQ=\\\\172.16.0.6\\Sorties\\PCDM\\CHQ\\ASIMTV3\\
PCDM.PATTERN.RECORDENTETELOT.CHQ=^(ELOT)([0-9]{3})([0-9]{3})([0-9]{3})(MAD)([0-9]{4})([0-9]{16})(.{28})
PCDM.PATTERN.RECORDLOT.CHQ=^([0-9]{3})([0-9]{12})([1-2]{1})([0-9]{24})(.{4})(.{35})(.{50})([1-2]{1})([0-9]{7})([0-9]{24})(.{4})(.{35})(.{50})([0-9]{15})([0-9]{8})([0-9]{1})([0-1]{1})(.{275})

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER ETA
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
### ETA CHQ
PCDM.FOLDER.ETA.CHQ=\\\\172.16.0.6\\Sorties\\PCDM\\CHQ\\ETA\\
PCDM.REQ.DATA.CHQ=SELECT bmch.pk_obj_idt AS bmch_pk_obj_idt,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,age_r.Lib age_r_lib,bmtn.OPE_ETA AS bmtn_OPE_ETA,bmtn.Ano AS bmtn_ANO,bmtn.CDEBPR AS bmtn_CDEBPR,bmtn.COUNT_CHQ AS bmtn_COUNT_CHQ,bmtn.DIFF AS bmtn_DIFF,bmtn.DIFF_NB AS bmtn_DIFF_NB,bmtn.LECTEUR AS bmtn_LECTEUR,bmtn.MEM2 AS bmtn_MEM2,bmtn.SUM_CHQ AS bmtn_SUM_CHQ,bmta.OPE_ETA AS bmta_OPE_ETA,bmta.Ano AS bmta_Ano,bmta.CDEBPR AS bmta_CDEBPR,bmta.MEM2 AS bmta_MEM2,bmta.SQCA AS bmta_SQCA,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,bmtr.MNT AS bmtr_MNT,bmtr.CDECLT AS bmtr_CDECLT,bmtr.NBCH+0 AS bmtr_NBCH,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE_RMT AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,bmtr.ANO AS bmtr_ANO,bmch.FK_OPE_MNE AS bmch_fk_ope_mne,bmch.INSTANCE AS bmch_instance,bmch.OPE_ETA AS bmch_ope_eta,bmch.ADR_RMT AS bmch_ADR_RMT,bmch.ADR_TIR AS bmch_ADR_TIR,bmch.AGE AS bmch_AGE,bmch.CDEBPR AS bmch_CDEBPR,bmch.CDE_REJ AS bmch_CDE_REJ,bmch.CPT AS  bmch_CPT,bmch.CPT2 AS bmch_CPT2,bmch.DBL AS bmch_DBLT,bmch.DTEMI AS bmch_DTEEMI,bmch.FLAG_IMP AS bmch_FLAG_IMP,bmch.FLAG_REJET AS bmch_FLAG_REJET,bmch.FLAG_VAL AS bmch_FLAG_AVAL,bmch.LOC AS bmch_LOC,bmch.MEM2 AS bmch_MEM2,(bmch.MNT+0) AS bmch_MNT,bmch.NSER AS bmch_NSER,bmch.RIB AS bmch_RIB,bmch.RIO AS bmch_RIO,bmch.RSOC_TIR AS bmch_RSOC_TIR,(bmch.SQCA+0) AS bmch_SQCA,bmch.ZBK AS bmch_ZBK,(select bq.lib from r_multi_4.tr_banque bq where bmch.ZBK = bq.CDE)  AS bq_lib,bmch.ZIB AS bmch_ZIB,bmch.Ano AS bmch_ANO,bmch.VICE AS bmch_VICE,bmch.CONF AS bmch_CONF,bmch.DTEINV AS bmch_DTEINV,bmch.AGE_RMT AS bmch_AGE_RMT FROM (((((((p_c_pcdma.te_pcdma_cdch bmch JOIN p_c_pcdma.te_obj obj_bmch)JOIN p_c_pcdma.te_pcdma_cdtr bmtr)JOIN p_c_pcdma.te_obj obj_bmtr)JOIN p_c_pcdma.te_pcdma_cdta bmta)JOIN p_c_pcdma.te_pcdma_cdtn bmtn)JOIN p_c_pcdma.te_pcdma_ins ins)JOIN r_multi_4.tr_agence_pcdm age_r) WHERE((1 = 1)AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmch.INSTANCE)AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)and (age_r.AGE  = bmtr.AGE)) And ins.date=
PCDM.REQ.COUNTDATA.CHQ=SELECT COUNT(*) countValues FROM p_c_pcdma.te_pcdma_cdch ch,p_c_pcdma.te_pcdma_ins ins WHERE ins.instance = ch.instance and date=:Date
PCDM.REQ.DATA.PCAPT=SELECT  sc.CDESCANNER, age.AGE, sc.TYPE, age.LIB FROM r_multi_4.tr_scanner_pcdm sc,r_multi_4.tr_agence_pcdm age where age.age=sc.age
PCDM.REQ.GETLBLANO.CHQ=SELECT tr_ano.ANO_LIB AS ANO_LIB  FROM r_multi_4.tr_ano where PK_ANO_MNE=:PK_ANO_MNE

### ETA LCN

PCDM.FOLDER.ETA.LCN=\\\\172.16.0.6\\Sorties\\PCDM\\CHQ\\ETA\\
PCDM.REQ.COUNTDATA.LCN=SELECT COUNT(*) countValues FROM p_l_pcdma.te_lpcdma_cdlcn l, p_l_pcdma.te_lpcdma_ins ins WHERE ins.instance= l.instance and date=:Date
PCDM.REQ.DATA.LCN=select bmlcn.pk_obj_idt AS bmlcn_pk_obj_idt,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,age_r.Lib age_r_lib,(select bq.lib from r_multi_4.tr_banque bq where bmlcn.ZBK = bq.CDE) AS bq_lib,bmtn.OPE_ETA AS bmtn_OPE_ETA,bmtn.Ano AS bmtn_ANO,bmtn.CDEBPR AS bmtn_CDEBPR,bmtn.COUNT_CHQ AS bmtn_COUNT_CHQ,bmtn.DIFF AS bmtn_DIFF,bmtn.DIFF_NB AS bmtn_DIFF_NB,bmtn.LECTEUR AS bmtn_LECTEUR,bmtn.MEM2 AS bmtn_MEM2,bmtn.SUM_CHQ AS bmtn_SUM_CHQ,bmta.OPE_ETA AS bmta_OPE_ETA,bmta.CDEBPR AS bmta_CDEBPR,bmta.MEM2 AS bmta_MEM2,bmta.SQCA AS bmta_SQCA,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,bmtr.MNT AS bmtr_MNT,bmtr.CDECLT AS bmtr_CDECLT,bmtr.NBCH+0 AS bmtr_NBCH ,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE_RMT AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,bmtr.ANO AS bmtr_ANO,bmlcn.FK_OPE_MNE AS bmlcn_fk_ope_mne,bmlcn.INSTANCE AS bmlcn_instance,bmlcn.OPE_ETA AS bmlcn_ope_eta,bmlcn.ADR_RMT AS bmlcn_ADR_RMT,bmlcn.ADR_TIR AS bmlcn_ADR_TIR,bmlcn.AGE AS bmlcn_AGE,bmlcn.CDEBPR AS bmlcn_CDEBPR,bmlcn.CDE_REJ AS bmlcn_CDE_REJ,bmlcn.CPT AS  bmlcn_CPT,bmlcn.CPT2 AS bmlcn_CPT2,bmlcn.DBL AS bmlcn_DBLT,bmlcn.DTEMI AS bmlcn_DTEEMI,bmlcn.FLAG_REJET AS bmlcn_FLAG_REJET,bmlcn.FLAG_VAL AS bmlcn_FLAG_AVAL,bmlcn.LOC AS bmlcn_LOC,bmlcn.MEM2 AS bmlcn_MEM2,(bmlcn.MNT+0) AS bmlcn_MNT,bmlcn.NSER AS bmlcn_NSER,bmlcn.RIB AS bmlcn_RIB,bmlcn.RSOC_TIR AS bmlcn_RSOC_TIR,(bmlcn.SQCA+0) AS bmlcn_SQCA,bmlcn.ZBK AS bmlcn_ZBK,bmlcn.ZIB AS bmlcn_ZIB,bmlcn.Ano AS bmlcn_ANO,bmlcn.CONF AS bmlcn_CONF,bmlcn.VICE AS bmlcn_VICE,bmlcn.AGE_RMT AS bmlcn_AGE_RMT FROM (((((((p_l_pcdma.te_lpcdma_cdlcn bmlcn JOIN p_l_pcdma.te_obj obj_bmlcn)JOIN p_l_pcdma.te_lpcdma_cdltr bmtr)JOIN p_l_pcdma.te_obj obj_bmtr)JOIN p_l_pcdma.te_lpcdma_cdlta bmta)JOIN p_l_pcdma.te_lpcdma_cdltn bmtn)JOIN p_l_pcdma.te_lpcdma_ins ins)JOIN r_multi_4.tr_agence_pcdm age_r) WHERE ((1 = 1) AND (ins.INSTANCE = bmtn.INSTANCE) AND (ins.INSTANCE = bmtr.INSTANCE) AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmlcn.INSTANCE) AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT + 1))     AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT) AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT) AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) and (age_r.AGE  = bmtr.AGE))  And ins.DATE=
PCDM.REQ.GETLBLANO.LCN=SELECT tr_ano.ANO_LIB AS ANO_LIB  FROM r_multi_4.tr_ano where PK_ANO_MNE=:PK_ANO_MNE

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER IMP
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
### IMP CHQ

PCDM.INDIR.CRO.CHQ=\\\\172.16.0.6\\Impayes\\PCDM\\CHQ\\IN\\
PCDM.PATTERN.CROFILE.CHQ=([0-9]{3})(.[0-9]{3})(.[0-9]{3})(.131)(.MAD)(.CRO).succes$
PCDM.PATTERN.RECORDCRO.CHQ=([0-9]{3})(MAD)(.{26})([0-9]{8})(131)(.{3})(.{12})([0-9]{3})(.{32})([0-1]{1})(.{46})$
PCDM.REQ.GETIMP.PROD.CHQ=SELECT bmch.PK_OBJ_IDT bmch_PK_OBJ_IDT,bmch.CPT as bmch_CPT ,bmch.LOC as bmch_LOC,bmch.ZBK as bmch_ZBK,(SELECT lib FROM  r_multi_4.tr_banque where bmch_ZBK=cde) ZBK_LIB,bmch.NSER AS bmch_nser,bmch.RIB AS bmch_rib,bmch.MNT AS bmch_MNT,bmtr.AGE AS bmtr_AGE,(SELECT lib FROM  r_multi_4.tr_agence_pcdm where bmtr_AGE=AGE) AGE_LIB,bmtr.CDECLT as bmtr_CPT,bmch.mem2 as bmtn_lecteur,bmch.rio as RIOINI,bmch.SQCA as bmch_SQCA,ins.DATE  as DTE_TRT ,bmch.DTE_SORT  as DTE_SORT  FROM ((((((p_c_pcdma.te_pcdma_cdch bmch JOIN p_c_pcdma.te_obj obj_bmch)JOIN p_c_pcdma.te_pcdma_cdtr bmtr)JOIN p_c_pcdma.te_obj obj_bmtr)JOIN p_c_pcdma.te_pcdma_ins ins)JOIN p_c_pcdma.te_pcdma_cdta bmta)JOIN p_c_pcdma.te_pcdma_cdtn bmtn) WHERE ((1 = 1) AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmch.INSTANCE)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) and FLAG_IMP='1' and bmch.rio=:RIOINI );

PCDM.INDIR.IFPCONF.CHQ=\\\\172.16.0.6\\Impayes\\PCDM\\
PCDM.PATTERN.IFPCONFFILE.CHQ=([0-9]{3})(.[0-9]{3})(.MAD)(.[0-9]{3})(.[0-9]{8}).(ifp|IFP)(.*)
PCDM.PATTERN.RECORDIFP.CONF.CHQ=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
PCDM.REQ.ADDIMP.CHQ=INSERT INTO r_ncrm_extraction.ta_imp_chq_pcdm(REF,PK_OBJ_IDT,RIO,RIOINI,REJET,ADR_RMT,ADR_TIR,ZBK,AGE_RMT,AGE_RMT_LIB,CPT,CPTT,DTEREG,LOCT,MEM2,MNT,NSER,SQCA,RIB,RSOC_RMT,RSOC_TIRE,ZBK_lib,NOMTIRE,CIN,RC,lieuEmission,MOTIF1,MOTIF2,MOTIF3,REJET_LIB,DTREJET,DTEINS,DTEPRE,DTEemission,DTETRT,DTE_SORT)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select lib from  editions.tr_rejets where REJET=? ),?,?,?,?,?,?);

PCDM.INDIR.IFPIA.CHQ=\\\\172.16.0.6\\Impayes\\PCDM\\CHQ\\IN\\364
PCDM.PATTERN.IFPIAFILE.CHQ=([0-9]{3})(.[0-9]{8})(.IA).(ifp|IFP)
PCDM.PATTERN.RECORDIFP.IA.CHQ=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})0([0-9]{7})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
PCDM.REQ.GETIMP.PROD.IA.CHQ=SELECT bmch.PK_OBJ_IDT bmch_PK_OBJ_IDT,bmch.CPT as bmch_CPT ,bmch.LOC as bmch_LOC,bmch.ZBK as bmch_ZBK,(SELECT lib FROM  r_multi_4.tr_banque where bmch_ZBK=cde) ZBK_LIB,bmch.NSER AS bmch_nser,bmch.RIB AS bmch_rib,bmch.MNT AS bmch_MNT,bmtr.AGE AS bmtr_AGE,(SELECT lib FROM  r_multi_4.tr_agence_pcdm where bmtr_AGE=AGE) AGE_LIB,bmtr.CDECLT as bmtr_CPT,bmch.mem2 as bmtn_lecteur,bmch.rio as RIOINI,bmch.SQCA as bmch_SQCA,ins.DATE  as DTE_TRT ,bmch.DTE_SORT  as DTE_SORT FROM ((((((p_c_pcdma.te_pcdma_cdch bmch JOIN p_c_pcdma.te_obj obj_bmch)JOIN p_c_pcdma.te_pcdma_cdtr bmtr)JOIN p_c_pcdma.te_obj obj_bmtr)JOIN p_c_pcdma.te_pcdma_ins ins) JOIN p_c_pcdma.te_pcdma_cdta bmta)JOIN p_c_pcdma.te_pcdma_cdtn bmtn) WHERE ((1 = 1) AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmch.INSTANCE)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) and FLAG_IMP='1' and bmch.zbk=:ZBKT and bmch.loc=:LOCT and bmch.cpt=:CPTT and bmch.rib=:RIBT and bmch.nser=:NSER and (ins.date=:DTETRT)) ;

PCDM.REQ.COUNT.IMP.CHQ=SELECT ZBK,ZBK_lib,DTETRT as DTE,count(*) as CountVal FROM r_ncrm_extraction.ta_imp_chq_pcdm  where nser is not null and DTETRT is not null group by zbk

PCDM.FOLDER.OUT.IMP.CHQ=\\\\172.17.0.10\\Depot\\TCNCRM\\Send\\PCDMEXT\\
PCDM.REQ.DATA.IMP.CHQ=SELECT ta_imp_chq_bpm.REF,ta_imp_chq_bpm.PK_OBJ_IDT,ta_imp_chq_bpm.RIO,ta_imp_chq_bpm.RIOINI,ta_imp_chq_bpm.REJET,ta_imp_chq_bpm.ADR_RMT,ta_imp_chq_bpm.ADR_TIR,ta_imp_chq_bpm.CDEBPR,ta_imp_chq_bpm.CDEBPR_RMT,ta_imp_chq_bpm.AGE,ta_imp_chq_bpm.AGE_RMT,ta_imp_chq_bpm.AGE_RMT_LIB,ta_imp_chq_bpm.CPT,ta_imp_chq_bpm.CPTT,ta_imp_chq_bpm.DTEMI,ta_imp_chq_bpm.DTEREG,ta_imp_chq_bpm.LOC,ta_imp_chq_bpm.LOCT,ta_imp_chq_bpm.MEM2,ta_imp_chq_bpm.MNT,ta_imp_chq_bpm.MODE_ESC,ta_imp_chq_bpm.NSER,ta_imp_chq_bpm.SQCA,ta_imp_chq_bpm.RIB,ta_imp_chq_bpm.RIBR,ta_imp_chq_bpm.RSOC_RMT,ta_imp_chq_bpm.RSOC_TIRE,ta_imp_chq_bpm.RSOC_BEN,ta_imp_chq_bpm.ZBK,ta_imp_chq_bpm.ZBK_lib,ta_imp_chq_bpm.NOMTIRE,ta_imp_chq_bpm.CIN,ta_imp_chq_bpm.RC,ta_imp_chq_bpm.lieuEmission,ta_imp_chq_bpm.MOTIF1,ta_imp_chq_bpm.MOTIF2,ta_imp_chq_bpm.MOTIF3,ta_imp_chq_bpm.adresseTire,ta_imp_chq_bpm.REJET_LIB,ta_imp_chq_bpm.DTREJET,ta_imp_chq_bpm.DTEINS,ta_imp_chq_bpm.DTEPRE,ta_imp_chq_bpm.DTEemission,ta_imp_chq_bpm.DTETRT FROM r_ncrm_extraction.ta_imp_chq_pcdm where ta_imp_chq_bpm.PK_OBJ_IDT is not null and DTETRT=


#===============================================================
# IMP LCN

#PCDM.INDIR.CRO.LCN=\\\\172.17.0.8\\Impayes\\PCDM\\LCN\\IN\\
#PCDM.PATTERN.CROFILE.LCN=([0-9]{3})(.[0-9]{3})(.[0-9]{3})(.160)(.MAD)(.CRO).succes$
#PCDM.PATTERN.RECORDCRO.LCN=([0-9]{3})(MAD)(.{26})([0-9]{8})([0-9]{3})(.{3})(.{12})([0-9]{3})(.{32})([0-9]{1})(.{46})$
#PCDM.REQ.GETIMP.PROD.LCN=SELECT PK_OBJ_IDT bmlcn_PK_OBJ_IDT,CPTT AS bmlcn_CPT,LOCT AS bmlcn_LOC,ZBKT AS bmlcn_ZBK,(SELECT lib FROM r_multi_37.tr_banque  WHERE bmlcn_ZBK = cde) ZBK_LIB,NSER AS bmlcn_nser,RIBT AS bmlcn_rib,MNT AS bmlcn_MNT,AGE AS bmtr_AGE,(SELECT  lib FROM r_multi_37.tr_agence_qmb  WHERE bmtr_AGE = AGE) AGE_LIB,CPT AS bmtr_CPT,MEM2 AS bmtn_lecteur,rio AS RIOINI,DTEINS AS DTE_TRT,DTE_SORT AS DTE_SORT,DTEPRE,DTEEC FROM p_s_qmb.te_s_qmb_qmslcn bmlcn WHERE((1 = 1) AND FLAG_IMP = '1' AND rio = :RIOINI);
#
#PCDM.INDIR.IFPCONF.LCN=\\\\172.17.0.8\\Impayes\\PCDM\\
#PCDM.PATTERN.IFPCONFFILE.LCN=([0-9]{3})(.[0-9]{3})(.MAD)(.[0-9]{3})(.[0-9]{8}).(ifp|IFP)(.MAILO)
#PCDM.PATTERN.RECORDIFP.CONF.LCN=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})(.{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
#
#PCDM.INDIR.IFPIA.LCN=\\\\172.17.0.8\\Impayes\\PCDM\\LCN\\IN\\360
#PCDM.PATTERN.IFPIAFILE.LCN=([0-9]{8})(\\.CNP\\.TXT).*
#PCDM.PATTERN.RECORDIFP.IA.LCN=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
#PCDM.REQ.GETIMP.PROD.IA.LCN=SELECT bmlcn.PK_OBJ_IDT bmlcn_PK_OBJ_IDT,bmlcn.CPTT as bmlcn_CPT ,bmlcn.LOCT as bmlcn_LOC,bmlcn.ZBKT as bmlcn_ZBK,(SELECT lib FROM r_multi_37.tr_banque where bmlcn_ZBK=cde) ZBK_LIB,bmlcn.NSER AS bmlcn_nser,bmlcn.RIBT AS bmlcn_rib,bmlcn.MNT AS bmlcn_MNT,bmlcn.AGE AS bmlcn_AGE,(SELECT lib FROM r_multi_37.tr_agence_qmb where bmlcn_AGE=AGE) AGE_LIB,bmlcn.CPT as bmlcn_CPT,bmlcn.MEM2 as bmlcn_lecteur,bmlcn.rio as RIOINI,bmlcn.DTEINS  as DTE_TRT ,bmlcn.DTE_SORT  as DTE_SORT FROM p_s_qmb.te_s_qmb_qmslcn bmlcn WHERE ((1 = 1)and FLAG_IMP='1' and bmlcn.zbk=:ZBKT and bmlcn.loc=:LOCT and bmlcn.cpt=:CPTT and bmlcn.rib=:RIBT and bmlcn.nser=:NSER and (bmlcn.DTE_SORT=:DTESORT  )
#PCDM.REQ.ADDIMP.LCN=INSERT INTO r_ncrm_extraction.ta_imp_lcn_qmb(REF,PK_OBJ_IDT,RIO,RIOINI,REJET,ADR_RMT,ADR_TIRE,ZBK,AGE_RMT,AGE_RMT_LIB,CPT,CPTT,LOCT,MEM2,MNT,NSER,RIBT,RSOC_RMT,RSOC_TIRE,ZBK_lib,NOMTIRE,CIN,RC,lieuEmission,MOTIF1,MOTIF2,MOTIF3,REJET_LIB,DTREJET,DTEINS,DTEPRE,DTEemission,DTE_SORT,DTEEC)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select lib from  editions.tr_rejets_lcn where REJET=? ),?,?,?,?,?,?);
#PCDM.REQ.COUNT.IMP.LCN=SELECT ZBK,ZBK_lib,DTEINS as DTE,count(*) as CountVal,DTEPRE dteSort FROM r_ncrm_extraction.ta_imp_lcn_qmb where nser is not null and DTEINS is not null group by zbk
#
#
#
#PCDM.FOLDER.OUT.IMP.LCN=\\\\172.17.0.10\\Depot\\TCNCRM\\Send\\PCDMEXT\\
#PCDM.REQ.DATA.IMP.LCN=SELECT ta_imp_lcn_qmb.REF,ta_imp_lcn_qmb.PK_OBJ_IDT,ta_imp_lcn_qmb.RIO,ta_imp_lcn_qmb.RIOINI,ta_imp_lcn_qmb.REJET,ta_imp_lcn_qmb.ADR_RMT,ta_imp_lcn_qmb.ADR_TIRE,ta_imp_lcn_qmb.CDEBPR,ta_imp_lcn_qmb.CDEBPR_RMT,ta_imp_lcn_qmb.AGE,ta_imp_lcn_qmb.AGE_RMT,ta_imp_lcn_qmb.AGE_RMT_LIB,ta_imp_lcn_qmb.CPT,ta_imp_lcn_qmb.CPTT,ta_imp_lcn_qmb.DTEEC,ta_imp_lcn_qmb.DTEMI,ta_imp_lcn_qmb.DTREG,ta_imp_lcn_qmb.LOC,ta_imp_lcn_qmb.LOCT,ta_imp_lcn_qmb.MEM2,ta_imp_lcn_qmb.MNT,ta_imp_lcn_qmb.MODE_ESC,ta_imp_lcn_qmb.NSER,ta_imp_lcn_qmb.RIB,ta_imp_lcn_qmb.RIBT,ta_imp_lcn_qmb.RSOC_RMT,ta_imp_lcn_qmb.RSOC_TIRE,ta_imp_lcn_qmb.RSOC_BEN,ta_imp_lcn_qmb.ZBK,ta_imp_lcn_qmb.ZBK_lib,ta_imp_lcn_qmb.NOMTIRE,ta_imp_lcn_qmb.CIN,ta_imp_lcn_qmb.RC,ta_imp_lcn_qmb.lieuEmission,ta_imp_lcn_qmb.MOTIF1,ta_imp_lcn_qmb.MOTIF2,ta_imp_lcn_qmb.MOTIF3,ta_imp_lcn_qmb.adresseTire,ta_imp_lcn_qmb.REJET_LIB,ta_imp_lcn_qmb.DTREJET,ta_imp_lcn_qmb.DTEINS,ta_imp_lcn_qmb.DTEPRE,ta_imp_lcn_qmb.DTEemission FROM r_ncrm_extraction.ta_imp_lcn_qmb where ta_imp_lcn_qmb.PK_OBJ_IDT is not null and DTEINS=















#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### GESTION AGENCES & COMPTES 
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~

### GESTION AGE
PCDM.REQ.GETALL.AGENCE=SELECT AGE,LIB,LOC,DTEINS FROM r_multi_4.tr_agence_pcdm age_r
### GESTION SCANNER 
PCDM.REQ.GETSCA.BY.AGE=select * from r_multi_4.tr_scanner_pcdm where AGE=:cdeAge







#######################################################################################################################################
				  # BTI #
#######################################################################################################################################
BTI.cde.bq=367
BTI.SOURCE.LOT=000
BTI.SERVER.ADD=\\\\172.17.0.8\\
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER SI
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
### SI CHQ
BTI.REQ.GETREM_TRAITED_FLAGER.SI.CHQ=SELECT ins.DATE AS DATETR,bmtr.PK_OBJ_IDT as bmtr_PK_OBJ_IDT,bmtr.SQCA  as bmtr_SEQREM,bmtr.AGE AS bmtr_AGE,bmtr.CDECLT as bmtr_CPTREM ,bmtr.NSER AS  bmtr_REFREM,bmtr.NBCH AS bmtr_NBRVALEUR,bmtr.MNT as bmtr_MNTDECLARER,bmtr.RefCli as bmtr_RefCli,Format(sum(bmch.MNT) ,2) AS bmtr_MNTCALCULER,bmtr.MODE_ESC AS bmtr_TYPEREM FROM p_c_btia.te_btia_cdch bmch,p_c_btia.te_btia_cdtr bmtr,p_c_btia.te_btia_ins ins,p_c_btia.te_obj obj_bmch WHERE (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (ins.instance = bmch.instance)AND (ins.instance = bmtr.instance)and  bmtr.OPE_ETA <> 'D' AND bmtr.FK_OPE_MNE='Valid' AND bmtr.EXT='1' group by bmtr.nser ;
BTI.REQ.GETREM_TRAITED_FLAGER_by_DTE.SI.CHQ=SELECT ins.DATE AS DATETR,bmtr.PK_OBJ_IDT as bmtr_PK_OBJ_IDT,bmtr.SQCA  as bmtr_SEQREM,bmtr.AGE AS bmtr_AGE,bmtr.CDECLT as bmtr_CPTREM ,bmtr.NSER AS  bmtr_REFREM,bmtr.NBCH AS bmtr_NBRVALEUR,bmtr.MNT as bmtr_MNTDECLARER,bmtr.RefCli as bmtr_RefCli,Format(sum(bmch.MNT) ,2) AS bmtr_MNTCALCULER,bmtr.MODE_ESC AS bmtr_TYPEREM FROM  p_c_btia.te_btia_cdch bmch,p_c_btia.te_btia_cdtr bmtr,p_c_btia.te_btia_ins ins,p_c_btia.te_obj obj_bmch WHERE (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (ins.instance = bmch.instance)AND (ins.instance = bmtr.instance)and  bmtr.OPE_ETA <> 'D' AND bmtr.FK_OPE_MNE='Valid' AND bmtr.EXT='1' and ins.date=:Date group by  bmtr.PK_OBJ_IDT ;


##### SI LCN

BTI.REQ.GETCOUNT.REM.LCN=select count(distinct (nser)) AS nbrRemise FROM p_l_btia.te_lbtia_cdltr tr,p_l_btia.te_lbtia_ins ins where tr.INSTANCE=ins.INSTANCE and tr.OPE_ETA<>'D' and ins.date=:Date
BTI.REQ.GETCOUNTANDSUMMNT.LCN= select count(*) AS NBRLCN, Format(sum(lcn.mnt),2) MNTLCN FROM  p_l_btia.te_lbtia_cdlcn lcn,p_l_btia.te_lbtia_ins ins where lcn.INSTANCE=ins.INSTANCE and lcn.OPE_ETA<>'D' and ins.date=:Date
BTI.REQ.GETREMTRAITED.LCN=select STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,bmtr.pk_obj_idt AS bmtr_pk_obj_idt,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,bmtr.CDECLT AS bmtr_CDECLT,bmtr.MNT AS bmtr_MNTDECL,bmtr.NBCH+0 AS bmtr_NBCH,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,Format(sum(bmlcn.mnt),2) bmtr_MNTREEL FROM((((((((p_l_btia.te_lbtia_cdlcn bmlcn JOIN p_l_btia.te_obj obj_bmlcn)JOIN p_l_btia.te_lbtia_cdltr bmtr)JOIN p_l_btia.te_obj obj_bmtr)JOIN p_l_btia.te_lbtia_cdlta bmta)JOIN p_l_btia.te_lbtia_cdltn bmtn)JOIN p_l_btia.te_lbtia_ins ins)JOIN r_multi_37.tr_banque bq)) WHERE((1 = 1) AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmlcn.INSTANCE)AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT + 1))AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)AND (bmlcn.ZBK = CONVERT( bq.CDE USING UTF8) and DATE=:Date ) and bmtr.OPE_ETA<>'D'and bmlcn.OPE_ETA<>'D') group by bmtr.nser;
BTI.REQ.GETVALUETRAITED.LCN=select bmlcn.sign bmlcn_sign,bmtr.CDECLT AS bmtr_RIBRMT,bmtr.Nser AS bmtr_nser,Bmlcn.CODE_STATUS AS Bmlcn_CODE_STATUS,bmlcn.RECTO_US_GR as bmlcn_RECTO_US_GR,bmlcn.VERSO_DS_GR as bmlcn_VERSO_DS_GR,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,bmlcn.pk_obj_idt AS bmlcn_pk_obj_idt,bmlcn.cdeAval bmlcn_cdeAval,bmlcn.NOM_AVAL bmlcn_NOM_AVAL,bmlcn.cdeend bmlcn_cdeend,bmlcn.NOM_ENDOS bmlcn_cde_nom_endo,bmlcn.NOM_TIREUR bmlcn_cde_NOM_TIREUR,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,bmtr.MNT AS bmtr_MNTDECL,bmtr.CDECLT AS bmtr_CDECLT,bmtr.NBCH+0 AS bmtr_NBCH,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE_RMT AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,bmlcn.pk_obj_idt AS bmlcn_pk_obj_idt,bmlcn.OPE_ETA AS bmlcn_ope_eta,bmlcn.ADR_RMT AS bmlcn_ADR_RMT,bmlcn.ADR_TIR AS bmlcn_ADR_TIR,bmlcn.AGE AS bmlcn_AGE,bmlcn.CDEBPR AS bmlcn_CDEBPR,bmlcn.CDE_REJ AS bmlcn_CDE_REJ,bmlcn.CONF AS bmlcn_CONF,bmlcn.CPT AS  bmlcn_CPT,bmlcn.CPT2 AS bmlcn_CPT2,bmlcn.DBL AS bmlcn_DBLT,bmlcn.DTEMI AS bmlcn_DTEEMI,bmlcn.DTEEC AS bmlcn_DTEEC,bmlcn.DTECRE AS bmlcn_DTECRE,bmlcn.FLAG_REJET AS bmlcn_FLAG_REJET,bmlcn.FLAG_VAL AS bmlcn_FLAG_AVAL,bmlcn.LOC AS bmlcn_LOC,bmlcn.MEM2 AS bmlcn_MEM2,(bmlcn.MNT) AS bmlcn_MNT,bmlcn.NSER AS bmlcn_NSER,bmlcn.RIB AS bmlcn_RIB,bmlcn.RSOC_TIR AS bmlcn_RSOC_TIR,(bmlcn.SQCA+0) AS bmlcn_SQCA,bmlcn.ZBK AS bmlcn_ZBK,bmlcn.ZIB AS bmlcn_ZIB,bmlcn.Ano AS bmlcn_ANO,bmlcn.VICE AS bmlcn_VICE,bmlcn.AGE_RMT AS bmlcn_AGE_RMT FROM((((((((p_l_btia.te_lbtia_cdlcn bmlcn JOIN p_l_btia.te_obj obj_bmlcn) JOIN p_l_btia.te_lbtia_cdltr bmtr) JOIN p_l_btia.te_obj obj_bmtr) JOIN p_l_btia.te_lbtia_cdlta bmta) JOIN p_l_btia.te_lbtia_cdltn bmtn) JOIN p_l_btia.te_lbtia_ins ins) JOIN r_multi_37.tr_banque bq)) WHERE((1 = 1)AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmlcn.INSTANCE)AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT+1))AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)AND (bmlcn.ZBK = CONVERT( bq.CDE USING UTF8)and bmtr.pk_obj_idt=:pk_obj_id_Rem) and ins.date=:Date);

BTI.OUTDIR.SI.LCN=\\\\172.17.0.8\\Sorties\\L_BTI\\SI\\
BTI.PATTERN.ENTETE.SILCN=(^0100)([0-9]{6})([0-9]{8})([0-9]{6})([0-9]{16})
BTI.PATTERN.RECORDREM.SILCN=(^02)([0-9]{3})([0-9]{24})(.{7})([0-9]{6})([0-9]{16})([0-9]{16})([0-9]{1})(.{15})
BTI.PATTERN.RECORDLCN.SILCN=(^03)([0-9]{7})([0-9]{24})([0-9]{7})([0-9]{24})(.{35})(.{35})([0-9]{1})(.{35})([0-9]{16})([0-9]{8})([0-9]{8})([0-9]{1})(.{3})

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER LOT
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#### LOT CHQ
BTI.REQ.GETRECORD.LOT.CHQ=SELECT bmch.DTEMI as bmch_dteEmi,ins.DATE AS DATETR,bmch.PK_OBJ_IDT as bmch_PK_OBJ_IDT ,bmtr.AGE_RMT AS bmtr_AGE_RMT,bmtr.CDEBPR as bmtr_CDE_BPR,bmtr.CDECLT as CPT_REM,"" as LOCR,bmtr.CDECLT CPTR,RSOC_BEN as RESOC_REM,bmtr.RefCli as REF_REM,concat( bmch.ZBK,bmch.LOC,bmch.cpt,bmch.rib) CPT_TIRE,bmch.RSOC_TIR as RSOC_TIRE,bmch.ADR_TIR as ADR_TIRE,bmch.nser as bmch_nser,bmch.MNT as bmch_mnt FROM p_c_btia.te_btia_cdch bmch,p_c_btia.te_btia_cdtr bmtr,p_c_btia.te_btia_ins ins,p_c_btia.te_obj obj_bmch WHERE (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1)) AND (ins.instance = bmch.instance)AND (ins.instance = bmtr.instance AND bmtr.FK_OPE_MNE='Valid' and  bmtr.OPE_ETA <> 'D' and bmch.OPE_ETA <> 'D' and  CONF='1' and bmch.zbk!=:zbk and ins.DATE=:Date) ;
BTI.REQ.GETSUMRECORD.LOT.CHQ=SELECT count(*) AS NBRCHQ,FORMAT(SUM(MNT), 2) SumMnt FROM p_c_btia.te_btia_cdch ch,p_c_btia.te_btia_ins ins WHERE ch.ope_eta != 'D' and CONF='1' and ch.instance=ins.INSTANCE and ins.date=:Date and ch.zbk!=:zbk
BTI.OUTDIR.LOT.CHQ=\\\\172.17.0.8\\Sorties\\BTI\\CHQ\\ASIMTV3\\
BTI.PATTERN.RECORDENTETELOT.CHQ=^(ELOT)([0-9]{3})([0-9]{3})([0-9]{3})(MAD)([0-9]{4})([0-9]{16})(.{28})
BTI.PATTERN.RECORDLOT.CHQ=^([0-9]{3})([0-9]{12})([1-2]{1})([0-9]{24})(.{4})(.{35})(.{50})([1-2]{1})([0-9]{7})([0-9]{24})(.{4})(.{35})(.{50})([0-9]{15})([0-9]{8})([0-9]{1})([0-1]{1})(.{275})


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER ETA
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#### ETA CHQ
#
BTI.FOLDER.ETA.CHQ=\\\\172.17.0.8\\Sorties\\BTI\\CHQ\\ETA\\
BTI.REQ.DATA.CHQ=SELECT bmch.pk_obj_idt AS bmch_pk_obj_idt,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,age_r.Lib age_r_lib,bmtn.OPE_ETA AS bmtn_OPE_ETA,bmtn.Ano AS bmtn_ANO,bmtn.CDEBPR AS bmtn_CDEBPR,bmtn.COUNT_CHQ AS bmtn_COUNT_CHQ,bmtn.DIFF AS bmtn_DIFF,bmtn.DIFF_NB AS bmtn_DIFF_NB,bmtn.LECTEUR AS bmtn_LECTEUR,bmtn.MEM2 AS bmtn_MEM2,bmtn.SUM_CHQ AS bmtn_SUM_CHQ,bmta.OPE_ETA AS bmta_OPE_ETA,bmta.Ano AS bmta_Ano,bmta.CDEBPR AS bmta_CDEBPR,bmta.MEM2 AS bmta_MEM2,bmta.SQCA AS bmta_SQCA,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,bmtr.MNT AS bmtr_MNT,bmtr.CDECLT AS bmtr_CDECLT,bmtr.NBCH+0 AS bmtr_NBCH,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,bmtr.ANO AS bmtr_ANO,bmch.FK_OPE_MNE AS bmch_fk_ope_mne,bmch.INSTANCE AS bmch_instance,bmch.OPE_ETA AS bmch_ope_eta,bmch.ADR_RMT AS bmch_ADR_RMT,bmch.ADR_TIR AS bmch_ADR_TIR,bmch.AGE AS bmch_AGE,bmch.CDEBPR AS bmch_CDEBPR,bmch.CDE_REJ AS bmch_CDE_REJ,bmch.CPT AS  bmch_CPT,bmch.CPT2 AS bmch_CPT2,bmch.DBL AS bmch_DBLT,bmch.DTEMI AS bmch_DTEEMI,bmch.FLAG_IMP AS bmch_FLAG_IMP,bmch.FLAG_REJET AS bmch_FLAG_REJET,bmch.FLAG_VAL AS bmch_FLAG_AVAL,bmch.LOC AS bmch_LOC,bmch.MEM2 AS bmch_MEM2,(bmch.MNT+0) AS bmch_MNT,bmch.NSER AS bmch_NSER,bmch.RIB AS bmch_RIB,bmch.RIO AS bmch_RIO,bmch.RSOC_TIR AS bmch_RSOC_TIR,(bmch.SQCA+0) AS bmch_SQCA,bmch.ZBK AS bmch_ZBK,(select bq.lib from r_multi_37.tr_banque bq where bmch.ZBK = bq.CDE)  AS bq_lib,bmch.ZIB AS bmch_ZIB,bmch.Ano AS bmch_ANO,bmch.VICE AS bmch_VICE,bmch.CONF AS bmch_CONF,bmch.DTEINV AS bmch_DTEINV,bmch.AGE_RMT AS bmch_AGE_RMT FROM (((((((p_c_btia.te_btia_cdch bmch JOIN p_c_btia.te_obj obj_bmch) JOIN p_c_btia.te_btia_cdtr bmtr) JOIN p_c_btia.te_obj obj_bmtr) JOIN p_c_btia.te_btia_cdta bmta) JOIN p_c_btia.te_btia_cdtn bmtn) JOIN p_c_btia.te_btia_ins ins) JOIN r_multi_37.tr_agence_bti age_r) WHERE((1 = 1)AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmch.INSTANCE)AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)and (age_r.AGE  = SUBSTR(bmch.mem2, 3, 4))) And ins.date=
BTI.REQ.COUNTDATA.CHQ=SELECT COUNT(*) countValues FROM  p_c_btia.te_btia_cdch ch,p_c_btia.te_btia_ins ins WHERE ins.instance = ch.instance and date=:Date
BTI.REQ.DATA.PCAPT=SELECT  sc.CDESCANNER, age.AGE, sc.TYPE, age.LIB FROM r_multi_37.tr_scanner_bti sc,r_multi_37.tr_agence_bti age where age.age=sc.age
BTI.REQ.GETLBLANO.CHQ=SELECT tr_ano.ANO_LIB AS ANO_LIB  FROM r_multi_37.tr_ano where PK_ANO_MNE=:PK_ANO_MNE

#### ETA LCN

BTI.FOLDER.ETA.LCN=\\\\172.17.0.8\\Sorties\\BTI\\LCN\\ETA\\
BTI.REQ.COUNTDATA.LCN=SELECT COUNT(*) countValues FROM  p_l_btia.te_lbtia_cdlcn l, p_l_btia.te_lbtia_ins ins WHERE ins.instance= l.instance and date=:Date
BTI.REQ.DATA.LCN=select bmlcn.pk_obj_idt AS bmlcn_pk_obj_idt,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,age_r.Lib age_r_lib,(select bq.lib from r_multi_37.tr_banque bq where bmlcn.ZBK = bq.CDE) AS bq_lib,bmtn.OPE_ETA AS bmtn_OPE_ETA,bmtn.Ano AS bmtn_ANO,bmtn.CDEBPR AS bmtn_CDEBPR,bmtn.COUNT_CHQ AS bmtn_COUNT_CHQ,bmtn.DIFF AS bmtn_DIFF,bmtn.DIFF_NB AS bmtn_DIFF_NB,bmtn.LECTEUR AS bmtn_LECTEUR,bmtn.MEM2 AS bmtn_MEM2,bmtn.SUM_CHQ AS bmtn_SUM_CHQ,bmta.OPE_ETA AS bmta_OPE_ETA,bmta.CDEBPR AS bmta_CDEBPR,bmta.MEM2 AS bmta_MEM2,bmta.SQCA AS bmta_SQCA,bmtr.NSER AS bmtr_NSER,bmtr.MEM2 AS bmtr_MEM2,bmtr.MNT AS bmtr_MNT,bmtr.CDECLT AS bmtr_CDECLT,bmtr.NBCH+0 AS bmtr_NBCH ,bmtr.MODE_ESC AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA+0 AS bmtr_SQCA,bmtr.AGE AS bmtr_AGE_RMT,bmtr.TIERS AS bmtr_TIERS,bmtr.REFCLI AS bmtr_REFCLI,bmtr.ANO AS bmtr_ANO,bmlcn.FK_OPE_MNE AS bmlcn_fk_ope_mne,bmlcn.INSTANCE AS bmlcn_instance,bmlcn.OPE_ETA AS bmlcn_ope_eta,bmlcn.ADR_RMT AS bmlcn_ADR_RMT,bmlcn.ADR_TIR AS bmlcn_ADR_TIR,bmlcn.AGE AS bmlcn_AGE,bmlcn.CDEBPR AS bmlcn_CDEBPR,bmlcn.CDE_REJ AS bmlcn_CDE_REJ,bmlcn.CPT AS  bmlcn_CPT,bmlcn.CPT2 AS bmlcn_CPT2,bmlcn.DBL AS bmlcn_DBLT,bmlcn.DTEMI AS bmlcn_DTEEMI,bmlcn.FLAG_REJET AS bmlcn_FLAG_REJET,bmlcn.FLAG_VAL AS bmlcn_FLAG_AVAL,bmlcn.LOC AS bmlcn_LOC,bmlcn.MEM2 AS bmlcn_MEM2,(bmlcn.MNT+0) AS bmlcn_MNT,bmlcn.NSER AS bmlcn_NSER,bmlcn.RIB AS bmlcn_RIB,bmlcn.RSOC_TIR AS bmlcn_RSOC_TIR,(bmlcn.SQCA+0) AS bmlcn_SQCA,bmlcn.ZBK AS bmlcn_ZBK,bmlcn.ZIB AS bmlcn_ZIB,bmlcn.Ano AS bmlcn_ANO,bmlcn.CONF AS bmlcn_CONF,bmlcn.VICE AS bmlcn_VICE,bmlcn.AGE_RMT AS bmlcn_AGE_RMT FROM (((((((p_l_btia.te_lbtia_cdlcn bmlcn JOIN p_l_btia.te_obj obj_bmlcn) JOIN p_l_btia.te_lbtia_cdltr bmtr) JOIN p_l_btia.te_obj obj_bmtr) JOIN p_l_btia.te_lbtia_cdlta bmta) JOIN p_l_btia.te_lbtia_cdltn bmtn) JOIN p_l_btia.te_lbtia_ins ins) JOIN r_multi_37.tr_agence_bti age_r) WHERE ((1 = 1) AND (ins.INSTANCE = bmtn.INSTANCE) AND (ins.INSTANCE = bmtr.INSTANCE) AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmlcn.INSTANCE) AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT) AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT + 1))     AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT) AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT) AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) and (age_r.AGE  = SUBSTR(bmlcn.mem2, 3, 4)))  And ins.DATE=
BTI.REQ.GETLBLANO.LCN=SELECT tr_ano.ANO_LIB AS ANO_LIB  FROM r_multi_37.tr_ano where PK_ANO_MNE=:PK_ANO_MNE

BTI.REQ.DATA.STKLCN=SELECT  PK_OBJ_IDT,ADR_BEN,ADR_RMT,ADR_TIRE,CDEAVAL,CDEBPR,CDEPRE,CPT,CPTT,DTEEC,DTEINS,DTEMI,LOC,LOCT,MNT,NSER,RIB,RIBT,RSOC_BEN,RSOC_RMT,RSOC_TIRE,ZBK,ZBKT,ZIB,ZIBT,DTEPRE,DTEEXT,DTREG,FLAG_IMP,RIO,MODE_ESC,AGE_RMT,SQCA,AGE_RMT_LIB,CDEBPR_RMT,FLAGEXT,MEm2 FROM p_s_bti.te_s_bti_cdslcn WHERE 1=1 AND ope_eta != 'D' AND CONF = '1' AND DTEPRE is not null  AND (DTEEXT  is null or DTEEXT=DATE_FORMAT(current_date(), "%Y-%m-%d"))
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER IMP
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#### IMP CHQ

BTI.INDIR.CRO.CHQ=\\\\172.16.0.6\\Impayes\\BTI\\CHQ\\IN\\
BTI.PATTERN.CROFILE.CHQ=([0-9]{3})(.[0-9]{3})(.[0-9]{3})(.131)(.MAD)(.CRO).succes$
BTI.PATTERN.RECORDCRO.CHQ=([0-9]{3})(MAD)(.{26})([0-9]{8})(131)(.{3})(.{12})([0-9]{3})(.{32})([0-1]{1})(.{46})$
BTI.REQ.GETIMP.PROD.CHQ=SELECT bmch.PK_OBJ_IDT bmch_PK_OBJ_IDT,bmch.CPT as bmch_CPT ,bmch.LOC as bmch_LOC,bmch.ZBK as bmch_ZBK,(SELECT lib FROM  r_multi_37.tr_banque where bmch_ZBK=cde) ZBK_LIB,bmch.NSER AS bmch_nser,bmch.RIB AS bmch_rib,bmch.MNT AS bmch_MNT,bmtr.AGE AS bmtr_AGE,(SELECT lib FROM  r_multi_37.tr_agence_bti where bmtr_AGE=AGE) AGE_LIB,bmtr.CDECLT as bmtr_CPT,bmch.mem2 as bmtn_lecteur,bmch.rio as RIOINI,bmch.SQCA as bmch_SQCA,ins.DATE  as DTE_TRT ,bmch.DTE_SORT  as DTE_SORT  FROM ((((((p_c_btia.te_btia_cdch bmch JOIN p_c_btia.te_obj obj_bmch) JOIN p_c_btia.te_btia_cdtr bmtr) JOIN p_c_btia.te_obj obj_bmtr)  JOIN p_c_btia.te_btia_ins ins) JOIN p_c_btia.te_btia_cdta bmta) JOIN p_c_btia.te_btia_cdtn bmtn) WHERE ((1 = 1) AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmch.INSTANCE)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) and FLAG_IMP='1' and bmch.rio=:RIOINI );

BTI.INDIR.IFPCONF.CHQ=\\\\172.16.0.6\\Impayes\\BTI\\
BTI.PATTERN.IFPCONFFILE.CHQ=([0-9]{3})(.[0-9]{3})(.MAD)(.[0-9]{3})(.[0-9]{8}).(ifp|IFP)(.*)
BTI.PATTERN.RECORDIFP.CONF.CHQ=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
BTI.REQ.ADDIMP.CHQ=INSERT INTO r_ncrm_extraction.ta_imp_chq_bti(REF,PK_OBJ_IDT,RIO,RIOINI,REJET,ADR_RMT,ADR_TIR,ZBK,AGE_RMT,AGE_RMT_LIB,CPT,CPTT,DTEREG,LOCT,MEM2,MNT,NSER,SQCA,RIB,RSOC_RMT,RSOC_TIRE,ZBK_lib,NOMTIRE,CIN,RC,lieuEmission,MOTIF1,MOTIF2,MOTIF3,REJET_LIB,DTREJET,DTEINS,DTEPRE,DTEemission,DTETRT,DTE_SORT)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select lib from  editions.tr_rejets where REJET=? ),?,?,?,?,?,?);

BTI.INDIR.IFPIA.CHQ=\\\\172.16.0.6\\Impayes\\BTI\\CHQ\\IN\\367
BTI.PATTERN.IFPIAFILE.CHQ=([0-9]{3})(.[0-9]{8})(.IA).(ifp|IFP)
BTI.PATTERN.RECORDIFP.IA.CHQ=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})0([0-9]{7})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
BTI.REQ.GETIMP.PROD.IA.CHQ=SELECT bmch.PK_OBJ_IDT bmch_PK_OBJ_IDT,bmch.CPT as bmch_CPT ,bmch.LOC as bmch_LOC,bmch.ZBK as bmch_ZBK,(SELECT lib FROM  r_multi_37.tr_banque where bmch_ZBK=cde) ZBK_LIB,bmch.NSER AS bmch_nser,bmch.RIB AS bmch_rib,bmch.MNT AS bmch_MNT,bmtr.AGE AS bmtr_AGE,(SELECT lib FROM  r_multi_37.tr_agence_bti where bmtr_AGE=AGE) AGE_LIB,bmtr.CDECLT as bmtr_CPT,bmch.mem2 as bmtn_lecteur,bmch.rio as RIOINI,bmch.SQCA as bmch_SQCA,ins.DATE  as DTE_TRT ,bmch.DTE_SORT  as DTE_SORT FROM ((((((p_c_btia.te_btia_cdch bmch JOIN p_c_btia.te_obj obj_bmch) JOIN p_c_btia.te_btia_cdtr bmtr) JOIN p_c_btia.te_obj obj_bmtr)  JOIN p_c_btia.te_btia_ins ins) JOIN p_c_btia.te_btia_cdta bmta) JOIN p_c_btia.te_btia_cdtn bmtn) WHERE ((1 = 1) AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmch.INSTANCE)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) and FLAG_IMP='1' and bmch.zbk=:ZBKT and bmch.loc=:LOCT and bmch.cpt=:CPTT and bmch.rib=:RIBT and bmch.nser=:NSER and (ins.date=:DTETRT)) ;

BTI.REQ.COUNT.IMP.CHQ=SELECT ZBK,ZBK_lib,DTETRT as DTE,count(*) as CountVal FROM r_ncrm_extraction.ta_imp_chq_bti  where nser is not null and DTETRT is not null group by zbk

BTI.FOLDER.OUT.IMP.CHQ=\\\\172.17.0.10\\Depot\\TCNCRM\\Send\\BTIEXT\\
BTI.REQ.DATA.IMP.CHQ=SELECT ta_imp_chq_bpm.REF,ta_imp_chq_bpm.PK_OBJ_IDT,ta_imp_chq_bpm.RIO,ta_imp_chq_bpm.RIOINI,ta_imp_chq_bpm.REJET,ta_imp_chq_bpm.ADR_RMT,ta_imp_chq_bpm.ADR_TIR,ta_imp_chq_bpm.CDEBPR,ta_imp_chq_bpm.CDEBPR_RMT,ta_imp_chq_bpm.AGE,ta_imp_chq_bpm.AGE_RMT,ta_imp_chq_bpm.AGE_RMT_LIB,ta_imp_chq_bpm.CPT,ta_imp_chq_bpm.CPTT,ta_imp_chq_bpm.DTEMI,ta_imp_chq_bpm.DTEREG,ta_imp_chq_bpm.LOC,ta_imp_chq_bpm.LOCT,ta_imp_chq_bpm.MEM2,ta_imp_chq_bpm.MNT,ta_imp_chq_bpm.MODE_ESC,ta_imp_chq_bpm.NSER,ta_imp_chq_bpm.SQCA,ta_imp_chq_bpm.RIB,ta_imp_chq_bpm.RIBR,ta_imp_chq_bpm.RSOC_RMT,ta_imp_chq_bpm.RSOC_TIRE,ta_imp_chq_bpm.RSOC_BEN,ta_imp_chq_bpm.ZBK,ta_imp_chq_bpm.ZBK_lib,ta_imp_chq_bpm.NOMTIRE,ta_imp_chq_bpm.CIN,ta_imp_chq_bpm.RC,ta_imp_chq_bpm.lieuEmission,ta_imp_chq_bpm.MOTIF1,ta_imp_chq_bpm.MOTIF2,ta_imp_chq_bpm.MOTIF3,ta_imp_chq_bpm.adresseTire,ta_imp_chq_bpm.REJET_LIB,ta_imp_chq_bpm.DTREJET,ta_imp_chq_bpm.DTEINS,ta_imp_chq_bpm.DTEPRE,ta_imp_chq_bpm.DTEemission,ta_imp_chq_bpm.DTETRT FROM r_ncrm_extraction.ta_imp_chq_bti where ta_imp_chq_bpm.PK_OBJ_IDT is not null and DTETRT=


#### IMP LCN 

BTI.INDIR.CRO.LCN=\\\\172.17.0.8\\Impayes\\BTI\\LCN\\IN\\
BTI.PATTERN.CROFILE.LCN=([0-9]{3})(.[0-9]{3})(.[0-9]{3})(.160)(.MAD)(.CRO).succes$
BTI.PATTERN.RECORDCRO.LCN=([0-9]{3})(MAD)(.{26})([0-9]{8})([0-9]{3})(.{3})(.{12})([0-9]{3})(.{32})([0-9]{1})(.{46})$
BTI.REQ.GETIMP.PROD.LCN=SELECT PK_OBJ_IDT bmlcn_PK_OBJ_IDT,CPTT AS bmlcn_CPT,LOCT AS bmlcn_LOC,ZBKT AS bmlcn_ZBK,(SELECT lib FROM r_multi_37.tr_banque  WHERE bmlcn_ZBK = cde) ZBK_LIB,NSER AS bmlcn_nser,RIBT AS bmlcn_rib,MNT AS bmlcn_MNT,AGE AS bmtr_AGE,(SELECT  lib FROM r_multi_37.tr_agence_qmb  WHERE bmtr_AGE = AGE) AGE_LIB,CPT AS bmtr_CPT,MEM2 AS bmtn_lecteur,rio AS RIOINI,DTEINS AS DTE_TRT,'' AS DTE_SORT,'' DTEPRE,DTEEC FROM p_s_bti.te_s_bti_cdslcn bmlcn WHERE((1 = 1) AND FLAG_IMP = '1' AND rio = :RIOINI);

BTI.INDIR.IFPCONF.LCN=\\\\172.17.0.8\\Impayes\\BTI\\
BTI.PATTERN.IFPCONFFILE.LCN=([0-9]{3})(.[0-9]{3})(.MAD)(.[0-9]{3})(.[0-9]{8}).(ifp|IFP)(.MAILO)
BTI.PATTERN.RECORDIFP.CONF.LCN=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})(.{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})

BTI.INDIR.IFPIA.LCN=\\\\172.17.0.8\\Impayes\\BTI\\LCN\\IN\\367
BTI.PATTERN.IFPIAFILE.LCN=([0-9]{8})(\\.CNP\\.TXT).*
BTI.PATTERN.RECORDIFP.IA.LCN=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
BTI.REQ.GETIMP.PROD.IA.LCN=SELECT bmlcn.PK_OBJ_IDT bmlcn_PK_OBJ_IDT,bmlcn.CPTT as bmlcn_CPT ,bmlcn.LOCT as bmlcn_LOC,bmlcn.ZBKT as bmlcn_ZBK,(SELECT lib FROM r_multi_37.tr_banque where bmlcn_ZBK=cde) ZBK_LIB,bmlcn.NSER AS bmlcn_nser,bmlcn.RIBT AS bmlcn_rib,bmlcn.MNT AS bmlcn_MNT,bmlcn.AGE AS bmlcn_AGE,(SELECT lib FROM  r_multi_37.tr_agence_bti where bmlcn_AGE=AGE) AGE_LIB,bmlcn.CPT as bmlcn_CPT,bmlcn.MEM2 as bmlcn_lecteur,bmlcn.rio as RIOINI,bmlcn.DTEINS  as DTE_TRT ,'bmlcn.DTE_SORT'  as DTE_SORT FROM p_s_bti.te_s_bti_cdslcn  bmlcn WHERE ((1 = 1)and FLAG_IMP='1' and bmlcn.zbk=:ZBKT and bmlcn.loc=:LOCT and bmlcn.cpt=:CPTT and bmlcn.rib=:RIBT and bmlcn.nser=:NSER 
BTI.REQ.ADDIMP.LCN=INSERT INTO r_ncrm_extraction.ta_imp_lcn_bti(REF,PK_OBJ_IDT,RIO,RIOINI,REJET,ADR_RMT,ADR_TIRE,ZBK,AGE_RMT,AGE_RMT_LIB,CPT,CPTT,LOCT,MEM2,MNT,NSER,RIBT,RSOC_RMT,RSOC_TIRE,ZBK_lib,NOMTIRE,CIN,RC,lieuEmission,MOTIF1,MOTIF2,MOTIF3,REJET_LIB,DTREJET,DTEINS,DTEPRE,DTEemission,DTE_SORT,DTEEC)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select lib from  editions.tr_rejets_lcn where REJET=? ),?,?,?,?,?,?);
BTI.REQ.COUNT.IMP.LCN=SELECT ZBK,ZBK_lib,DTEINS as DTE,count(*) as CountVal,DTEPRE dteSort FROM r_ncrm_extraction.ta_imp_lcn_bti where nser is not null and DTEINS is not null group by zbk



BTI.FOLDER.OUT.IMP.LCN=\\\\172.17.0.10\\Depot\\TCNCRM\\Send\\BTIEXT\\
BTI.REQ.DATA.IMP.LCN=SELECT ta_imp_lcn_qmb.REF,ta_imp_lcn_qmb.PK_OBJ_IDT,ta_imp_lcn_qmb.RIO,ta_imp_lcn_qmb.RIOINI,ta_imp_lcn_qmb.REJET,ta_imp_lcn_qmb.ADR_RMT,ta_imp_lcn_qmb.ADR_TIRE,ta_imp_lcn_qmb.CDEBPR,ta_imp_lcn_qmb.CDEBPR_RMT,ta_imp_lcn_qmb.AGE,ta_imp_lcn_qmb.AGE_RMT,ta_imp_lcn_qmb.AGE_RMT_LIB,ta_imp_lcn_qmb.CPT,ta_imp_lcn_qmb.CPTT,ta_imp_lcn_qmb.DTEEC,ta_imp_lcn_qmb.DTEMI,ta_imp_lcn_qmb.DTREG,ta_imp_lcn_qmb.LOC,ta_imp_lcn_qmb.LOCT,ta_imp_lcn_qmb.MEM2,ta_imp_lcn_qmb.MNT,ta_imp_lcn_qmb.MODE_ESC,ta_imp_lcn_qmb.NSER,ta_imp_lcn_qmb.RIB,ta_imp_lcn_qmb.RIBT,ta_imp_lcn_qmb.RSOC_RMT,ta_imp_lcn_qmb.RSOC_TIRE,ta_imp_lcn_qmb.RSOC_BEN,ta_imp_lcn_qmb.ZBK,ta_imp_lcn_qmb.ZBK_lib,ta_imp_lcn_qmb.NOMTIRE,ta_imp_lcn_qmb.CIN,ta_imp_lcn_qmb.RC,ta_imp_lcn_qmb.lieuEmission,ta_imp_lcn_qmb.MOTIF1,ta_imp_lcn_qmb.MOTIF2,ta_imp_lcn_qmb.MOTIF3,ta_imp_lcn_qmb.adresseTire,ta_imp_lcn_qmb.REJET_LIB,ta_imp_lcn_qmb.DTREJET,ta_imp_lcn_qmb.DTEINS,ta_imp_lcn_qmb.DTEPRE,ta_imp_lcn_qmb.DTEemission FROM r_ncrm_extraction.ta_imp_lcn_bti where ta_imp_lcn_qmb.PK_OBJ_IDT is not null and DTEINS=







#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### GESTION AGENCES & COMPTES 
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~

### GESTION AGE
BTI.REQ.GETALL.AGENCE=SELECT AGE,LIB,LOC,DTEINS FROM r_multi_37.tr_agence_bti age_r
#### GESTION SCANNER 
BTI.REQ.GETSCA.BY.AGE=select * from r_multi_37.tr_scanner_bti where AGE=:cdeAge
BTI.REQ.ADDSCA.TOAGE=INSERT INTO r_multi_37.tr_scanner_bti(CDESCANNER,AGE,TYPE) VALUES (?,?,?)




#######################################################################################################################################
				  # SGDA #
#######################################################################################################################################
SGDA.cde.bq=363

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER ETA
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
### ETA CHQ

SGDA.FOLDER.ETA.CHQ=\\\\172.17.0.150\\Sorties\\SGMA\\NCRM_EXTRACTIONS\\CSVETA

SGDA.REQ.COUNTDATA.CHQ=SELECT COUNT(*) countValues FROM p_c_sgdaa.te_sgdaa_sch ch,p_c_sgdaa.te_sgdaa_ins ins WHERE ins.instance = ch.instance and date=:Date
SGDA.REQ.DATA.CHQ=SELECT  "" bMCH_LIB_REJET_DELTA,bmch.PK_OBJ_IDT AS pk_obj_idt_Chq,bmch.sign as bmch_sign,bmch.CPT AS BMCH_CPT,bmch.DTEMI AS DTEMI,bmch.LOC AS BMCH_LOC,bmch.ZBK AS BMCH_ZBK,bmch.zib BMCH_ZIB,(select bq.lib from r_multi_37.tr_banque bq where bmch.ZBK=bq.cde) as Bmch_ZBK_lib,bmch.NSER AS BMCH_NSER,bmch.RIB AS BMCH_RIB,bmch.CONF AS BMCH_CONF,CODE_ERREURS AS BMCH_CODE_ERREURS,bmch.OPE_ETA AS BMCH_ope_eta,bmch.Ano AS BMCH_ANO,(bmch.MNT + 0) AS BMCH_MNT,bmch.FLAG_IMP AS BMCH_FLAG_IMP,bmch.FLAG_REJET AS BMCH_FLAG_REJET,bmch.FLAG_SCAN_GR as BMCH_FLAG_SCAN_GR,bmch.SQCA AS bmch_SQCA,bmch.ID_WEBCAPTUR bmch_ID_WEBCAPTUR,bmch.AGE_SCAN bmch_AGE_SCAN,'' as BMCH_REJET_DELTA,bmch.Rio as BMCH_RIO,bmtr.AGE AS BMTR_age,(select a.lib from  r_multi_37.tr_agence_sgda a where a.age=bmtr.AGE ) AS ageTr_lib,bmtr.PK_OBJ_IDT pk_obj_idt_rem,bmtr.OPE_ETA AS BMTR_ope_eta,bmtr.Ano AS BMTR_Ano,bmtr.FLAG_REJET AS BMTR_Flag_Rejet,bmtr.MODE AS BMTR_mode,(bmtr.MNT + 0) AS BMTR_MNT,bmtr.CPT AS BMTR_CPT,bmtr.RIB AS BMTR_RIB,bmtr.LOC AS BMTR_loc,bmtr.ZBK AS BMTR_zbk,bmtr.NSER AS BMTR_NSER,bmtr.NBCH AS BMTR_NBCH,bmtr.ID_WEBCAPTUR bmtr_ID_WEBCAPTUR,bmtr.AGE_SCAN bmtr_AGE_SCAN,bmtr.SECTEUR bmtr_SECTEUR,bmta.OPE_ETA AS BMTa_ope_eta,bmta.Ano AS BMTa_Ano,bmta.FLAG_REJET AS BMTa_Flag_Rejet,bmta.MODE AS BMTa_mode,(bmta.MNTR + 0) AS BMTa_MNTR,(bmta.SUM_REM + 0) AS BMTA_MNTREM,bmta.DIFF AS BMTA_MNT_DIFF,bmta.DIFF_NB AS BMTA_DIFF_NB,bmta.NSER AS BMTA_NSER_TA,bmta.CPT AS BMTA_CPT,bmta.NSER AS BMTA_NSER,bmta.COUNT_REM AS BMTA_COUNT_REM,bmta.AGE AS BMTA_age,bmtn.Ano AS BMTN_Ano,bmtn.OPE_ETA AS BMTN_ope_eta,bmtn.DIFF AS BMTN_DIFF,bmtn.DIFF_NB AS BMTN_DIFF_NB,bmtn.SUM_CHQ AS BMTN_sum_chq,bmtn.LECTEUR AS BMTN_lecteur,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE FROM ((((((p_c_sgdaa.te_sgdaa_sch bmch JOIN p_c_sgdaa.te_obj obj_bmch)JOIN p_c_sgdaa.te_sgdaa_str bmtr)JOIN p_c_sgdaa.te_obj obj_bmtr)JOIN p_c_sgdaa.te_sgdaa_ins ins)JOIN p_c_sgdaa.te_sgdaa_sta bmta)JOIN p_c_sgdaa.te_sgdaa_stn bmtn)  WHERE ((1 = 1) AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE) AND (ins.INSTANCE = bmtr.INSTANCE) AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmch.INSTANCE) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1)) AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT) AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT) AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) ) and date=
SGDA.REQ.GETLBLANO.CHQ=SELECT tr_ano.ANO_LIB AS ANO_LIB  FROM r_multi_37.tr_ano  where PK_ANO_MNE=:PK_ANO_MNE
SGDA.DELETE.TABLE.ETA.CHQ=delete from r_ncrm_extraction.tmp_tbl_eta_chq_sgda
#SGDA.OUT.REC=G\:\\sorties\\SGMA\\editions
#SGDA.REQ.DATA.REM.REC.CHQ=SELECT pk_obj_idt_rem pkObjIdtRem,bmtr_ID_WEBCAPTUR idWebCapture ,BMTN_lecteur cdePcapt,BMTR_NSER nser,BMTR_age cdeAge,BMTR_CPT ribRemettant,BMTR_MNT mnt,BMTR_mode typeRemise,BMTR_ope_eta opeEta,BMTR_Ano cdeAnomalie FROM  r_ncrm_extraction.tmp_tbl_eta_chq_sgma where 1=1 and date=:date  group by pk_obj_idt_rem ;
#SGDA.REQ.DATA.REC.CHQ=SELECT pk_obj_idt_Chq pkObjIdt,bmch_ID_WEBCAPTUR idWebCapture,BMTN_lecteur cdePcapt,BMch_NSER nser,concat(bmch_zbk,bmch_loc,BMch_CPT,bmch_rib) ribTire,BMch_MNT mnt,BMch_sign signature,SUBSTRING(BMCH_CODE_ERREURS,1,4) conf,BMCH_ope_eta opeEta,BMCH_Ano cdeAnomalie,"" dteEchee,bmch_rio rio FROM r_ncrm_extraction.tmp_tbl_eta_chq_sgma where 1=1 and date=:date and pk_obj_idt_rem=:pkobjidRem
#SGMA.REQ.DATA.REM.REC.CHQ=SELECT pk_obj_idt_rem pkObjIdtRem,bmtr_ID_WEBCAPTUR idWebCaptureRem,BMTN_lecteur cdePcaptRem,BMTR_NSER nserRem,BMTR_age cdeAge,BMTR_CPT ribRemettant,BMTR_MNT mntRem,BMTR_mode typeRemise,BMTR_ope_eta opeEtaRem,BMTR_Ano cdeAnomalieRem,pk_obj_idt_Chq pkObjIdt,bmch_ID_WEBCAPTUR idWebCapture,BMTN_lecteur cdePcapt,BMch_NSER nser,CONCAT(bmch_zbk, bmch_loc, BMch_CPT, bmch_rib) ribTire,BMch_MNT mnt,BMch_sign signature,SUBSTRING(BMCH_CODE_ERREURS, 1, 4) conf,BMCH_ope_eta opeEta,BMCH_Ano cdeAnomalie,'' dteEchee, bmch_rio rio FROM r_ncrm_extraction.tmp_tbl_eta_chq_sgma	where 1=1 and date=:date 

SGDA.REQ.ADD.AGE=INSERT INTO r_multi_37.tr_agence_sgda(AGE,LIB,LOC) VALUES (?,?,?);
SGDA.REQ.DEL.AGE=delete from r_multi_37.tr_agence_sgda where age=?;
SGDA.REQ.ALL.PCAPT=SELECT idPcapt as  idpcapt, cdePcapt cdePcapt , Lib as nomPcapt, type as Type, active, cdeAge as ageRattachement,secteur,circuit FROM r_ncrm_extraction.te_pcapt where  cdebq="363"
SGDA.REQ.PCAPT.CDE=SELECT idPcapt as  idpcapt, cdePcapt cdePcapt , Lib as nomPcapt, type as Type, active, cdeAge as ageRattachement,secteur, circuit FROM r_ncrm_extraction.te_pcapt where cdePcapt in (:cde) and cdebq="363"
SGDA.REQ.TRT.CHQ=SELECT idT,nom_Traitement, Description, DossierEnre,Destinataire,active FROM r_ncrm_extraction.te_traitement where idt in(12,13) and active=1 ;
SGDA.REQ.ADD.NEW.PCAPT=INSERT INTO r_ncrm_extraction.te_pcapt(cdePcapt,Lib,type,active,cdeAge,secteur,circuit,cdeBq)VALUES(?,?,?,1,?,?,?,'363');
SGDA.REQ.UPDATE.PCAPT=Update r_ncrm_extraction.te_pcapt set cdePcapt=?,Lib=?,type=?,cdeAge=?,secteur=?,circuit=? where idpcapt=? and cdeBq='363'
SGDA.REQ.DELETE.PCAPT=delete from r_ncrm_extraction.te_pcapt where idpcapt=?  and cdeBq='363'
#SGDA.REQ.TRT.LCN=SELECT idT,nom_Traitement, Description, DossierEnre,Destinataire,active FROM r_ncrm_extraction.te_traitement_sgma where idt in(7,8,9) and active=1;
#SGDA.REQ.TRT.IMP.CHQ=SELECT idT,nom_Traitement, Description, DossierEnre,Destinataire,active FROM r_ncrm_extraction.te_traitement where idt in(4,5,6) and active=1;
#SGDA.REQ.TRT.IMP.LCN=SELECT idT,nom_Traitement, Description, DossierEnre,Destinataire,active FROM r_ncrm_extraction.te_traitement where idt in(10,11,12) and active=1;
SGDA.REQ.TRT.CDE=SELECT idT,nom_Traitement, Description, DossierEnre,Destinataire,active FROM r_ncrm_extraction.te_traitement  where nom_Traitement in (:nom_Traitement)
SGDA.REQ.REPORT.IDTRT=SELECT idR,Id_report, descreption, modeleJRXML,typeGeneration,active,idT FROM r_ncrm_extraction.te_report where idT=:idT

#######################################################################################################################################
				  # NAJMAH #
#######################################################################################################################################
NAJMAH.cde.bq=361

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER ETA
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
### ETA CHQ


NAJMAH.REQ.COUNTDATA.CHQ=SELECT COUNT(*) countValues FROM p_c_najma.te_najma_bch ch,p_c_najma.te_najma_ins ins WHERE ins.instance = ch.instance and date=:Date
NAJMAH.REQ.DATA.CHQ=SELECT  '' bMCH_LIB_REJET_DELTA,bmch.PK_OBJ_IDT AS pk_obj_idt_Chq,bmch.sign AS bmch_sign, bmch.CPT AS BMCH_CPT,bmch.DTEMI AS DTEMI,bmch.LOC AS BMCH_LOC,bmch.ZBK AS BMCH_ZBK,bmch.zib BMCH_ZIB, (SELECT bq.lib FROM r_multi_37.tr_banque bq WHERE bmch.ZBK = bq.cde) AS Bmch_ZBK_lib, bmch.NSER AS BMCH_NSER,bmch.RIB AS BMCH_RIB, bmch.CONF AS BMCH_CONF,CODE_ERREURS AS BMCH_CODE_ERREURS,bmch.OPE_ETA AS BMCH_ope_eta, bmch.Ano AS BMCH_ANO, (bmch.MNT + 0) AS BMCH_MNT,bmch.FLAG_IMP AS BMCH_FLAG_IMP, bmch.FLAG_REJET AS BMCH_FLAG_REJET, '' AS BMCH_FLAG_SCAN_GR,bmch.SQCA AS bmch_SQCA, '' bmch_ID_WEBCAPTUR,''  bmch_AGE_SCAN, '' AS BMCH_REJET_DELTA,bmch.Rio AS BMCH_RIO,bmtr.AGE AS BMTR_age,(SELECT a.lib FROM r_multi_37.tr_agence_najma a WHERE a.age = bmtr.AGE) AS ageTr_lib,bmtr.PK_OBJ_IDT pk_obj_idt_rem,bmtr.OPE_ETA AS BMTR_ope_eta,bmtr.Ano AS BMTR_Ano,bmtr.FLAG_REJET AS BMTR_Flag_Rejet,bmtr.MODE AS BMTR_mode,(bmtr.MNT + 0) AS BMTR_MNT,bmtr.CPT AS BMTR_CPT,bmtr.RIB AS BMTR_RIB,bmtr.LOC AS BMTR_loc,bmtr.ZBK AS BMTR_zbk,bmtr.NSER AS BMTR_NSER,bmtr.NBCH AS BMTR_NBCH,'' bmtr_ID_WEBCAPTUR,''  bmtr_AGE_SCAN,'' bmtr_SECTEUR,bmta.OPE_ETA AS BMTa_ope_eta,bmta.Ano AS BMTa_Ano,bmta.FLAG_REJET AS BMTa_Flag_Rejet,bmta.MODE AS BMTa_mode,(bmta.MNTR + 0) AS BMTa_MNTR,(bmta.SUM_REM + 0) AS BMTA_MNTREM,bmta.DIFF AS BMTA_MNT_DIFF,bmta.DIFF_NB AS BMTA_DIFF_NB,bmta.NSER AS BMTA_NSER_TA,bmta.CPT AS BMTA_CPT,bmta.NSER AS BMTA_NSER,bmta.COUNT_REM AS BMTA_COUNT_REM,bmta.AGE AS BMTA_age,bmtn.Ano AS BMTN_Ano,bmtn.OPE_ETA AS BMTN_ope_eta,bmtn.DIFF AS BMTN_DIFF,bmtn.DIFF_NB AS BMTN_DIFF_NB,bmtn.SUM_CHQ AS BMTN_sum_chq,bmtn.LECTEUR AS BMTN_lecteur,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE FROM ((((((p_c_najma.te_najma_bch bmch JOIN p_c_najma.te_obj obj_bmch)JOIN p_c_najma.te_najma_btr bmtr)JOIN p_c_najma.te_obj obj_bmtr)JOIN p_c_najma.te_najma_ins ins)JOIN p_c_najma.te_najma_bta bmta)JOIN p_c_najma.te_najma_btn bmtn) WHERE ((1 = 1)AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT)AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmch.INSTANCE)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT))AND date =
NAJMAH.REQ.GETLBLANO.CHQ=SELECT tr_ano.ANO_LIB AS ANO_LIB  FROM r_multi_37.tr_ano  where PK_ANO_MNE=:PK_ANO_MNE
NAJMAH.DELETE.TABLE.ETA.CHQ=delete from r_ncrm_extraction.tmp_tbl_eta_chq_najmah


NAJMAH.REQ.ADD.AGE=INSERT INTO r_multi_37.tr_agence_najma(AGE,LIB,LOC) VALUES (?,?,?);
NAJMAH.REQ.DEL.AGE=delete from r_multi_37.tr_agence_najma where age=?;
NAJMAH.REQ.ADD.NEW.PCAPT=INSERT INTO r_ncrm_extraction.te_pcapt(cdePcapt,Lib,type,active,cdeAge,secteur,circuit,cdeBq)VALUES(?,?,?,1,?,?,?,'361');
NAJMAH.REQ.UPDATE.PCAPT=Update r_ncrm_extraction.te_pcapt set cdePcapt=?,Lib=?,type=?,cdeAge=?,secteur=?,circuit=? where idpcapt=? and cdeBq='361'
NAJMAH.REQ.DELETE.PCAPT=delete from r_ncrm_extraction.te_pcapt where idpcapt=?  and cdeBq='361'
NAJMAH.REQ.ALL.PCAPT=SELECT idPcapt as  idpcapt, cdePcapt cdePcapt , Lib as nomPcapt, type as Type, active, cdeAge as ageRattachement,"" secteur,"" circuit FROM r_ncrm_extraction.te_pcapt where cdeBq="361"
NAJMAH.REQ.PCAPT.CDE=SELECT idPcapt as  idpcapt, cdePcapt cdePcapt , Lib as nomPcapt, type as Type, active, cdeAge as ageRattachement,"" secteur,"" circuit FROM r_ncrm_extraction.te_pcapt where cdePcapt in (:cde) and cdeBq="361"
NAJMAH.REQ.TRT.CHQ=SELECT idT,nom_Traitement, Description, DossierEnre,Destinataire,active FROM r_ncrm_extraction.te_traitement where idt in(14) and active=1;
#SGDA.REQ.TRT.LCN=SELECT idT,nom_Traitement, Description, DossierEnre,Destinataire,active FROM r_ncrm_extraction.te_traitement where idt in(7,8,9) and active=1;
#SGDA.REQ.TRT.IMP.CHQ=SELECT idT,nom_Traitement, Description, DossierEnre,Destinataire,active FROM r_ncrm_extraction.te_traitement where idt in(4,5,6) and active=1;
#SGDA.REQ.TRT.IMP.LCN=SELECT idT,nom_Traitement, Description, DossierEnre,Destinataire,active FROM r_ncrm_extraction.te_traitement where idt in(10,11,12) and active=1;
NAJMAH.REQ.TRT.CDE=SELECT idT,nom_Traitement, Description, DossierEnre,Destinataire,active FROM r_ncrm_extraction.te_traitement  where nom_Traitement in (:nom_Traitement)
NAJMAH.REQ.REPORT.IDTRT=SELECT idR,Id_report, descreption, modeleJRXML,typeGeneration,active,idT FROM r_ncrm_extraction.te_report where idT=:idT and active=1





#######################################################################################################################################
				  # SGMA #
#######################################################################################################################################
SGMA.cde.bq=022
SGMA.WSDL.CHQ=http://172.16.0.6:9999/ProviderSGMA?wsdl
SGMA.WSDL.LCN=http://172.17.0.11:9993/ProviderSGMALCN?wsdl

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER ETA 
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# CHEQUES

SGMA.FOLDER.ETA.CHQ=\\\\172.17.0.150\\Sorties\\SGMA\\NCRM_EXTRACTIONS\\CSVETA
SGMA.REQ.COUNTDATA.CHQ=SELECT COUNT(*) countValues FROM p_sgmba.te_sgmba_sch ch,p_sgmba.te_sgmba_ins ins WHERE ins.instance = ch.instance and ch.ID_WEBCAPTUR is not null and date=:Date
SGMA.REQ.DATA.CHQ=SELECT  bmch.LIB_REJET_DELTA BMCH_LIB_REJET_DELTA,bmch.PK_OBJ_IDT AS pk_obj_idt_Chq,bmch.sign as bmch_sign,bmch.CPT AS BMCH_CPT,bmch.DTEMI AS DTEMI,bmch.LOC AS BMCH_LOC,bmch.ZBK AS BMCH_ZBK,bmch.ZIB AS BMCH_ZIB,(select bq.lib from r_ncrm_32.tr_banque bq where bmch.ZBK=bq.cde) as Bmch_ZBK_lib,bmch.NSER AS BMCH_NSER,bmch.RIB AS BMCH_RIB,bmch.CONF AS BMCH_CONF,CODE_ERREURS AS BMCH_CODE_ERREURS,bmch.OPE_ETA AS BMCH_ope_eta,bmch.Ano AS BMCH_ANO,(bmch.MNT + 0) AS BMCH_MNT,bmch.FLAG_IMP AS BMCH_FLAG_IMP,bmch.FLAG_REJET AS BMCH_FLAG_REJET,bmch.FLAG_SCAN_GR as BMCH_FLAG_SCAN_GR,bmch.SQCA AS bmch_SQCA,bmch.ID_WEBCAPTUR bmch_ID_WEBCAPTUR,bmch.AGE_SCAN bmch_AGE_SCAN,bmch.REJET_DELTA as BMCH_REJET_DELTA,bmch.Rio as BMCH_RIO,bmtr.AGE AS BMTR_age,(select a.lib from  r_ncrm_32.tr_agence a where a.age=bmtr.AGE ) AS ageTr_lib,bmtr.PK_OBJ_IDT pk_obj_idt_rem,bmtr.OPE_ETA AS BMTR_ope_eta,bmtr.Ano AS BMTR_Ano,bmtr.FLAG_REJET AS BMTR_Flag_Rejet,bmtr.MODE AS BMTR_mode,(bmtr.MNT + 0) AS BMTR_MNT,bmtr.CPT AS BMTR_CPT,bmtr.RIB AS BMTR_RIB,bmtr.LOC AS BMTR_loc,bmtr.ZBK AS BMTR_zbk,bmtr.NSER AS BMTR_NSER,bmtr.NBCH AS BMTR_NBCH,bmtr.ID_WEBCAPTUR bmtr_ID_WEBCAPTUR,bmtr.AGE_SCAN bmtr_AGE_SCAN,bmtr.SECTEUR bmtr_SECTEUR,bmta.OPE_ETA AS BMTa_ope_eta,bmta.Ano AS BMTa_Ano,bmta.FLAG_REJET AS BMTa_Flag_Rejet,bmta.MODE AS BMTa_mode,(bmta.MNTR + 0) AS BMTa_MNTR,(bmta.SUM_REM + 0) AS BMTA_MNTREM,bmta.DIFF AS BMTA_MNT_DIFF,bmta.DIFF_NB AS BMTA_DIFF_NB,bmta.NSER AS BMTA_NSER_TA,bmta.CPT AS BMTA_CPT,bmta.NSER AS BMTA_NSER,bmta.COUNT_REM AS BMTA_COUNT_REM,bmta.AGE AS BMTA_age,bmtn.Ano AS BMTN_Ano,bmtn.OPE_ETA AS BMTN_ope_eta,bmtn.DIFF AS BMTN_DIFF,bmtn.DIFF_NB AS BMTN_DIFF_NB,bmtn.SUM_CHQ AS BMTN_sum_chq,bmtn.LECTEUR AS BMTN_lecteur,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE FROM ((((((p_sgmba.te_sgmba_sch bmch JOIN p_sgmba.te_obj obj_bmch) JOIN p_sgmba.te_sgmba_str bmtr) JOIN p_sgmba.te_obj obj_bmtr) JOIN p_sgmba.te_sgmba_ins ins) JOIN p_sgmba.te_sgmba_sta bmta) JOIN p_sgmba.te_sgmba_stn bmtn) WHERE ((1 = 1) AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE) AND (ins.INSTANCE = bmtr.INSTANCE) AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmch.INSTANCE) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1)) AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT) AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT) AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) ) and bmch.ID_WEBCAPTUR is not null and date=
SGMA.REQ.GETLBLANO.CHQ=SELECT tr_ano.ANO_LIB AS ANO_LIB  FROM r_ncrm_32.tr_ano where PK_ANO_MNE=:PK_ANO_MNE
SGMA.DELETE.TABLE.ETA.CHQ=delete from r_ncrm_extraction.tmp_tbl_eta_chq_sgma
# LCN 

SGMA.FOLDER.ETA.LCN=\\\\172.17.0.150\\Sorties\\SGMA\\NCRM_EXTRACTIONS\\CSVETA
SGMA.REQ.COUNTDATA.LCN=SELECT COUNT(*) countValues FROM p_l_sgmba.te_l_sgmba_lcn l,p_l_sgmba.te_l_sgmba_ins ins WHERE ins.instance= l.instance and l.ID_WEBCAPTUR<>0 and date=:Date
SGMA.REQ.DATA.LCN=SELECT bmlcn.LIB_REJET_DELTA BMLCN_LIB_REJET_DELTA,bmtr.PK_OBJ_IDT pk_obj_idt_rem,bmlcn.PK_OBJ_IDT AS pk_obj_idt_LCN,bmlcn.CPT AS Bmlcn_CPT,bmlcn.DTEMI AS DTEMI,bmlcn.LOC AS BMLCN_LOC,bmlcn.ZBK AS BMLCN_ZBK,bmlcn.ZIB AS BMLCN_ZIB,(SELECT bq.lib FROM r_ncrm_21.tr_banque bq WHERE bmlcn.ZBK = bq.cde) AS bmlcn_ZBK_lib,bmlcn.NSER AS bmlcn_NSER,bmlcn.RIB AS bmlcn_RIB,bmlcn.CONF AS bmlcn_CONF,CODE_ERREURS AS bmlcn_CODE_ERREURS,bmlcn.OPE_ETA AS bmlcn_ope_eta,bmlcn.Ano AS bmlcn_ANO,(bmlcn.MNT + 0) AS bmlcn_MNT,bmlcn.FLAG_IMP AS bmlcn_FLAG_IMP,bmlcn.FLAG_REJET AS bmlcn_FLAG_REJET,bmlcn.FLAG_SCAN_GR AS bmlcn_FLAG_SCAN_GR,bmlcn.SQCA AS bmlcn_SQCA,bmlcn.ID_WEBCAPTUR bmlcn_ID_WEBCAPTUR,bmlcn.AGE_SCAN bmlcn_AGE_SCAN,bmlcn.REJET_DELTA as Bmlcn_REJET_DELTA,bmlcn.DTEEC2 as bmlcn_DTEEC,bmlcn.sign as bmlcn_sign,bmlcn.rio as bmlcn_rio,bmtr.AGESG AS BMTR_age,(select a.lib from  r_ncrm_21.tr_agence a where a.age=bmtr.AGESG ) AS ageTr_lib,bmtr.OPE_ETA AS BMTR_ope_eta,bmtr.Ano AS BMTR_Ano,bmtr.FLAG_REJET AS BMTR_Flag_Rejet,bmtr.MODE AS BMTR_mode,(bmtr.MNT + 0) AS BMTR_MNT,bmtr.CPTSG AS BMTR_CPT,bmtr.RIB AS BMTR_RIB,bmtr.ZBK AS BMTR_zbk,bmtr.NSERSG AS BMTR_NSER,bmtr.NBCH AS BMTR_NBCH,bmtr.ID_WEBCAPTUR bmtr_ID_WEBCAPTUR,bmtr.AGE_SCAN bmtr_AGE_SCAN,bmtr.SECTEUR bmtr_SECTEUR,bmta.OPE_ETA AS BMTa_ope_eta,bmta.Ano AS BMTa_Ano,bmta.FLAG_REJET AS BMTa_Flag_Rejet,bmta.MODE AS BMTa_mode,(bmta.MNTR + 0) AS BMTa_MNTR,(bmta.SUM_REM + 0) AS BMTA_MNTREM,bmta.DIFF AS BMTA_MNT_DIFF,bmta.DIFF_NB AS BMTA_DIFF_NB,bmta.NSERSG AS BMTA_NSER_TA,bmta.CPT AS BMTA_CPT,bmta.NSERSG AS BMTA_NSER,bmta.COUNT_REM AS BMTA_COUNT_REM,bmta.AGE AS BMTA_age,bmtn.Ano AS BMTN_Ano,bmtn.OPE_ETA AS BMTN_ope_eta,bmtn.DIFF AS BMTN_DIFF,bmtn.DIFF_NB AS BMTN_DIFF_NB,bmtn.SUM_CHQ AS BMTN_sum_Lcn,bmtn.LECTEUR AS BMTN_lecteur,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE FROM ((((((p_l_sgmba.te_l_sgmba_lcn bmlcn JOIN p_l_sgmba.te_obj obj_bmlcn) JOIN p_l_sgmba.te_l_sgmba_rl bmtr) JOIN p_l_sgmba.te_obj obj_bmtr) JOIN p_l_sgmba.te_l_sgmba_ins ins) JOIN p_l_sgmba.te_l_sgmba_ll bmta) JOIN p_l_sgmba.te_l_sgmba_tl bmtn) WHERE ((1 = 1) AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE) AND (ins.INSTANCE = bmtr.INSTANCE) AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmlcn.INSTANCE)AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT + 1)) AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT) AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT) AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)) and bmlcn.ID_WEBCAPTUR<>0 AND date=
SGMA.REQ.GETLBLANO.LCN=SELECT tr_ano.ANO_LIB AS ANO_LIB  FROM r_ncrm_21.tr_ano where PK_ANO_MNE=:PK_ANO_MNE
SGMA.DELETE.TABLE.ETA.LCN=delete from r_ncrm_extraction.tmp_tbl_eta_lcn_sgma



# SUIVI PHYSIQUE 
SGMA.OUT.REC.SUIVI.CHQ=\\\\172.17.0.6\\ChqToExtract\\SGMB\\SUIVI_PHYSIQUE\\
SGMA.OUT.REC.SUIVI.LCN=\\\\172.17.0.6\\ChqToExtract\\BMCI\\SUIVI_PHYSIQUE\\
#SGMA.OUT.REC.SUIVI.CHQ=\\\\172.17.0.6\\ChqToExtract\\SGMB\\SUIVI_PHYSIQUE\\RecupByBq\\
#SGMA.FOLDER.OUT.CLASSIFY.PAYEE.CHQ=\\\\172.17.0.6\\ChqToExtract\\SGMB\\test

SGMA.REQ.GET.ALL.VALUE.CHQ=SELECT  bmch_zbk zbk, bmch_loc loc, bmch_nser nser, bmch_cpt cpt, bmch_rib rib, bmch_CONF conf, bmch_ope_eta ope_eta, bmch_FLAG_IMP impy,BMCH_REJET_DELTA RDelta ,'' dteec,(SELECT  poche FROM r_ncrm_extraction.sgma_poche_affectation WHERE zbk = c.bmch_zbk GROUP BY zbk) poche FROM r_ncrm_extraction.tmp_tbl_suivi_chq_sgma c where 1=1
SGMA.REQ.COUNTDATA.SUIVI.CHQ=SELECT COUNT(*) countValues FROM ((((((p_sgmba.te_sgmba_sch bmch JOIN p_sgmba.te_obj obj_bmch) JOIN p_sgmba.te_sgmba_str bmtr) JOIN p_sgmba.te_obj obj_bmtr) JOIN p_sgmba.te_sgmba_ins ins) JOIN p_sgmba.te_sgmba_sta bmta) JOIN p_sgmba.te_sgmba_stn bmtn) WHERE ((1 = 1) AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE) AND (ins.INSTANCE = bmtr.INSTANCE) AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmch.INSTANCE) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1)) AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT) AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT) AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) ) and (date=:Date1 or date=:Date2) and bmch.ID_WEBCAPTUR is not null
SGMA.REQ.DATA.SUIVI.CHQ= SELECT  bMCH.LIB_REJET_DELTA bMCH_LIB_REJET_DELTA,bmch.zib as BMCH_ZIB,bmch.PK_OBJ_IDT AS pk_obj_idt_Chq,bmch.sign as bmch_sign,bmch.CPT AS BMCH_CPT,bmch.DTEMI AS DTEMI,bmch.LOC AS BMCH_LOC,bmch.ZBK AS BMCH_ZBK,(select bq.lib from r_ncrm_32.tr_banque bq where bmch.ZBK=bq.cde) as Bmch_ZBK_lib,bmch.NSER AS BMCH_NSER,bmch.RIB AS BMCH_RIB,bmch.CONF AS BMCH_CONF,CODE_ERREURS AS BMCH_CODE_ERREURS,bmch.OPE_ETA AS BMCH_ope_eta,bmch.Ano AS BMCH_ANO,(bmch.MNT + 0) AS BMCH_MNT,bmch.FLAG_IMP AS BMCH_FLAG_IMP,bmch.FLAG_REJET AS BMCH_FLAG_REJET,bmch.FLAG_SCAN_GR as BMCH_FLAG_SCAN_GR,bmch.SQCA AS bmch_SQCA,bmch.ID_WEBCAPTUR bmch_ID_WEBCAPTUR,bmch.AGE_SCAN bmch_AGE_SCAN,bmch.REJET_DELTA as BMCH_REJET_DELTA,bmch.Rio as BMCH_RIO,bmtr.AGE AS BMTR_age,(select a.lib from  r_ncrm_32.tr_agence a where a.age=bmtr.AGE ) AS ageTr_lib,bmtr.PK_OBJ_IDT pk_obj_idt_rem,bmtr.OPE_ETA AS BMTR_ope_eta,bmtr.Ano AS BMTR_Ano,bmtr.FLAG_REJET AS BMTR_Flag_Rejet,bmtr.MODE AS BMTR_mode,(bmtr.MNT + 0) AS BMTR_MNT,bmtr.CPT AS BMTR_CPT,bmtr.RIB AS BMTR_RIB,bmtr.LOC AS BMTR_loc,bmtr.ZBK AS BMTR_zbk,bmtr.NSER AS BMTR_NSER,bmtr.NBCH AS BMTR_NBCH,bmtr.ID_WEBCAPTUR bmtr_ID_WEBCAPTUR,bmtr.AGE_SCAN bmtr_AGE_SCAN,bmtr.SECTEUR bmtr_SECTEUR,bmta.OPE_ETA AS BMTa_ope_eta,bmta.Ano AS BMTa_Ano,bmta.FLAG_REJET AS BMTa_Flag_Rejet,bmta.MODE AS BMTa_mode,(bmta.MNTR + 0) AS BMTa_MNTR,(bmta.SUM_REM + 0) AS BMTA_MNTREM,bmta.DIFF AS BMTA_MNT_DIFF,bmta.DIFF_NB AS BMTA_DIFF_NB,bmta.NSER AS BMTA_NSER_TA,bmta.CPT AS BMTA_CPT,bmta.NSER AS BMTA_NSER,bmta.COUNT_REM AS BMTA_COUNT_REM,bmta.AGE AS BMTA_age,bmtn.Ano AS BMTN_Ano,bmtn.OPE_ETA AS BMTN_ope_eta,bmtn.DIFF AS BMTN_DIFF,bmtn.DIFF_NB AS BMTN_DIFF_NB,bmtn.SUM_CHQ AS BMTN_sum_chq,bmtn.LECTEUR AS BMTN_lecteur,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE FROM ((((((p_sgmba.te_sgmba_sch bmch JOIN p_sgmba.te_obj obj_bmch) JOIN p_sgmba.te_sgmba_str bmtr) JOIN p_sgmba.te_obj obj_bmtr) JOIN p_sgmba.te_sgmba_ins ins) JOIN p_sgmba.te_sgmba_sta bmta) JOIN p_sgmba.te_sgmba_stn bmtn) WHERE ((1 = 1) AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE) AND (ins.INSTANCE = bmtr.INSTANCE) AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmch.INSTANCE) AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1)) AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT) AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT) AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) ) and bmch.ID_WEBCAPTUR is not null
SGMA.REQ.RECUP.SUIVI.CHQ=SELECT concat(date,LECTEUR) DATE_LECTEUR,DATE AS DATE,lecteur LECTEUR,circuit circuit,LECTEUR_LIB AS LECTEUR_LIB,SUM(NBR_CHQ_DEC) AS NBR_CHQ_DEC,SUM(NBR_CHQ_TRAIT) AS NBR_CHQ_TRT,SUM(NBR_CHQ_SUPP) AS NBR_CHQ_SUPP,SUM(NBR_CHQ_VF) AS NBR_CHQ_VF,SUM(NBR_CHQ_RD) AS NBR_CHQ_RD,SUM(NBR_CHQ_IMP) AS NBR_CHQ_IMP FROM((SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,COUNT(*) AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,   0 AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_chq_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 and p.cdeBq="022" and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)union(SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,COUNT(*) AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_chq_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 and p.cdeBq="022" AND BMCH_ope_eta <> 'D' AND BMTR_ope_eta <> 'D'  and (BMCH_CONF='1' or (BMCH_CONF='0' and BMCH_ZBK='022')) and bmch_FLAG_IMP<>1 and (bmch_rejet_delta <> 1 or bmch_rejet_delta is null ) and v.BMTN_lecteur=p.cdePcapt and dateReception is null  GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,count(*) AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_chq_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 and p.cdeBq="022" AND (BMCH_ope_eta ='D' )and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,COUNT(*) AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_chq_sgma v ,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 and p.cdeBq="022" AND (BMCH_CONF='0' and BMCH_ZBK<>'022' ) and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF,COUNT(*) AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_chq_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 and p.cdeBq="022" AND (bmch_rejet_delta=1)and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF, 0 AS NBR_CHQ_RD,COUNT(*) AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_chq_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 and p.cdeBq="022" AND (BMCH_FLAG_IMP=1) and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)) AS RECAP GROUP BY date , lecteur ORDER BY date , lecteur
#SELECT concat(date,LECTEUR) DATE_LECTEUR,DATE AS DATE,lecteur LECTEUR,circuit circuit,LECTEUR_LIB AS LECTEUR_LIB,SUM(NBR_CHQ_DEC) AS NBR_CHQ_DEC,SUM(NBR_CHQ_TRAIT) AS NBR_CHQ_TRT,SUM(NBR_CHQ_SUPP) AS NBR_CHQ_SUPP,SUM(NBR_CHQ_VF) AS NBR_CHQ_VF,SUM(NBR_CHQ_RD) AS NBR_CHQ_RD,SUM(NBR_CHQ_IMP) AS NBR_CHQ_IMP FROM((SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,COUNT(*) AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,   0 AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_chq_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)union(SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,COUNT(*) AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_chq_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 AND BMCH_ope_eta <> 'D' AND BMTR_ope_eta <> 'D'  and (BMCH_CONF='1' or (BMCH_CONF='0' and BMCH_ZBK='022')) and bmch_FLAG_IMP<>1 and (bmch_rejet_delta <> 1 or bmch_rejet_delta is null ) and v.BMTN_lecteur=p.cdePcapt and dateReception is null  GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,count(*) AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_chq_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 AND (BMCH_ope_eta ='D' )and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,COUNT(*) AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_chq_sgma v ,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 AND (BMCH_CONF='0' and BMCH_ZBK<>'022' ) and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF,COUNT(*) AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_chq_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 AND (bmch_rejet_delta=1)and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF, 0 AS NBR_CHQ_RD,COUNT(*) AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_chq_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 AND (BMCH_FLAG_IMP=1) and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)) AS RECAP GROUP BY date , lecteur ORDER BY date , lecteur
SGMA.REQ.DETAIL.SUIVI.CHQ=SELECT  concat(bmch_nser,bmch_zbk,bmch_loc,bmch_cpt,bmch_rib) cmc7,cast(bmch_mnt as decimal(16,2)) mnt,date, BMTN_lecteur lecteur, bmch_nser nser, bmch_zbk zbkt, bmch_loc loct, bmch_cpt cptt, bmch_rib ribt, bmch_conf conf, bmch_FLAG_IMP  AS 'FLAG_IMP', bmch_ope_eta ope_eta, dateReception, receptionist FROM r_ncrm_extraction.tmp_tbl_suivi_chq_sgma t;
SGMA.REQ.UPDATE.SUIVI.CHQ=update  r_ncrm_extraction.tmp_tbl_suivi_chq_sgma set dateReception=DATE_FORMAT(now(), "%d/%m/%Y") , receptionist=:receptionist where 1=1

SGMA.DEFAULT.POCHE.CHQ=18
SGMA.DEFAULT.POCHE.IMP.CHQ=5
SGMA.DEFAULT.POCHE.RD.CHQ=7
SGMA.DEFAULT.POCHE.VF.CHQ=6
SGMA.DEFAULT.POCHE.SUP.CHQ=4




SGMA.REQ.GET.ALL.VALUE.LCN=SELECT  bmlcn_zbk zbk, bmlcn_loc loc, bmlcn_nser nser, bmlcn_cpt cpt, bmlcn_rib rib, bmlcn_CONF conf, bmlcn_ope_eta ope_eta, bmlcn_FLAG_IMP impy,bmlcn_REJET_DELTA RDelta,bmlcn_dteec dteec ,(SELECT  poche FROM r_ncrm_extraction.sgma_poche_affectation_lcn WHERE zbk = c.bmlcn_zbk GROUP BY zbk) poche FROM r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma c where 1=1
SGMA.REQ.COUNTDATA.SUIVI.LCN=SELECT COUNT(*) countValues FROM p_l_sgmba.te_l_sgmba_lcn l,p_l_sgmba.te_l_sgmba_ins ins WHERE ins.instance= l.instance and l.ID_WEBCAPTUR <>'0' and (date=:Date1 or date=:Date2)
SGMA.REQ.DATA.SUIVI.LCN=SELECT bMLCN.LIB_REJET_DELTA bMLCN_LIB_REJET_DELTA,bmlcn.REJET_DELTA bmlcn_REJET_DELTA,bmtr.PK_OBJ_IDT pk_obj_idt_rem,bmlcn.PK_OBJ_IDT AS pk_obj_idt_LCN,bmlcn.CPT AS Bmlcn_CPT,bmlcn.DTEMI AS DTEMI,bmlcn.LOC AS BMLCN_LOC,bmlcn.ZBK AS BMLCN_ZBK,BMLCN.ZIB BMLCN_ZIB,(SELECT bq.lib FROM r_ncrm_21.tr_banque bq WHERE bmlcn.ZBK = bq.cde) AS bmlcn_ZBK_lib,bmlcn.NSER AS bmlcn_NSER,bmlcn.RIB AS bmlcn_RIB,bmlcn.CONF AS bmlcn_CONF,CODE_ERREURS AS bmlcn_CODE_ERREURS,bmlcn.OPE_ETA AS bmlcn_ope_eta,bmlcn.Ano AS bmlcn_ANO,(bmlcn.MNT + 0) AS bmlcn_MNT,bmlcn.FLAG_IMP AS bmlcn_FLAG_IMP,bmlcn.FLAG_REJET AS bmlcn_FLAG_REJET,bmlcn.FLAG_SCAN_GR AS bmlcn_FLAG_SCAN_GR,bmlcn.SQCA AS bmlcn_SQCA,bmlcn.ID_WEBCAPTUR bmlcn_ID_WEBCAPTUR,bmlcn.AGE_SCAN bmlcn_AGE_SCAN,bmlcn.DTEEC2 as bmlcn_DTEEC,bmlcn.sign as bmlcn_sign,bmlcn.rio as bmlcn_rio,bmtr.AGESG AS BMTR_age,(select a.lib from  r_ncrm_21.tr_agence a where a.age=bmtr.AGESG ) AS ageTr_lib,bmtr.OPE_ETA AS BMTR_ope_eta,bmtr.Ano AS BMTR_Ano,bmtr.FLAG_REJET AS BMTR_Flag_Rejet,bmtr.MODE AS BMTR_mode,(bmtr.MNT + 0) AS BMTR_MNT,bmtr.CPTSG AS BMTR_CPT,bmtr.RIB AS BMTR_RIB,bmtr.ZBK AS BMTR_zbk,bmtr.NSERSG AS BMTR_NSER,bmtr.NBCH AS BMTR_NBCH,bmtr.ID_WEBCAPTUR bmtr_ID_WEBCAPTUR,bmtr.AGE_SCAN bmtr_AGE_SCAN,bmtr.SECTEUR bmtr_SECTEUR,bmta.OPE_ETA AS BMTa_ope_eta,bmta.Ano AS BMTa_Ano,bmta.FLAG_REJET AS BMTa_Flag_Rejet,bmta.MODE AS BMTa_mode,(bmta.MNTR + 0) AS BMTa_MNTR,(bmta.SUM_REM + 0) AS BMTA_MNTREM,bmta.DIFF AS BMTA_MNT_DIFF,bmta.DIFF_NB AS BMTA_DIFF_NB,bmta.NSERSG AS BMTA_NSER_TA,bmta.CPT AS BMTA_CPT,bmta.NSERSG AS BMTA_NSER,bmta.COUNT_REM AS BMTA_COUNT_REM,bmta.AGE AS BMTA_age,bmtn.Ano AS BMTN_Ano,bmtn.OPE_ETA AS BMTN_ope_eta,bmtn.DIFF AS BMTN_DIFF,bmtn.DIFF_NB AS BMTN_DIFF_NB,bmtn.SUM_CHQ AS BMTN_sum_Lcn,bmtn.LECTEUR AS BMTN_lecteur,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE FROM ((((((p_l_sgmba.te_l_sgmba_lcn bmlcn JOIN p_l_sgmba.te_obj obj_bmlcn) JOIN p_l_sgmba.te_l_sgmba_rl bmtr) JOIN p_l_sgmba.te_obj obj_bmtr) JOIN p_l_sgmba.te_l_sgmba_ins ins) JOIN p_l_sgmba.te_l_sgmba_ll bmta) JOIN p_l_sgmba.te_l_sgmba_tl bmtn) WHERE ((1 = 1) AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE) AND (ins.INSTANCE = bmtr.INSTANCE) AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmlcn.INSTANCE)AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT + 1)) AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT) AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT) AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) and bmlcn.ID_WEBCAPTUR <>'0')
SGMA.REQ.RECUP.SUIVI.LCN=SELECT concat(date,LECTEUR) DATE_LECTEUR,DATE AS DATE,lecteur LECTEUR,circuit circuit,LECTEUR_LIB AS LECTEUR_LIB,SUM(NBR_CHQ_DEC) AS NBR_CHQ_DEC,SUM(NBR_CHQ_TRAIT) AS NBR_CHQ_TRT,SUM(NBR_CHQ_SUPP) AS NBR_CHQ_SUPP,SUM(NBR_CHQ_VF) AS NBR_CHQ_VF,SUM(NBR_CHQ_RD) AS NBR_CHQ_RD,SUM(NBR_CHQ_IMP) AS NBR_CHQ_IMP FROM((SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,COUNT(*) AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,   0 AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 and p.cdeBq="022" and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)union(SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,COUNT(*) AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 and p.cdeBq="022" AND bmlcn_ope_eta <> 'D' AND BMTR_ope_eta <> 'D' and (bmlcn_CONF = 1 or (bmlcn_CONF = 0 and bmlcn_CODE_ERREURS='ABOP')) AND (bmlcn_FLAG_IMP <> '1' or  bmlcn_FLAG_IMP is null ) and (bmlcn_rejet_delta <> '1' OR bmlcn_rejet_delta IS NULL) and v.BMTN_lecteur=p.cdePcapt and dateReception is null  GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,count(*) AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1  and p.cdeBq="022" AND (bmlcn_ope_eta ='D' )and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,COUNT(*) AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma v ,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 and p.cdeBq="022" AND (bmlcn_CONF <> 1 and bmlcn_CODE_ERREURS!='ABOP') and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF,COUNT(*) AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 and p.cdeBq="022" AND (bmlcn_rejet_delta=1)and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF, 0 AS NBR_CHQ_RD,COUNT(*) AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 and p.cdeBq="022" AND (bmlcn_FLAG_IMP=1) and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)) AS RECAP GROUP BY date , lecteur ORDER BY date , lecteur
#SELECT concat(date,LECTEUR) DATE_LECTEUR,DATE AS DATE,lecteur LECTEUR,circuit circuit,LECTEUR_LIB AS LECTEUR_LIB,SUM(NBR_CHQ_DEC) AS NBR_CHQ_DEC,SUM(NBR_CHQ_TRAIT) AS NBR_CHQ_TRT,SUM(NBR_CHQ_SUPP) AS NBR_CHQ_SUPP,SUM(NBR_CHQ_VF) AS NBR_CHQ_VF,SUM(NBR_CHQ_RD) AS NBR_CHQ_RD,SUM(NBR_CHQ_IMP) AS NBR_CHQ_IMP FROM((SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,COUNT(*) AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,   0 AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)union(SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,COUNT(*) AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 AND bmlcn_ope_eta <> 'D' AND BMTR_ope_eta <> 'D' and (bmlcn_CONF = 1 or (bmlcn_CONF = 0 and bmlcn_CODE_ERREURS='ABOP')) AND (bmlcn_FLAG_IMP <> '1' or  bmlcn_FLAG_IMP is null ) and (bmlcn_rejet_delta <> '1' OR bmlcn_rejet_delta IS NULL) and v.BMTN_lecteur=p.cdePcapt and dateReception is null  GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,count(*) AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 AND (bmlcn_ope_eta ='D' )and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,COUNT(*) AS NBR_CHQ_VF,0 AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma v ,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 AND (bmlcn_CONF <> 1 and bmlcn_CODE_ERREURS!='ABOP') and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF,COUNT(*) AS NBR_CHQ_RD,0 AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 AND (bmlcn_rejet_delta=1)and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)UNION (SELECT v.date AS DATE,v.BMTN_lecteur AS LECTEUR,p.Lib AS LECTEUR_LIB,p.circuit circuit,0 AS NBR_CHQ_DEC,0 AS NBR_CHQ_TRAIT,0 AS NBR_CHQ_SUPP,0 AS NBR_CHQ_VF, 0 AS NBR_CHQ_RD,COUNT(*) AS NBR_CHQ_IMP FROM r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma v,r_ncrm_extraction.te_pcapt p WHERE 1 = 1 AND (bmlcn_FLAG_IMP=1) and v.BMTN_lecteur=p.cdePcapt and dateReception is null GROUP BY date , lecteur ORDER BY date , lecteur)) AS RECAP GROUP BY date , lecteur ORDER BY date , lecteur
SGMA.REQ.DETAIL.SUIVI.LCN=SELECT  date,bmlcn_dteec dteec, BMTN_lecteur lecteur, bmlcn_nser nser, bmlcn_zbk zbkt, bmlcn_loc loct, bmlcn_cpt cppt, bmlcn_rib ribt, bmlcn_conf conf, CASE bmlcn_FLAG_IMP  WHEN '1' THEN 'Impayee' ELSE 'Payee'  END AS 'FLAG_IMP', bmlcn_ope_eta ope_eta, dateReception, receptionist FROM r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma t;
SGMA.REQ.UPDATE.SUIVI.LCN=update  r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma set dateReception=DATE_FORMAT(now(), "%d/%m/%Y") , receptionist=:receptionist where 1=1
SGMA.REQ.SYNCH.IMPY.LCN=update r_ncrm_extraction.tmp_tbl_suivi_lcn_sgma p,p_s_sgmb.te_s_sgmb_slcn s set p.bmlcn_FLAG_IMP=s.FLAG_IMP where 1=1 and p.receptionist is null and s.DTEINS=p.DATE and s.nser=p.BMLCN_nser and s.zbk=p.BMLCN_ZBK and s.loc=p.BMLCN_LOC and s.cpt=p.BMLCN_cpt and s.rib=p.bmlcn_RIB and s.MNT=cast(p.bmlcn_MNT as decimal(16,2)) and s.FLAG_IMP=1 ;


SGMA.DEFAULT.POCHE.LCN=19
SGMA.DEFAULT.POCHE.IMP.LCN=5
SGMA.DEFAULT.POCHE.RD.LCN=7
SGMA.DEFAULT.POCHE.VF.LCN=6
SGMA.DEFAULT.POCHE.SUP.LCN=4
SGMA.DEFAULT.POCHE.ECHUE.LCN=8
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER RecETA FILE 
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SGMA.OUT.REC=\\\\172.17.0.151\\Insertions

# CHEQUES
SGMA.REQ.DATA.REM.REC.CHQ=SELECT pk_obj_idt_rem pkObjIdtRem,bmtr_ID_WEBCAPTUR idWebCapture ,BMTN_lecteur cdePcapt,BMTR_NSER nser,BMTR_age cdeAge,BMTR_CPT ribRemettant,BMTR_MNT mnt,BMTR_mode typeRemise,BMTR_ope_eta opeEta,BMTR_Ano cdeAnomalie FROM  r_ncrm_extraction.tmp_tbl_eta_chq_sgma where 1=1 and date=:date  group by pk_obj_idt_rem ;
SGMA.REQ.DATA.REC.CHQ=SELECT pk_obj_idt_Chq pkObjIdt,bmch_ID_WEBCAPTUR idWebCapture,BMTN_lecteur cdePcapt,BMch_NSER nser,concat(bmch_zbk,bmch_loc,BMch_CPT,bmch_rib) ribTire,BMch_MNT mnt,BMch_sign signature,SUBSTRING(BMCH_CODE_ERREURS,1,4) conf,BMCH_ope_eta opeEta,BMCH_Ano cdeAnomalie,"" dteEchee,bmch_rio rio FROM r_ncrm_extraction.tmp_tbl_eta_chq_sgma where 1=1 and date=:date and pk_obj_idt_rem=:pkobjidRem

# LCN 
SGMA.REQ.DATA.REM.REC.LCN=SELECT pk_obj_idt_rem pkObjIdtRem,bmtr_ID_WEBCAPTUR idWebCapture,BMTN_lecteur cdePcapt,BMTR_NSER nser,BMTR_age cdeAge,BMTR_CPT ribRemettant, BMTR_MNT mnt,BMTR_mode typeRemise,BMTR_ope_eta opeEta, BMTR_Ano cdeAnomalie FROM r_ncrm_extraction.tmp_tbl_eta_lcn_sgma where 1=1  and date=:date group by pk_obj_idt_rem ;
SGMA.REQ.DATA.REC.LCN=SELECT pk_obj_idt_lcn pkObjIdt,bmlcn_ID_WEBCAPTUR idWebCapture,BMTN_lecteur cdePcapt,bmlcn_NSER nser,concat(bmlcn_zbk,bmlcn_loc,bmlcn_CPT,bmlcn_rib) ribTire,bmlcn_MNT mnt,bmlcn_sign signature,SUBSTRING(BMLCN_CODE_ERREURS,1,4) conf,bmlcn_ope_eta opeEta ,bmlcn_Ano cdeAnomalie,bmlcn_dteec dteEchee,bmlcn_rio rio FROM r_ncrm_extraction.tmp_tbl_eta_lcn_sgma where 1=1 and date=:date and pk_obj_idt_rem=:pkobjidRem

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     ### EDITER IMPAYEE 
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# CHEQUES

SGMA.INDIR.CRO.CHQ=\\\\172.17.0.4\\Impayes\\SGMB_WebCapture\\CHQ\\
SGMA.PATTERN.CROFILE.CHQ=([0-9]{3})(.[0-9]{3})(.[0-9]{3})(.131)(.MAD)(.CRO)
SGMA.PATTERN.RECORDCRO.CHQ=([0-9]{3})(MAD)(.{26})([0-9]{8})(131)(.{3})(.{12})([0-9]{3})(.{32})([0-1]{1})(.{46})$
SGMA.REQ.GETIMP.PROD.CHQ=SELECT "" REJET_LIB,bmch.PK_OBJ_IDT bmch_PK_OBJ_IDT,bmch.CPT as bmch_CPT ,bmch.LOC as bmch_LOC,bmch.ZBK as bmch_ZBK,(SELECT lib FROM  r_ncrm_32.tr_banque where bmch_ZBK=cde) ZBK_LIB,bmch.NSER AS bmch_nser,bmch.RIB AS bmch_rib,bmch.MNT AS bmch_MNT,bmtr.AGE AS bmtr_AGE,(SELECT lib FROM  r_ncrm_32.tr_agence where bmtr_AGE=AGE) AGE_LIB,bmtr.CPT as bmtr_CPT,bmtr.nser bmtr_nser,bmtr.MODE bmtr_mode, bmtn.LECTEUR as bmtn_lecteur,bmch.rio as RIOINI,bmch.SQCA as bmch_SQCA,ins.DATE  as DTE_TRT ,bmch.DTE_SORT  as DTE_SORT,bmch.ID_WEBCAPTUR AS ID_WEBCAPTUR,bmch.AGE_SCAN AS AGE_SCAN ,"" RSOC_RMT,"" RSOC_TIRE,"" ADR_RMT,"" NOMTIRE,"" CIN,"" RC,"" LieuEmission,"" DTEemission,"" DTREJET,"" MOTIF1,"" MOTIF2,"" MOTIF3,"" ADR_TIR,"" DTEPRE,"" RIOINI,"" RIO,"" Rejet FROM((((((p_sgmba.te_sgmba_sch bmch JOIN p_sgmba.te_obj obj_bmch)JOIN p_sgmba.te_sgmba_str bmtr)JOIN p_sgmba.te_obj obj_bmtr)JOIN p_sgmba.te_sgmba_ins ins)JOIN p_sgmba.te_sgmba_sta bmta)JOIN p_sgmba.te_sgmba_stn bmtn) WHERE ((1 = 1) AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmch.INSTANCE)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) and FLAG_IMP='1' and  bmch.ID_WEBCAPTUR is not null and bmch.rio=:RIOINI);

SGMA.INDIR.IFPCONF.CHQ=\\\\172.17.0.4\\Impayes\\SGMB_WebCapture\\
SGMA.PATTERN.IFPCONFFILE.CHQ=([0-9]{3})(.[0-9]{3})(.MAD)(.[0-9]{3})(.[0-9]{8}).(ifp|IFP)(.MAILO)
SGMA.PATTERN.RECORDIFP.CONF.CHQ=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})(.{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})(.{0,3})
#(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
SGMA.REQ.ADDIMP.CHQ=INSERT INTO r_ncrm_extraction.tmp_tbl_impy_chq_sgma(REF,PK_OBJ_IDT,RIO,RIOINI,REJET,ADR_RMT,ADR_TIR,ZBKT,AGE_RMT,AGE_RMT_LIB,CPT,CPTT,DTEREG,LOCT,MEM2,MNT,NSER,SQCA,RIBT,RSOC_RMT,RSOC_TIRE,ZBK_lib,NOMTIRE,CIN,RC,lieuEmission,MOTIF1,MOTIF2,MOTIF3,REJET_LIB,DTREJET,DTEINS,DTEPRE,DTEemission,DTETRT,DTE_SORT,ID_WEBCAPTUR,AGE_SCAN,bmtr_nser ,bmtr_mode)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select lib from  editions.tr_rejets where REJET=? ),?,?,?,?,?,?,?,?,?,?);

SGMA.INDIR.IFPIA.CHQ=\\\\172.17.0.4\\Impayes\\SGMB_WebCapture\\CHQ\\022\\
SGMA.PATTERN.IFPIAFILE.CHQ=(022)(.[0-9]{3})(.MAD)(.[0-9]{3})(.[0-9]{8}).(ifp|IFP)(.MAILO)
SGMA.PATTERN.RECORDIFP.IA.CHQ=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
SGMA.REQ.GETIMP.PROD.IA.CHQ=SELECT bmtr.nser bmtr_nser ,bmtr.MODE bmtr_mode,"" REJET_LIB,bmch.PK_OBJ_IDT bmch_PK_OBJ_IDT,bmch.CPT as bmch_CPT ,bmch.LOC as bmch_LOC,bmch.ZBK as bmch_ZBK,(SELECT lib FROM  r_ncrm_32.tr_banque where bmch_ZBK=cde) ZBK_LIB,bmch.NSER AS bmch_nser,bmch.RIB AS bmch_rib,bmch.MNT AS bmch_MNT,bmtr.AGE AS bmtr_AGE,(SELECT lib FROM  r_ncrm_32.tr_agence where bmtr_AGE=AGE) AGE_LIB,bmtr.CPT as bmtr_CPT, bmtn.LECTEUR as bmtn_lecteur,bmch.rio as RIOINI,bmch.SQCA as bmch_SQCA,ins.DATE  as DTE_TRT ,bmch.DTE_SORT  as DTE_SORT,bmch.ID_WEBCAPTUR AS ID_WEBCAPTUR,bmch.AGE_SCAN AS AGE_SCAN ,"" RSOC_RMT,"" RSOC_TIRE,"" ADR_RMT,"" NOMTIRE,"" CIN,"" RC,"" LieuEmission,"" DTEemission,"" DTREJET,"" MOTIF1,"" MOTIF2,"" MOTIF3,"" ADR_TIR,"" DTEPRE,"" RIOINI,"" RIO,"" Rejet FROM((((((p_sgmba.te_sgmba_sch bmch JOIN p_sgmba.te_obj obj_bmch)JOIN p_sgmba.te_sgmba_str bmtr)JOIN p_sgmba.te_obj obj_bmtr)JOIN p_sgmba.te_sgmba_ins ins)JOIN p_sgmba.te_sgmba_sta bmta)JOIN p_sgmba.te_sgmba_stn bmtn) WHERE ((1 = 1) AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT) AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE) AND (ins.INSTANCE = bmch.INSTANCE)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT) and FLAG_IMP='1' and  bmch.ID_WEBCAPTUR is not null and bmch.zbk=:ZBKT and  bmch.nser=:NSER and bmch.mnt=:mnt and (ins.date=:DTETRT  ))

SGMA.REQ.COUNT.IMP.CHQ=SELECT ZBKT ZBK,ZBK_lib,DTETRT as DTE,count(*) as CountVal,DTE_SORT dteSort FROM r_ncrm_extraction.tmp_tbl_impy_chq_sgma  where nser is not null and DTETRT is not null group by zbk
SGMA.FOLDER.OUT.IMP.CHQ=\\\\172.17.0.150\\Sorties\\SGMA\\NCRM_EXTRACTIONS\\CSVIMP
SGMA.REQ.DATA.IMP.CHQ=SELECT  bmtr_mode,PK_OBJ_IDT bmch_PK_OBJ_IDT,RIO RIO,RIOINI RIOINI,REJET Rejet,ADR_RMT ADR_RMT,ADR_TIR ADR_TIR,ZBKT bmch_ZBK,AGE_RMT bmtr_AGE,AGE_RMT_LIB AGE_LIB,CPT bmtr_CPT,CPTT bmch_CPT,LOCT bmch_LOC,MEM2 bmtn_lecteur,MNT bmch_MNT,NSER bmch_nser,SQCA bmch_SQCA, RIBT bmch_rib,RSOC_RMT RSOC_RMT,RSOC_TIRE RSOC_TIRE,ZBK_lib ZBK_LIB,NOMTIRE NOMTIRE,CIN CIN,RC RC,lieuEmission LieuEmission,MOTIF1 MOTIF1,MOTIF2 MOTIF2,MOTIF3 MOTIF3,REJET_LIB REJET_LIB,DTREJET DTREJET,DTEPRE DTEPRE,DTEemission DTEemission,DTETRT DTE_TRT,DTE_SORT DTE_SORT,ID_WEBCAPTUR ID_WEBCAPTUR,AGE_SCAN AGE_SCAN,bmtr_nser  FROM r_ncrm_extraction.tmp_tbl_impy_chq_sgma  where PK_OBJ_IDT is not null and DTETRT=:date
#SELECT PK_OBJ_IDT ref, PK_OBJ_IDT, RIO, RIOINI, REJET, ADR_RMT, ADR_TIR,AGE_RMT, AGE_RMT_LIB, CPT, CPTT, DTEemission,DTEREG,  LOCT, MEM2, MNT,  NSER, SQCA, RIBT, RSOC_RMT, RSOC_TIRE, ZBKT, ZBK_lib, NOMTIRE, CIN, RC,lieuEmission, MOTIF1, MOTIF2, MOTIF3, ADR_TIR adresseTire, REJET_LIB,DTREJET, DTEINS, DTEPRE, DTEemission, DTETRT,DTE_SORT,ID_WEBCAPTUR,AGE_SCAN FROM r_ncrm_extraction.tmp_tbl_impy_chq_sgma  where PK_OBJ_IDT is not null and DTETRT=:date
SGMB.OUTFOLDER.IMPCHQ.WC=\\\\172.17.0.151\\Insertions\\
SGMA.JRXML.CRP=/jrxml/sgma/Impayees/CHQ/CRP_CHQ.jasper
SGMA.DELETE.TABLE.IMP.CHQ=delete from r_ncrm_extraction.tmp_tbl_impy_chq_sgma
# LCN 

SGMA.INDIR.CRO.LCN=\\\\172.17.0.4\\Impayes\\SGMB_WebCapture\\LCN\\
SGMA.PATTERN.CROFILE.LCN=([0-9]{3})(.[0-9]{3})(.[0-9]{3})(.160)(.MAD)(.CRO)
SGMA.PATTERN.RECORDCRO.LCN=([0-9]{3})(MAD)(.{26})([0-9]{8})([0-9]{3})(.{3})(.{12})([0-9]{3})(.{32})([0-9]{1})(.{46})$
SGMA.REQ.GETIMP.PROD.LCN=SELECT NSER_REM,SQCA Bmlcn_SQCA,PK_OBJ_IDT bmlcn_PK_OBJ_IDT,CPT AS bmlcn_CPT,LOC AS bmlcn_LOC,ZBK AS bmlcn_ZBK,(SELECT lib FROM r_ncrm_21.tr_banque WHERE bmlcn_ZBK = cde) ZBK_LIB,NSER AS bmlcn_nser, RIB AS bmlcn_rib, MNT AS bmlcn_MNT, AGESG AS bmtr_AGE,(SELECT lib FROM r_ncrm_21.tr_agence WHERE bmtr_AGE = AGE) AGE_LIB, CPTR AS bmtr_CPT, LT AS bmtn_lecteur, rio AS RIOINI,DTEINS AS DTE_TRT,DTE_SORT AS DTE_SORT,DTEEC,ID_WEBCAPTUR AS ID_WEBCAPTUR,AGE_SCAN AS AGE_SCAN,"" NOMTIRE,""  CIN,"" RC,"" RIO,"" lieuEmission, "" Rejet,"" MOTIF1, "" MOTIF2,""  MOTIF3,""  adresseTire,"" ADR_RMT,"" RSOC_RMT, "" RSOC_TIRE, "" REJET_LIB,"" DTEPRE,"" DTREJET, "" DTEINS, "" DTEemission,MODE_REM FROM p_s_sgmb.te_s_sgmb_slcn bmlcn WHERE ((1 = 1) AND FLAG_IMP = '1' and bmlcn.ID_WEBCAPTUR<>0 AND  rio = :RIOINI)
#SELECT PK_OBJ_IDT bmlcn_PK_OBJ_IDT,CPTT AS bmlcn_CPT,LOCT AS bmlcn_LOC,ZBKT AS bmlcn_ZBK,(SELECT lib FROM r_multi_34.tr_banque  WHERE bmlcn_ZBK = cde) ZBK_LIB,NSER AS bmlcn_nser,RIBT AS bmlcn_rib,MNT AS bmlcn_MNT,AGE AS bmtr_AGE,(SELECT  lib FROM r_multi_34.tr_agence_qmb  WHERE bmtr_AGE = AGE) AGE_LIB,CPT AS bmtr_CPT,MEM2 AS bmtn_lecteur,rio AS RIOINI,DTEINS AS DTE_TRT,DTE_SORT AS DTE_SORT,DTEPRE,DTEEC FROM p_s_qmb.te_s_qmb_qmslcn bmlcn WHERE((1 = 1) AND FLAG_IMP = '1' AND rio = :RIOINI);

SGMA.INDIR.IFPCONF.LCN=\\\\172.17.0.4\\Impayes\\SGMB_WebCapture\\
SGMA.PATTERN.IFPCONFFILE.LCN=([0-9]{3})(.[0-9]{3})(.MAD)(.[0-9]{3})(.[0-9]{8}).(ifp|IFP)(.MAILO)
SGMA.PATTERN.RECORDIFP.CONF.LCN=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})(.{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})(.{0,3})
#(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
SGMA.REQ.ADDIMP.LCN=INSERT INTO r_ncrm_extraction.tmp_tbl_impy_lcn_sgma(REF,PK_OBJ_IDT,RIO,RIOINI,REJET,ADR_RMT,ADR_TIR,ZBKT,AGE_RMT,AGE_RMT_LIB,CPT,CPTT,DTEREG,LOCT,MEM2,MNT,NSER,SQCA,RIBT,RSOC_RMT,RSOC_TIRE,ZBK_lib,NOMTIRE,CIN,RC,lieuEmission,MOTIF1,MOTIF2,MOTIF3,REJET_LIB,DTREJET,DTEINS,DTEPRE,DTEemission,DTETRT,DTE_SORT,DTEEC,ID_WEBCAPTUR,AGE_SCAN,NSER_REM,MODE_REM )VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select lib from  editions.tr_rejets_lcn where REJET=? ),?,?,?,?,?,?,?,?,?,?,?);

SGMA.INDIR.IFPIA.LCN=\\\\172.17.0.4\\Impayes\\SGMB_WebCapture\\LCN\\022
SGMA.PATTERN.IFPIAFILE.LCN=([0-9]{3})(.[0-9]{3})(.[0-9]{3})(.[0-9]{3}).MAD.(ifp|IFP)

SGMA.PATTERN.RECORDIFP.IA.LCN=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
SGMA.REQ.GETIMP.PROD.IA.LCN=SELECT NSER_REM,bmlcn.SQCA bmlcn_SQCA,bmlcn.PK_OBJ_IDT bmlcn_PK_OBJ_IDT,bmlcn.CPT AS bmlcn_CPT,bmlcn.LOC AS bmlcn_LOC,bmlcn.ZBK AS bmlcn_ZBK,CPTR AS bmtr_CPT,LT AS bmtn_lecteur,(SELECT lib FROM r_ncrm_21.tr_banque WHERE bmlcn_ZBK = cde) ZBK_LIB,bmlcn.NSER AS bmlcn_nser,bmlcn.RIB AS bmlcn_rib,bmlcn.MNT AS bmlcn_MNT,bmlcn.AGESG AS bmlcn_AGE,(SELECT lib FROM r_ncrm_21.tr_agence WHERE bmlcn_AGE = AGE) AGE_LIB,bmlcn.CPT AS bmlcn_CPT,bmlcn.Lt AS bmlcn_lecteur,bmlcn.rio AS RIOINI,bmlcn.DTEINS AS DTE_TRT,bmlcn.DTE_SORT AS DTE_SORT,bmlcn.DTEEC as DTEEC,bmlcn.ID_WEBCAPTUR AS ID_WEBCAPTUR,bmlcn.AGE_SCAN AS AGE_SCAN,"" NOMTIRE,""  CIN,"" RC,"" RIO,"" lieuEmission, "" Rejet,"" MOTIF1, "" MOTIF2,""  MOTIF3,""  adresseTire,"" ADR_RMT,"" RSOC_RMT, "" RSOC_TIRE, "" REJET_LIB,"" DTEPRE,"" DTREJET, "" DTEINS, "" DTEemission,AGESG bmtr_AGE,MODE_REM FROM (p_s_sgmb.te_s_sgmb_slcn bmlcn) WHERE ((1 = 1) AND FLAG_IMP = '1' and bmlcn.ID_WEBCAPTUR<>0 and bmlcn.zbk=:ZBKT  and bmlcn.nser=:NSER  and bmlcn.mnt=:mnt and bmlcn.DTE_SORT=:DTESORT)
SGMA.REQ.COUNT.IMP.LCN=SELECT ZBKT ZBK,ZBK_lib,DTEINS as DTE,count(*) as CountVal, DTE_SORT dteSort FROM r_ncrm_extraction.tmp_tbl_impy_lcn_sgma where nser is not null and DTEINS is not null group by zbk order by DTEINS

SGMA.FOLDER.OUT.IMP.LCN=\\\\172.17.0.151\\Sorties\\SGMA\\NCRM_EXTRACTIONS\\CSVIMP
SGMA.REQ.DATA.IMP.LCN=select MODE_REM,NSER_REM,PK_OBJ_IDT bmlcn_PK_OBJ_IDT,RIO RIO,RIOINI RIOINI,REJET Rejet,ADR_RMT ADR_RMT,ADR_TIR adresseTire,AGE_RMT bmtr_AGE,AGE_RMT_LIB AGE_LIB,CPT bmtr_CPT,CPTT bmlcn_CPT,LOCT bmlcn_LOC,MEM2 bmtn_lecteur,MNT bmlcn_MNT,NSER bmlcn_nser,SQCA bmlcn_SQCA,RIBT bmlcn_rib,RSOC_RMT RSOC_RMT,RSOC_TIRE RSOC_TIRE,ZBKT bmlcn_ZBK,ZBK_lib ZBK_LIB,NOMTIRE NOMTIRE,CIN CIN,RC RC,lieuEmission lieuEmission,MOTIF1 MOTIF1,MOTIF2 MOTIF2,MOTIF3 MOTIF3,REJET_LIB REJET_LIB,DTREJET DTREJET,DTEINS DTEINS,DTEPRE DTEPRE,DTEemission DTEemission,DTETRT DTE_TRT,DTE_SORT DTE_SORT,dteec DTEEC,ID_WEBCAPTUR ID_WEBCAPTUR,AGE_SCAN AGE_SCAN FROM r_ncrm_extraction.tmp_tbl_impy_lcn_sgma  where PK_OBJ_IDT is not null and dte_sort=:date
SGMB.OUTFOLDER.IMPLCN.WC=\\\\172.17.0.151\\Insertions\\
SGMA.JRXML.ANP=/jrxml/sgma/Impayees/LCN/ANP_LCN.jasper

SGMA.DELETE.TABLE.IMP.LCN=delete from r_ncrm_extraction.tmp_tbl_impy_lcn_sgma
SGMA.REQ.COUNTDATAPAYE.LCN=SELECT count(distinct (dteins)) countValues FROM p_s_sgmb.te_s_sgmb_slcn where DTEINS =:Date

SGMA.REQ.ALL.PCAPT=SELECT idPcapt as  idpcapt, cdePcapt cdePcapt , Lib as nomPcapt, type as Type, active, cdeAge as ageRattachement,secteur,circuit FROM r_ncrm_extraction.te_pcapt where active=1 and cdeBq='022'
SGMA.REQ.PCAPT.CDE=SELECT idPcapt as  idpcapt, cdePcapt cdePcapt , Lib as nomPcapt, type as Type, active, cdeAge as ageRattachement,secteur,circuit FROM r_ncrm_extraction.te_pcapt where active=1 and cdeBq='022' and cdePcapt in (:cde)
SGMA.REQ.ADD.NEW.PCAPT=INSERT INTO r_ncrm_extraction.te_pcapt(cdePcapt,Lib,type,active,cdeAge,secteur,circuit,cdeBq)VALUES(?,?,?,1,?,?,?,'022');
SGMA.REQ.UPDATE.PCAPT=Update r_ncrm_extraction.te_pcapt set cdePcapt=?,Lib=?,type=?,cdeAge=?,secteur=?,circuit=? where idpcapt=? and cdeBq='022'
SGMA.REQ.DELETE.PCAPT=delete from r_ncrm_extraction.te_pcapt where idpcapt=?  and cdeBq='022'
SGMA.REQ.ALL.CIRCUIT=SELECT idPcapt as  idpcapt, cdePcapt cdePcapt , Lib as nomPcapt, type as Type, active, cdeAge as ageRattachement,secteur,circuit FROM r_ncrm_extraction.te_pcapt where (circuit is not null and circuit<>"") and active=1 and cdeBq='022' group by circuit

SGMA.REQ.TRT.CHQ=SELECT idT,nom_Traitement, Description, DossierEnre,Destinataire,active FROM r_ncrm_extraction.te_traitement where idt in(1,2,3) and active=1;
SGMA.REQ.TRT.LCN=SELECT idT,nom_Traitement, Description, DossierEnre,Destinataire,active FROM r_ncrm_extraction.te_traitement where idt in(7,8,9) and active=1;

SGMA.REQ.TRT.IMP.CHQ=SELECT idT,nom_Traitement, Description, DossierEnre,Destinataire,active FROM r_ncrm_extraction.te_traitement where idt in(4,5,6) and active=1;
SGMA.REQ.TRT.IMP.LCN=SELECT idT,nom_Traitement, Description, DossierEnre,Destinataire,active FROM r_ncrm_extraction.te_traitement where idt in(10,11) and active=1;

SGMA.REQ.TRT.CDE=SELECT idT,nom_Traitement, Description, DossierEnre,Destinataire,active FROM r_ncrm_extraction.te_traitement  where nom_Traitement in (:nom_Traitement)
SGMA.REQ.REPORT.IDTRT=SELECT idR,Id_report, descreption, modeleJRXML,typeGeneration,active,idT FROM r_ncrm_extraction.te_report where idT=:idT and active=1




#######################################################################################################################################
				  # CFG #
#######################################################################################################################################
CFG.FOLDER.IN.CLASSIFY.PAYEE.CHQ=\\\\172.17.0.6\\Insertions\\
CFG.OUT.REC.SUIVI.CHQ=\\\\172.17.0.6\\ChqToExtract\\SGMB\\SUIVI_PHYSIQUE\\CFG
CFG.FOLDER.OUT.CLASSIFY.PAYEE.CHQ=\\\\172.17.0.6\\ChqToExtract\\
CFG.DEFAULT.POCHE.CHQ=23
CFG.PATTERN.FILE.IN.CLASSIFY.PAYEE.CHQ=(CHQ_CFG)_([0-9]{8})(\.txt)$
CFG.REQ.PURGE.TABLE.CHQ=DELETE FROM r_ncrm_extraction.cfg_paid_chq;
CFG.REQ.GET.ALL.VALUE.CHQ=SELECT zbk,loc,nser,cpt,rib,'' conf,'' ope_eta,'' impy,'' RDelta,'' dteec,(SELECT poche FROM r_ncrm_extraction.cfg_poche_affectation where zbk=c.zbk group by zbk) poche FROM r_ncrm_extraction.cfg_paid_chq c ORDER BY nser;
CFG.REQ.GET.COUNT.VALUE.CHQ=select dteTrt DTE,zbk,count(*) CountVal from r_ncrm_extraction.cfg_paid_chq group by zbk,dteTrt order by zbk;

CFG.FOLDER.IN.CLASSIFY.PAYEE.LCN=\\\\172.17.0.4\\Insertions\\
CFG.OUT.REC.SUIVI.LCN=\\\\172.17.0.6\\ChqToExtract\\BMCI\\
CFG.FOLDER.OUT.CLASSIFY.PAYEE.LCN=\\\\172.17.0.6\\ChqToExtract\\BMCI\\
CFG.DEFAULT.POCHE.LCN=23
CFG.PATTERN.FILE.IN.CLASSIFY.PAYEE.LCN=(LCN_CFG)_([0-9]{8})(\.txt)$
CFG.REQ.PURGE.TABLE.LCN=DELETE FROM r_ncrm_extraction.cfg_paid_lcn;
CFG.REQ.GET.ALL.VALUE.LCN=SELECT zbk,loc,nser,cpt,rib,'' conf,'' ope_eta,'' impy,'' RDelta,'' dteec,(SELECT poche FROM r_ncrm_extraction.cfg_poche_affectation where zbk=c.zbk group by zbk) poche FROM r_ncrm_extraction.cfg_paid_lcn c ORDER BY nser;
CFG.REQ.GET.COUNT.VALUE.LCN=select dteTrt DTE,zbk,count(*) CountVal from r_ncrm_extraction.cfg_paid_lcn group by zbk,dteTrt order by zbk;

#######################################################################################################################################
				#BAA#
#######################################################################################################################################



BAA.cde.bq=045


#####################################################################################
# CHQ #
#####################################################################################
### ETA CHQ

BAA.FOLDER.ETA.CHQ=G\:\\Sorties\\BAA\\ETA
BAA.REQ.DATA.CHQ=SELECT bmch.pk_obj_idt AS bmch_pk_obj_idt,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,age_r.Lib age_r_lib,bmtn.OPE_ETA AS bmtn_OPE_ETA,bmtn.Ano AS bmtn_ANO,'' AS bmtn_CDEBPR,bmtn.COUNT_CHQ AS bmtn_COUNT_CHQ,bmtn.DIFF AS bmtn_DIFF,bmtn.DIFF_NB AS bmtn_DIFF_NB,bmtn.LECTEUR AS bmtn_LECTEUR,bmtn.LECTEUR AS bmtn_MEM2,bmtn.SUM_CHQ AS bmtn_SUM_CHQ,bmta.OPE_ETA AS bmta_OPE_ETA,bmta.Ano AS bmta_Ano,bmta.zbk AS bmta_CDEBPR,'' AS bmta_MEM2,bmta.SQCA AS bmta_SQCA,bmtr.NSER AS bmtr_NSER,bmtr.LECTEUR AS bmtr_MEM2,bmtr.MNT AS bmtr_MNT,bmtr.CPT AS bmtr_CDECLT,bmtr.NBCH + 0 AS bmtr_NBCH,bmtr.MODE AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA + 0 AS bmtr_SQCA,bmtr.AGE AS bmtr_AGE_RMT,'' AS bmtr_TIERS,bmtr.REFERENCE AS bmtr_REFCLI,bmtr.ANO AS bmtr_ANO,bmch.FK_OPE_MNE AS bmch_fk_ope_mne,bmch.INSTANCE AS bmch_instance,bmch.OPE_ETA AS bmch_ope_eta,'' AS bmch_ADR_RMT,'' AS bmch_ADR_TIR,bmch.AGRMT AS bmch_AGE,'' AS bmch_CDEBPR,'' AS bmch_CDE_REJ,bmch.CPT AS bmch_CPT,bmch.CPT AS bmch_CPT2,bmch.DBL AS bmch_DBLT,bmch.DTEMI AS bmch_DTEEMI,bmch.FLAG_IMP AS bmch_FLAG_IMP,bmch.FLAG_REJET AS bmch_FLAG_REJET,'' AS bmch_FLAG_AVAL,bmch.LOC AS bmch_LOC,'' AS bmch_MEM2,(bmch.MNT + 0) AS bmch_MNT,bmch.NSER AS bmch_NSER,bmch.RIB AS bmch_RIB,bmch.RIO AS bmch_RIO,'' AS bmch_RSOC_TIR,(bmch.SQCA + 0) AS bmch_SQCA,bmch.ZBK AS bmch_ZBK,(SELECT bq.lib FROM r_baa_1.tr_banque bq WHERE bmch.ZBK = bq.CDE) AS bq_lib,bmch.ZIB AS bmch_ZIB,bmch.Ano AS bmch_ANO,bmch.VICE AS bmch_VICE,bmch.CONF AS bmch_CONF,bmch.DTEMI AS bmch_DTEINV,bmch.AGRMT AS bmch_AGE_RMT FROM(((((((p_baaa.te_baaa_sch bmch JOIN p_baaa.te_obj obj_bmch)JOIN p_baaa.te_baaa_str bmtr)JOIN p_baaa.te_obj obj_bmtr)JOIN p_baaa.te_baaa_sta bmta)JOIN p_baaa.te_baaa_stn bmtn)JOIN p_baaa.te_baaa_ins ins)JOIN r_baa_1.tr_agence age_r) WHERE((1 = 1)AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmch.INSTANCE)AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)AND (age_r.AGE = bmtr.AGE))AND ins.date = 
BAA.REQ.COUNTDATA.CHQ=SELECT COUNT(*) countValues FROM p_baaa.te_baaa_sch ch,p_baaa.te_baaa_ins ins WHERE ins.instance = ch.instance and date=:Date
BAA.REQ.DATA.PCAPT=SELECT  sc.CDESCANNER, age.AGE, sc.TYPE, age.LIB FROM r_baa_1.tr_scanner_baa sc,r_baa_1.tr_agence age where age.age=sc.age
BAA.REQ.GETLBLANO.CHQ=SELECT tr_ano.ANO_LIB AS ANO_LIB  FROM r_baa_1.tr_ano where PK_ANO_MNE=:PK_ANO_MNE


### IMP CHQ

BAA.INDIR.CRO.CHQ=G\:\\Impayes\\BAA\\CHQ\\IN\\
BAA.PATTERN.CROFILE.CHQ=([0-9]{3})(.[0-9]{3})(.[0-9]{3})(.131)(.MAD)(.CRO).succes$
BAA.PATTERN.RECORDCRO.CHQ=([0-9]{3})(MAD)(.{26})([0-9]{8})(131)(.{3})(.{12})([0-9]{3})(.{32})([0-1]{1})(.{46})$
#([0-9]{3})(MAD)(.{26})([0-9]{8})([0-9]{3})(.{3})(.{12})([0-9]{3})(.{32})([0-9]{1})(.{46})$
BAA.REQ.GETIMP.PROD.CHQ=SELECT bmch.PK_OBJ_IDT bmch_PK_OBJ_IDT,bmch.CPT AS bmch_CPT,bmch.LOC AS bmch_LOC,bmch.ZBK AS bmch_ZBK,(SELECT lib FROM r_baa_1.tr_banque WHERE bmch_ZBK = cde) ZBK_LIB,bmch.NSER AS bmch_nser,bmch.RIB AS bmch_rib,bmch.MNT AS bmch_MNT,bmtr.AGE AS bmtr_AGE,(SELECT lib FROM r_baa_1.tr_agence WHERE bmtr_AGE = AGE) AGE_LIB,bmtr.CPT AS bmtr_CPT,bmtn.LECTEUR AS bmtn_lecteur,bmch.rio AS RIOINI,bmch.SQCA AS bmch_SQCA,ins.DATE AS DTE_TRT,bmch.DTE_SORT AS DTE_SORT FROM((((((p_baaa.te_baaa_sch bmch JOIN p_baaa.te_obj obj_bmch)JOIN p_baaa.te_baaa_str bmtr)JOIN p_baaa.te_obj obj_bmtr)JOIN p_baaa.te_baaa_ins ins)JOIN p_baaa.te_baaa_sta bmta)JOIN p_baaa.te_baaa_stn bmtn)WHERE((1 = 1)AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT)AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmch.INSTANCE)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)AND FLAG_IMP = '1' AND bmch.rio = :RIOINI);

BAA.INDIR.IFPCONF.CHQ=G\:\\Impayes\\BAA\\
BAA.PATTERN.IFPCONFFILE.CHQ=([0-9]{3})(.[0-9]{3})(.MAD)(.[0-9]{3})(.[0-9]{8}).(ifp|IFP)(.*)
BAA.PATTERN.RECORDIFP.CONF.CHQ=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
BAA.REQ.ADDIMP.CHQ=INSERT INTO r_ncrm_extraction.ta_imp_chq_baa(REF,PK_OBJ_IDT,RIO,RIOINI,REJET,ADR_RMT,ADR_TIR,ZBK,AGE_RMT,AGE_RMT_LIB,CPT,CPTT,DTEREG,LOCT,MEM2,MNT,NSER,SQCA,RIB,RSOC_RMT,RSOC_TIRE,ZBK_lib,NOMTIRE,CIN,RC,lieuEmission,MOTIF1,MOTIF2,MOTIF3,REJET_LIB,DTREJET,DTEINS,DTEPRE,DTEemission,DTETRT,DTE_SORT)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select lib from  editions.tr_rejets where REJET=? ),?,?,?,?,?,?);

BAA.INDIR.IFPIA.CHQ=G\:\\Impayes\\BAA\\CHQ\\IN\\045
BAA.PATTERN.IFPIAFILE.CHQ=([0-9]{3})(.[0-9]{8})(.IA).(ifp|IFP)
BAA.PATTERN.RECORDIFP.IA.CHQ=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})0([0-9]{7})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
BAA.REQ.GETIMP.PROD.IA.CHQ=SELECT bmch.PK_OBJ_IDT bmch_PK_OBJ_IDT,bmch.CPT AS bmch_CPT,bmch.LOC AS bmch_LOC,bmch.ZBK AS bmch_ZBK,(SELECT lib FROM r_baa_1.tr_banque WHERE bmch_ZBK = cde) ZBK_LIB,bmch.NSER AS bmch_nser,bmch.RIB AS bmch_rib,bmch.MNT AS bmch_MNT,bmtr.AGE AS bmtr_AGE,(SELECT lib FROM r_baa_1.tr_agence WHERE bmtr_AGE = AGE) AGE_LIB,bmtr.CPT AS bmtr_CPT,bmtn.LECTEUR AS bmtn_lecteur,bmch.rio AS RIOINI,bmch.SQCA AS bmch_SQCA,ins.DATE AS DTE_TRT,bmch.DTE_SORT AS DTE_SORT FROM((((((p_baaa.te_baaa_sch bmch JOIN p_baaa.te_obj obj_bmch)JOIN p_baaa.te_baaa_str bmtr)JOIN p_baaa.te_obj obj_bmtr)JOIN p_baaa.te_baaa_ins ins)JOIN p_baaa.te_baaa_sta bmta)JOIN p_baaa.te_baaa_stn bmtn)WHERE((1 = 1)AND (bmch.PK_OBJ_IDT = obj_bmch.PK_OBJ_IDT)AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmch.INSTANCE)AND (bmtr.PK_OBJ_IDT = (obj_bmch.FK_OBJMAI_IDT + 1))AND (obj_bmch.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmch.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)AND FLAG_IMP = '1' AND  bmch.zbk=:ZBKT and bmch.loc=:LOCT and bmch.cpt=:CPTT and bmch.rib=:RIBT and bmch.nser=:NSER and (ins.date=:DTETRT)) ;

BAA.REQ.COUNT.IMP.CHQ=SELECT ZBK,ZBK_lib,DTETRT as DTE,count(*) as CountVal FROM r_ncrm_extraction.ta_imp_chq_baa  where nser is not null and DTETRT is not null group by zbk

BAA.FOLDER.OUT.IMP.CHQ=G\:\\Sorties\\BAA\\ETA
BAA.REQ.DATA.IMP.CHQ=SELECT ta_imp_chq_bpm.REF,ta_imp_chq_bpm.PK_OBJ_IDT,ta_imp_chq_bpm.RIO,ta_imp_chq_bpm.RIOINI,ta_imp_chq_bpm.REJET,ta_imp_chq_bpm.ADR_RMT,ta_imp_chq_bpm.ADR_TIR,ta_imp_chq_bpm.CDEBPR,ta_imp_chq_bpm.CDEBPR_RMT,ta_imp_chq_bpm.AGE,ta_imp_chq_bpm.AGE_RMT,ta_imp_chq_bpm.AGE_RMT_LIB,ta_imp_chq_bpm.CPT,ta_imp_chq_bpm.CPTT,ta_imp_chq_bpm.DTEMI,ta_imp_chq_bpm.DTEREG,ta_imp_chq_bpm.LOC,ta_imp_chq_bpm.LOCT,ta_imp_chq_bpm.MEM2,ta_imp_chq_bpm.MNT,ta_imp_chq_bpm.MODE_ESC,ta_imp_chq_bpm.NSER,ta_imp_chq_bpm.SQCA,ta_imp_chq_bpm.RIB,ta_imp_chq_bpm.RIBR,ta_imp_chq_bpm.RSOC_RMT,ta_imp_chq_bpm.RSOC_TIRE,ta_imp_chq_bpm.RSOC_BEN,ta_imp_chq_bpm.ZBK,ta_imp_chq_bpm.ZBK_lib,ta_imp_chq_bpm.NOMTIRE,ta_imp_chq_bpm.CIN,ta_imp_chq_bpm.RC,ta_imp_chq_bpm.lieuEmission,ta_imp_chq_bpm.MOTIF1,ta_imp_chq_bpm.MOTIF2,ta_imp_chq_bpm.MOTIF3,ta_imp_chq_bpm.adresseTire,ta_imp_chq_bpm.REJET_LIB,ta_imp_chq_bpm.DTREJET,ta_imp_chq_bpm.DTEINS,ta_imp_chq_bpm.DTEPRE,ta_imp_chq_bpm.DTEemission,ta_imp_chq_bpm.DTETRT FROM r_ncrm_extraction.ta_imp_chq_baa ta_imp_chq_bpm where ta_imp_chq_bpm.PK_OBJ_IDT is not null and DTETRT=


#####################################################################################
# LCN #
#####################################################################################


#### SI LCN

BAA.REQ.GETCOUNT.REM.LCN=select count(distinct (nsersg)) AS nbrRemise FROM p_l_baaa.te_l_baaa_rl tr,p_l_baaa.te_l_baaa_ins ins where tr.INSTANCE=ins.INSTANCE and tr.OPE_ETA<>'D' and ins.date=:Date
BAA.REQ.GETCOUNTANDSUMMNT.LCN= select count(*) AS NBRLCN, Format(sum(lcn.mnt),2) MNTLCN FROM p_l_baaa.te_l_baaa_lcn lcn,p_l_baaa.te_l_baaa_ins ins where lcn.INSTANCE=ins.INSTANCE and lcn.OPE_ETA<>'D' and ins.date=:Date
BAA.REQ.GETREMTRAITED.LCN=SELECT STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,bmtr.pk_obj_idt AS bmtr_pk_obj_idt,bmtr.NSERSG AS bmtr_NSER,bmtr.LECTEUR AS bmtr_MEM2,bmtr.CPTSG AS bmtr_CDECLT,bmtr.MNT AS bmtr_MNTDECL,bmtr.NBCH + 0 AS bmtr_NBCH,bmtr.MODE AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA + 0 AS bmtr_SQCA,(select Age from r_baa_1.tr_cpt_baa where cpt=bmtr.CPTSG) AS bmtr_AGE_RMT,bmtr.REFERENCE AS bmtr_REFCLI,FORMAT(SUM(bmlcn.mnt), 2) bmtr_MNTREEL FROM((((((p_l_baaa.te_l_baaa_lcn bmlcn JOIN p_l_baaa.te_obj obj_bmlcn)JOIN p_l_baaa.te_l_baaa_rl bmtr)JOIN p_l_baaa.te_obj obj_bmtr)JOIN p_l_baaa.te_l_baaa_ll bmta)JOIN p_l_baaa.te_l_baaa_tl bmtn)JOIN p_l_baaa.te_l_baaa_ins ins)WHERE((1 = 1)AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmlcn.INSTANCE)AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT + 1))AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)AND (DATE = :Date)AND bmtr.OPE_ETA <> 'D'AND bmlcn.OPE_ETA <> 'D')GROUP BY bmtr.nserSG;
BAA.REQ.GETVALUETRAITED.LCN=SELECT bmlcn.vice bmlcn_vice,bmlcn.conf bmlcn_conf,bmlcn.sign bmlcn_sign,bmtr.nsersg bmtr_nser,bmlcn.pk_obj_idt bmlcn_pk_obj_idt,(bmlcn.SQCA + 0) AS bmlcn_SQCA,bmlcn.NSER AS bmlcn_NSER,bmlcn.ZBK AS bmlcn_ZBK,bmlcn.LOC AS bmlcn_LOC,bmlcn.CPT AS bmlcn_CPT,bmlcn.RIB AS bmlcn_RIB,(bmlcn.MNT) AS bmlcn_MNT,bmlcn.NOM_TIREUR bmlcn_cde_NOM_TIREUR,bmlcn.DTECRE AS bmlcn_DTECRE,bmlcn.DTEEC2 AS bmlcn_DTEEC,bmlcn.cdeAval bmlcn_cdeAval,bmlcn.CODE_STATUS bmlcn_CODE_STATUS,bmlcn.DTEMI AS bmlcn_DTEEMI,bmlcn.ope_eta bmlcn_ope_eta,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE FROM((((((p_l_baaa.te_l_baaa_lcn bmlcn JOIN p_l_baaa.te_obj obj_bmlcn)JOIN p_l_baaa.te_l_baaa_rl bmtr)JOIN p_l_baaa.te_obj obj_bmtr)JOIN p_l_baaa.te_l_baaa_ll bmta)JOIN p_l_baaa.te_l_baaa_tl bmtn)JOIN p_l_baaa.te_l_baaa_ins ins)WHERE((1 = 1)AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmlcn.INSTANCE)AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT + 1))AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)AND (bmlcn.ope_eta<>'D' )and ( bmtr.pk_obj_idt = :pk_obj_id_Rem)AND ins.date = :Date);

BAA.OUTDIR.SI.LCN=G\:\\Sorties\\L_BAA\\SI
#\\\\172.16.0.6\\Sorties\\L_BPM\\SI
BAA.PATTERN.RECORDREM.SILCN=([0-9]{8})([0-9]{6})(RE)(0)(0)(.{12})([0-9]{7})([1-3]{1})([0-9]{24})([0-9]{17},[0-9]{2})(.{98})
BAA.PATTERN.RECORDLCN.SILCN=([0-9]{8})([0-9]{6})(LC)(0)(0)(.{12})([0-9]{7})(.{1})([0-9]{24})([0-9]{17},[0-9]{2})(.{35})(060)([0-9]{8})([0-9]{8})([0-1]{1})([1-6]{1})(.{4})(.{4})(.{4})(.{30})

#### ETA 

BAA.FOLDER.ETA.LCN=G\:\\Sorties\\BAA\\ETA
BAA.REQ.COUNTDATA.LCN=SELECT COUNT(*) countValues FROM p_l_baaa.te_l_baaa_lcn l, p_l_baaa.te_l_baaa_ins ins WHERE ins.instance= l.instance and date=:Date
BAA.REQ.DATA.LCN=SELECT bmlcn.pk_obj_idt AS bmlcn_pk_obj_idt,STR_TO_DATE(ins.DATE, '%Y-%m-%d') AS DATE,age_r.Lib age_r_lib,(SELECT bq.lib FROM r_baa_1.tr_banque bq WHERE bmlcn.ZBK = bq.CDE) AS bq_lib,bmtn.OPE_ETA AS bmtn_OPE_ETA,bmtn.Ano AS bmtn_ANO,'' AS bmtn_CDEBPR,bmtn.COUNT_CHQ AS bmtn_COUNT_CHQ,bmtn.DIFF AS bmtn_DIFF,bmtn.DIFF_NB AS bmtn_DIFF_NB,bmtn.LECTEUR AS bmtn_LECTEUR,bmtn.LECTEUR AS bmtn_MEM2,bmtn.SUM_CHQ AS bmtn_SUM_CHQ,bmta.OPE_ETA AS bmta_OPE_ETA,bmta.zbk AS bmta_CDEBPR,'' AS bmta_MEM2,bmta.SQCA AS bmta_SQCA,bmtr.NSERSG AS bmtr_NSER,bmtr.LECTEUR AS bmtr_MEM2,bmtr.MNT AS bmtr_MNT,bmtr.CPTSG AS bmtr_CDECLT,bmtr.NBCH + 0 AS bmtr_NBCH,bmtr.MODE AS bmtr_MODE_ESC,bmtr.OPE_ETA AS bmtr_OPE_ETA,bmtr.SQCA + 0 AS bmtr_SQCA,bmtr.AGESG AS bmtr_AGE_RMT,'' AS bmtr_TIERS,bmtr.REFERENCE AS bmtr_REFCLI,bmtr.ANO AS bmtr_ANO,bmlcn.FK_OPE_MNE AS bmlcn_fk_ope_mne,bmlcn.INSTANCE AS bmlcn_instance,bmlcn.OPE_ETA AS bmlcn_ope_eta,'' AS bmlcn_ADR_RMT,'' AS bmlcn_ADR_TIR,bmlcn.AGE_SCAN AS bmlcn_AGE,'' AS bmlcn_CDEBPR,bmlcn.CDE_REJ AS bmlcn_CDE_REJ,bmlcn.CPT AS bmlcn_CPT,bmlcn.CPT AS bmlcn_CPT2,bmlcn.DBL AS bmlcn_DBLT,bmlcn.DTEMI AS bmlcn_DTEEMI,bmlcn.FLAG_REJET AS bmlcn_FLAG_REJET,'' AS bmlcn_FLAG_AVAL,bmlcn.LOC AS bmlcn_LOC,bmlcn.LECTEUR AS bmlcn_MEM2,(bmlcn.MNT + 0) AS bmlcn_MNT,bmlcn.NSER AS bmlcn_NSER,bmlcn.RIB AS bmlcn_RIB,bmlcn.NOM_TIREUR AS bmlcn_RSOC_TIR,(bmlcn.SQCA + 0) AS bmlcn_SQCA,bmlcn.ZBK AS bmlcn_ZBK,bmlcn.ZIB AS bmlcn_ZIB,bmlcn.Ano AS bmlcn_ANO,bmlcn.CONF AS bmlcn_CONF,bmlcn.VICE AS bmlcn_VICE,bmlcn.AGE_RMT AS bmlcn_AGE_RMT FROM(((((((p_l_baaa.te_l_baaa_lcn bmlcn JOIN p_l_baaa.te_obj obj_bmlcn)JOIN p_l_baaa.te_l_baaa_rl bmtr)JOIN p_l_baaa.te_obj obj_bmtr)JOIN p_l_baaa.te_l_baaa_ll bmta)JOIN p_l_baaa.te_l_baaa_tl bmtn)JOIN p_l_baaa.te_l_baaa_ins ins)JOIN r_baa_1.tr_agence age_r) WHERE ((1 = 1)AND (ins.INSTANCE = bmtn.INSTANCE)AND (ins.INSTANCE = bmtr.INSTANCE)AND (ins.INSTANCE = bmta.INSTANCE)AND (ins.INSTANCE = bmlcn.INSTANCE)AND (bmlcn.PK_OBJ_IDT = obj_bmlcn.PK_OBJ_IDT)AND (bmtr.PK_OBJ_IDT = (obj_bmlcn.FK_OBJMAI_IDT + 1))AND (obj_bmlcn.FK_OBJMAI_IDT = obj_bmtr.PK_OBJ_IDT)AND (bmta.PK_OBJ_IDT = obj_bmtr.FK_OBJMAI_IDT)AND (obj_bmlcn.FK_OBJMAI_IDT = bmtn.PK_OBJ_IDT)AND (age_r.AGE = bmtr.AGESG))AND ins.DATE =
BAA.REQ.GETLBLANO.LCN=SELECT tr_ano.ANO_LIB AS ANO_LIB  FROM r_baa_1.tr_ano where PK_ANO_MNE=:PK_ANO_MNE



# IMP LCN

BAA.INDIR.CRO.LCN=G\:\\Impayes\\BAA\\LCN\\IN\\
BAA.PATTERN.CROFILE.LCN=([0-9]{3})(.[0-9]{3})(.[0-9]{3})(.160)(.MAD)(.CRO).succes$
BAA.PATTERN.RECORDCRO.LCN=([0-9]{3})(MAD)(.{26})([0-9]{8})([0-9]{3})(.{3})(.{12})([0-9]{3})(.{32})([0-9]{1})(.{46})$
BAA.REQ.GETIMP.PROD.LCN=SELECT PK_OBJ_IDT bmlcn_PK_OBJ_IDT,CPT AS bmlcn_CPT,LOC AS bmlcn_LOC,ZBK AS bmlcn_ZBK,(SELECT lib FROM r_baa_1.tr_banque WHERE bmlcn_ZBK = cde) ZBK_LIB,NSER AS bmlcn_nser,RIB AS bmlcn_rib,MNT AS bmlcn_MNT,AGE_RMT AS bmtr_AGE,(SELECT lib FROM r_baa_1.tr_agence WHERE bmtr_AGE = AGE) AGE_LIB,CPT AS bmtr_CPT, LT AS bmtn_lecteur, rio AS RIOINI,DTEINS AS DTE_TRT,DTE_SORT AS DTE_SORT,'0' DTEPRE,DTEEC FROM p_s_baa.te_s_baa_slcn bmlcn WHERE ((1 = 1) AND FLAG_IMP = '1' AND rio = :RIOINI);

BAA.INDIR.IFPCONF.LCN=G\:\\Impayes\\BAA\\
BAA.PATTERN.IFPCONFFILE.LCN=([0-9]{3})(.[0-9]{3})(.MAD)(.[0-9]{3})(.[0-9]{8}).(ifp|IFP)(.*)
BAA.PATTERN.RECORDIFP.CONF.LCN=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{24})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})

BAA.INDIR.IFPIA.LCN=G\:\\Impayes\\BAA\\LCN\\IN\\045
BAA.PATTERN.IFPIAFILE.LCN=([0-9]{8})(\\.CNP\\.TXT).*
BAA.PATTERN.RECORDIFP.IA.LCN=(^[0-9]{3})([0-9]{3})(.{3})([0-9]{3})([0-9]{3})([0-9]{16})([0-9]{2})(.{32})(.{32})([0-9]{3})(.{50})(.{10})(.{20})([0-9]{7})([0-9]{15})(.{20})([0-9]{8})([0-9]{8})(.{3})(.{3})(.{3})(.{100})
BAA.REQ.GETIMP.PROD.IA.LCN=SELECT PK_OBJ_IDT bmlcn_PK_OBJ_IDT,CPT AS bmlcn_CPT,LOC AS bmlcn_LOC,ZBK AS bmlcn_ZBK,(SELECT lib FROM r_baa_1.tr_banque WHERE bmlcn_ZBK = cde) ZBK_LIB,NSER AS bmlcn_nser,RIB AS bmlcn_rib,MNT AS bmlcn_MNT,AGE_RMT AS bmtr_AGE,(SELECT lib FROM r_baa_1.tr_agence WHERE bmtr_AGE = AGE) AGE_LIB,CPT AS bmtr_CPT, LT AS bmtn_lecteur, rio AS RIOINI,DTEINS AS DTE_TRT,DTE_SORT AS DTE_SORT,'0' DTEPRE,DTEEC FROM p_s_baa.te_s_baa_slcn bmlcn WHERE ((1 = 1) AND FLAG_IMP = '1'  AND zbk = :ZBKT AND loc = :LOCT AND cpt = :CPTT AND rib = :RIBT AND nser = :NSER  AND (DTEINS = :DTESORT);
BAA.REQ.ADDIMP.LCN=INSERT INTO r_ncrm_extraction.ta_imp_lcn_baa(REF,PK_OBJ_IDT,RIO,RIOINI,REJET,ADR_RMT,ADR_TIRE,ZBK,AGE_RMT,AGE_RMT_LIB,CPT,CPTT,LOCT,MEM2,MNT,NSER,RIBT,RSOC_RMT,RSOC_TIRE,ZBK_lib,NOMTIRE,CIN,RC,lieuEmission,MOTIF1,MOTIF2,MOTIF3,REJET_LIB,DTREJET,DTEINS,DTEPRE,DTEemission,DTE_SORT,DTEEC)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select lib from  editions.tr_rejets_lcn where REJET=? ),?,?,?,?,?,?);
BAA.REQ.COUNT.IMP.LCN=SELECT ZBK,ZBK_lib,DTEINS as DTE,count(*) as CountVal FROM r_ncrm_extraction.ta_imp_lcn_baa where nser is not null and DTEINS is not null group by zbk



BAA.FOLDER.OUT.IMP.LCN=G\:\\Sorties\\BAA\\ETA
BAA.REQ.DATA.IMP.LCN=SELECT ta_imp_lcn_qmb.REF,ta_imp_lcn_qmb.PK_OBJ_IDT,ta_imp_lcn_qmb.RIO,ta_imp_lcn_qmb.RIOINI,ta_imp_lcn_qmb.REJET,ta_imp_lcn_qmb.ADR_RMT,ta_imp_lcn_qmb.ADR_TIRE,ta_imp_lcn_qmb.CDEBPR,ta_imp_lcn_qmb.CDEBPR_RMT,ta_imp_lcn_qmb.AGE,ta_imp_lcn_qmb.AGE_RMT,ta_imp_lcn_qmb.AGE_RMT_LIB,ta_imp_lcn_qmb.CPT,ta_imp_lcn_qmb.CPTT,ta_imp_lcn_qmb.DTEEC,ta_imp_lcn_qmb.DTEMI,ta_imp_lcn_qmb.DTREG,ta_imp_lcn_qmb.LOC,ta_imp_lcn_qmb.LOCT,ta_imp_lcn_qmb.MEM2,ta_imp_lcn_qmb.MNT,ta_imp_lcn_qmb.MODE_ESC,ta_imp_lcn_qmb.NSER,ta_imp_lcn_qmb.RIB,ta_imp_lcn_qmb.RIBT,ta_imp_lcn_qmb.RSOC_RMT,ta_imp_lcn_qmb.RSOC_TIRE,ta_imp_lcn_qmb.RSOC_BEN,ta_imp_lcn_qmb.ZBK,ta_imp_lcn_qmb.ZBK_lib,ta_imp_lcn_qmb.NOMTIRE,ta_imp_lcn_qmb.CIN,ta_imp_lcn_qmb.RC,ta_imp_lcn_qmb.lieuEmission,ta_imp_lcn_qmb.MOTIF1,ta_imp_lcn_qmb.MOTIF2,ta_imp_lcn_qmb.MOTIF3,ta_imp_lcn_qmb.adresseTire,ta_imp_lcn_qmb.REJET_LIB,ta_imp_lcn_qmb.DTREJET,ta_imp_lcn_qmb.DTEINS,ta_imp_lcn_qmb.DTEPRE,ta_imp_lcn_qmb.DTEemission FROM r_ncrm_extraction.ta_imp_lcn_baa ta_imp_lcn_qmb where ta_imp_lcn_qmb.PK_OBJ_IDT is not null and DTEINS=





BAA.REQ.GETALL.AGENCE=SELECT AGE,LIB,LOC,DTEINS FROM r_baa_1.tr_agence;
BAA.REQ.GETAGE.BY.CDE=SELECT AGE,LIB,LOC,DTEINS FROM r_baa_1.tr_agence where AGE=:cdeAge


### GESTION SCANNER
BAA.REQ.GETSCA.BY.AGE=select * from r_baa_1.tr_scanner_baa s where age=:cdeAge
BAA.REQ.ADDSCA.TOAGE=INSERT INTO r_baa_1.tr_scanner_baa(CDESCANNER,AGE,TYPE) VALUES (?,?,?)

### GESTION CPTs
BAA.REQ.GETALL.COMPTE=SELECT CPT,AGE,CLIENT,TIERS,DTEINS FROM r_baa_1.tr_cpt_baa